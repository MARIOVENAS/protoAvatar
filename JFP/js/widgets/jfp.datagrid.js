(function(b){b.jgrid={defaults:{recordtext:"View {0} - {1} of {2}",emptyrecords:"No records to view",loadtext:"Loading...",pgtext:"Page {0} of {1}"},search:{caption:"Search...",Find:"Find",Reset:"Reset",odata:["equal","not equal","less","less or equal","greater","greater or equal","begins with","does not begin with","is in","is not in","ends with","does not end with","contains","does not contain"],groupOps:[{op:"AND",text:"all"},{op:"OR",text:"any"}],matchText:" match",rulesText:" rules"},edit:{addCaption:"Add Record",editCaption:"Edit Record",bSubmit:"Submit",bCancel:"Cancel",bClose:"Close",saveData:"Data has been changed! Save changes?",bYes:"Yes",bNo:"No",bExit:"Cancel",msg:{required:"Field is required",number:"Please, enter valid number",minValue:"value must be greater than or equal to ",maxValue:"value must be less than or equal to",email:"is not a valid e-mail",integer:"Please, enter valid integer value",date:"Please, enter valid date value",url:"is not a valid URL. Prefix required ('http://' or 'https://')",nodefined:" is not defined!",novalue:" return value is required!",customarray:"Custom function should return array!",customfcheck:"Custom function should be present in case of custom checking!"}},view:{caption:"View Record",bClose:"Close"},del:{caption:"Delete",msg:"Delete selected record(s)?",bSubmit:"Delete",bCancel:"Cancel"},nav:{edittext:"",edittitle:"Edit selected row",addtext:"",addtitle:"Add new row",deltext:"",deltitle:"Delete selected row",searchtext:"",searchtitle:"Find records",refreshtext:"",refreshtitle:"Reload Grid",alertcap:"Warning",alerttext:"Please, select row",viewtext:"",viewtitle:"View selected row"},col:{caption:"Select columns",bSubmit:"Ok",bCancel:"Cancel"},errors:{errcap:"Error",nourl:"No url is set",norecords:"No records to process",model:"Length of colNames <> colModel!"},formatter:{integer:{thousandsSeparator:" ",defaultValue:"0"},number:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,defaultValue:"0.00"},currency:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,prefix:"",suffix:"",defaultValue:"0.00"},date:{dayNames:["Sun","Mon","Tue","Wed","Thr","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],AmPm:["am","pm","AM","PM"],S:function(a){return a<11||a>13?["st","nd","rd","th"][Math.min((a-1)%10,3)]:"th"},srcformat:"Y-m-d",newformat:"d/m/Y",masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},reformatAfterEdit:false},baseLinkUrl:"",showAction:"",target:"",checkbox:{disabled:true},idName:"id"}}})($jq);(function($){$.jgrid=$.jgrid||{};$.extend($.jgrid,{htmlDecode:function(value){if(value=="&nbsp;"||value=="&#160;"||(value.length==1&&value.charCodeAt(0)==160)){return""}return !value?value:String(value).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"')},htmlEncode:function(value){return !value?value:String(value).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;")},format:function(format){var args=$.makeArray(arguments).slice(1);if(format===undefined){format=""}return format.replace(/\{(\d+)\}/g,function(m,i){return args[i]})},getCellIndex:function(cell){var c=$(cell);if(c.is("tr")){return -1}c=(!c.is("td")&&!c.is("th")?c.closest("td,th"):c)[0];if($.browser.msie){return $.inArray(c,c.parentNode.cells)}return c.cellIndex},stripHtml:function(v){v=v+"";var regexp=/<("[^"]*"|'[^']*'|[^'">])*>/gi;if(v){v=v.replace(regexp,"");return(v&&v!=="&nbsp;"&&v!=="&#160;")?v.replace(/\"/g,"'"):""}else{return v}},stringToDoc:function(xmlString){var xmlDoc;if(typeof xmlString!=="string"){return xmlString}try{var parser=new DOMParser();xmlDoc=parser.parseFromString(xmlString,"text/xml")}catch(e){xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(xmlString)}return(xmlDoc&&xmlDoc.documentElement&&xmlDoc.documentElement.tagName!="parsererror")?xmlDoc:null},parse:function(jsonString){var js=jsonString;if(js.substr(0,9)=="while(1);"){js=js.substr(9)}if(js.substr(0,2)=="/*"){js=js.substr(2,js.length-4)}if(!js){js="{}"}return($.jgrid.useJSON===true&&typeof(JSON)==="object"&&typeof(JSON.parse)==="function")?JSON.parse(js):eval("("+js+")")},parseDate:function(format,date){var tsp={m:1,d:1,y:1970,h:0,i:0,s:0},k,hl,dM;if(date&&date!==null&&date!==undefined){date=$.trim(date);date=date.split(/[\\\/:_;.\t\T\s-]/);format=format.split(/[\\\/:_;.\t\T\s-]/);var dfmt=$.jgrid.formatter.date.monthNames;var afmt=$.jgrid.formatter.date.AmPm;var h12to24=function(ampm,h){if(ampm===0){if(h==12){h=0}}else{if(h!=12){h+=12}}return h};for(k=0,hl=format.length;k<hl;k++){if(format[k]=="M"){dM=$.inArray(date[k],dfmt);if(dM!==-1&&dM<12){date[k]=dM+1}}if(format[k]=="F"){dM=$.inArray(date[k],dfmt);if(dM!==-1&&dM>11){date[k]=dM+1-12}}if(format[k]=="a"){dM=$.inArray(date[k],afmt);if(dM!==-1&&dM<2&&date[k]==afmt[dM]){date[k]=dM;tsp.h=h12to24(date[k],tsp.h)}}if(format[k]=="A"){dM=$.inArray(date[k],afmt);if(dM!==-1&&dM>1&&date[k]==afmt[dM]){date[k]=dM-2;tsp.h=h12to24(date[k],tsp.h)}}if(date[k]!==undefined){tsp[format[k].toLowerCase()]=parseInt(date[k],10)}}tsp.m=parseInt(tsp.m,10)-1;var ty=tsp.y;if(ty>=70&&ty<=99){tsp.y=1900+tsp.y}else{if(ty>=0&&ty<=69){tsp.y=2000+tsp.y}}}return new Date(tsp.y,tsp.m,tsp.d,tsp.h,tsp.i,tsp.s,0)},jqID:function(sid){sid=sid+"";return sid.replace(/([\.\:\[\]])/g,"\\$1")},getAccessor:function(obj,expr){var ret,p,prm,i;if(typeof expr==="function"){return expr(obj)}ret=obj[expr];if(ret===undefined){try{if(typeof expr==="string"){prm=expr.split(".")}i=prm.length;if(i){ret=obj;while(ret&&i--){p=prm.shift();ret=ret[p]}}}catch(e){}}return ret},ajaxOptions:{},from:function(source,initalQuery){var queryObject=function(d,q){if(typeof(d)=="string"){d=$.data(d)}var self=this,_data=d,_usecase=true,_trim=false,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_negate=false,_queuedOperator="",_sorting=[],_useProperties=true;if(typeof(d)=="object"&&d.push){if(d.length>0){if(typeof(d[0])!="object"){_useProperties=false}else{_useProperties=true}}}else{throw"data provides is not an array"}this._hasData=function(){return _data===null?false:_data.length===0?false:true};this._getStr=function(s){var phrase=[];if(_trim){phrase.push("jQuery.trim(")}phrase.push("String("+s+")");if(_trim){phrase.push(")")}if(!_usecase){phrase.push(".toLowerCase()")}return phrase.join("")};this._strComp=function(val){if(typeof(val)=="string"){return".toString()"}else{return""}};this._group=function(f,u){return({field:f.toString(),unique:u,items:[]})};this._toStr=function(phrase){if(_trim){phrase=$.trim(phrase)}if(!_usecase){phrase=phrase.toLowerCase()}phrase=phrase.toString().replace(new RegExp('\\"',"g"),'\\"');return phrase};this._funcLoop=function(func){var results=[];$.each(_data,function(i,v){results.push(func(v))});return results};this._append=function(s){if(_query===null){_query=""}else{_query+=_queuedOperator===""?" && ":_queuedOperator}if(_negate){_query+="!"}_query+="("+s+")";_negate=false;_queuedOperator=""};this._setCommand=function(f,c){_lastCommand=f;_lastField=c};this._resetNegate=function(){_negate=false};this._repeatCommand=function(f,v){if(_lastCommand===null){return self

}if(f!=null&&v!=null){return _lastCommand(f,v)}if(_lastField===null){return _lastCommand(f)}if(!_useProperties){return _lastCommand(f)}return _lastCommand(_lastField,f)};this._equals=function(a,b){return(self._compare(a,b,1)===0)};this._compare=function(a,b,d){if(d===undefined){d=1}if(a===undefined){a=null}if(b===undefined){b=null}if(a===null&&b===null){return 0}if(a===null&&b!==null){return 1}if(a!==null&&b===null){return -1}if(!_usecase&&typeof(a)!=="number"&&typeof(b)!=="number"){a=String(a).toLowerCase();b=String(b).toLowerCase()}if(a<b){return -d}if(a>b){return d}return 0};this._performSort=function(){if(_sorting.length===0){return}_data=self._doSort(_data,0)};this._doSort=function(d,q){var by=_sorting[q].by,dir=_sorting[q].dir,type=_sorting[q].type,dfmt=_sorting[q].datefmt;if(q==_sorting.length-1){return self._getOrder(d,by,dir,type,dfmt)}q++;var values=self._getGroup(d,by,dir,type,dfmt);var results=[];for(var i=0;i<values.length;i++){var sorted=self._doSort(values[i].items,q);for(var j=0;j<sorted.length;j++){results.push(sorted[j])}}return results};this._getOrder=function(data,by,dir,type,dfmt){var sortData=[],_sortData=[],newDir=dir=="a"?1:-1,i,ab,j,findSortKey;if(type===undefined){type="text"}if(type=="float"||type=="number"||type=="currency"||type=="numeric"){findSortKey=function($cell,a){var key=parseFloat(String($cell).replace(_stripNum,""));return isNaN(key)?0:key}}else{if(type=="int"||type=="integer"){findSortKey=function($cell,a){return $cell?parseFloat(String($cell).replace(_stripNum,"")):0}}else{if(type=="date"||type=="datetime"){findSortKey=function($cell,a){return $.jgrid.parseDate(dfmt,$cell).getTime()}}else{if($.isFunction(type)){findSortKey=type}else{findSortKey=function($cell,a){if(!$cell){$cell=""}return $.trim(String($cell).toUpperCase())}}}}}$.each(data,function(i,v){ab=by!==""?$.jgrid.getAccessor(v,by):v;if(ab===undefined){ab=""}ab=findSortKey(ab,v);_sortData.push({vSort:ab,index:i})});_sortData.sort(function(a,b){a=a.vSort;b=b.vSort;return self._compare(a,b,newDir)});j=0;var nrec=data.length;while(j<nrec){i=_sortData[j].index;sortData.push(data[i]);j++}return sortData};this._getGroup=function(data,by,dir,type,dfmt){var results=[],group=null,last=null,val;$.each(self._getOrder(data,by,dir,type,dfmt),function(i,v){val=$.jgrid.getAccessor(v,by);if(val===undefined){val=""}if(!self._equals(last,val)){last=val;if(group!=null){results.push(group)}group=self._group(by,val)}group.items.push(v)});if(group!=null){results.push(group)}return results};this.ignoreCase=function(){_usecase=false;return self};this.useCase=function(){_usecase=true;return self};this.trim=function(){_trim=true;return self};this.noTrim=function(){_trim=false;return self};this.combine=function(f){var q=$.from(_data);if(!_usecase){q.ignoreCase()}if(_trim){q.trim()}var result=f(q).showQuery();self._append(result);return self};this.execute=function(){var match=_query,results=[];if(match===null){return self}$.each(_data,function(){if(eval(match)){results.push(this)}});_data=results;return self};this.data=function(){return _data};this.select=function(f){self._performSort();if(!self._hasData()){return[]}self.execute();if($.isFunction(f)){var results=[];$.each(_data,function(i,v){results.push(f(v))});return results}return _data};this.hasMatch=function(f){if(!self._hasData()){return false}self.execute();return _data.length>0};this.showQuery=function(cmd){var queryString=_query;if(queryString===null){queryString="no query found"}if($.isFunction(cmd)){cmd(queryString);return self}return queryString};this.andNot=function(f,v,x){_negate=!_negate;return self.and(f,v,x)};this.orNot=function(f,v,x){_negate=!_negate;return self.or(f,v,x)};this.not=function(f,v,x){return self.andNot(f,v,x)};this.and=function(f,v,x){_queuedOperator=" && ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.or=function(f,v,x){_queuedOperator=" || ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.isNot=function(f){_negate=!_negate;return self.is(f)};this.is=function(f){self._append("this."+f);self._resetNegate();return self};this._compareValues=function(func,f,v,how,t){var fld;if(_useProperties){fld="this."+f}else{fld="this"}if(v===undefined){v=null}var val=v===null?f:v,swst=t.stype===undefined?"text":t.stype;switch(swst){case"int":case"integer":val=isNaN(Number(val))?"0":val;fld="parseInt("+fld+",10)";val="parseInt("+val+",10)";break;case"float":case"number":case"numeric":val=String(val).replace(_stripNum,"");val=isNaN(Number(val))?"0":val;fld="parseFloat("+fld+")";val="parseFloat("+val+")";break;case"date":case"datetime":val=String($.jgrid.parseDate(t.newfmt||"Y-m-d",val).getTime());fld='jQuery.jgrid.parseDate("'+t.srcfmt+'",'+fld+").getTime()";break;default:fld=self._getStr(fld);val=self._getStr('"'+self._toStr(val)+'"')}self._append(fld+" "+how+" "+val);self._setCommand(func,f);self._resetNegate();return self};this.equals=function(f,v,t){return self._compareValues(self.equals,f,v,"==",t)};this.greater=function(f,v,t){return self._compareValues(self.greater,f,v,">",t)};this.less=function(f,v,t){return self._compareValues(self.less,f,v,"<",t)};this.greaterOrEquals=function(f,v,t){return self._compareValues(self.greaterOrEquals,f,v,">=",t)};this.lessOrEquals=function(f,v,t){return self._compareValues(self.lessOrEquals,f,v,"<=",t)};this.startsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("this."+f)+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(v)+'"'))}else{length=_trim?$.trim(v.toString()).length:v.toString().length;self._append(self._getStr("this")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(f)+'"'))}self._setCommand(self.startsWith,f);self._resetNegate();return self};this.endsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("this."+f)+".substr("+self._getStr("this."+f)+".length-"+length+","+length+') == "'+self._toStr(v)+'"')}else{self._append(self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(f)+'".length,"'+self._toStr(f)+'".length) == "'+self._toStr(f)+'"')}self._setCommand(self.endsWith,f);self._resetNegate();return self};this.contains=function(f,v){if(_useProperties){self._append(self._getStr("this."+f)+'.indexOf("'+self._toStr(v)+'",0) > -1')}else{self._append(self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1')}self._setCommand(self.contains,f);self._resetNegate();return self};this.groupBy=function(by,dir,type,datefmt){if(!self._hasData()){return null}return self._getGroup(_data,by,dir,type,datefmt)};this.orderBy=function(by,dir,stype,dfmt){dir=dir===undefined||dir===null?"a":$.trim(dir.toString().toLowerCase());if(stype===null||stype===undefined){stype="text"}if(dfmt===null||dfmt===undefined){dfmt="Y-m-d"}if(dir=="desc"||dir=="descending"){dir="d"}if(dir=="asc"||dir=="ascending"){dir="a"}_sorting.push({by:by,dir:dir,type:stype,datefmt:dfmt});return self};return self};return new queryObject(source,null)},extend:function(methods){$.extend($.fn.jqGrid,methods);if(!this.no_legacy_api){$.fn.extend(methods)}}});$.fn.jqGrid=function(pin){if(typeof pin=="string"){var fn=$.jgrid.getAccessor($.fn.jqGrid,pin);if(!fn){throw ("jqGrid - No such method: "+pin)}var args=$.makeArray(arguments).slice(1);return fn.apply(this,args)}return this.each(function(){if(this.grid){return}var p=$.extend(true,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:true,pginput:true,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:false,selarrrow:[],savedRow:[],shrinkToFit:true,xmlReader:{},jsonReader:{},subGrid:false,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:false,loadonce:false,multiselect:false,multikey:false,editurl:null,search:false,caption:"",hidegrid:true,hiddengrid:false,postData:{},userData:{},treeGrid:false,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:false,gridstate:"visible",cellEdit:false,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[false,""],scroll:false,multiboxonly:false,deselectAfterSort:true,scrollrows:false,autowidth:false,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:false,rownumWidth:25,rownumbers:false,pagerpos:"center",recordpos:"right",footerrow:false,userDataOnFooter:false,hoverrows:true,altclass:"ui-priority-secondary",viewsortcols:[false,"vertical",true],resizeclass:"",autoencode:false,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:false,headertitles:false,scrollTimeout:40,data:[],_index:{},grouping:false,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:false,sortitems:[],sortnames:[],groupDataSorted:false,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:false,cmTemplate:{}},$.jgrid.defaults,pin||{});

var grid={headers:[],cols:[],footers:[],dragStart:function(i,x,y){this.resizing={idx:i,startX:x.clientX,sOL:y[0]};this.hDiv.style.cursor="col-resize";this.curGbox=$("#rs_m"+p.id,"#gbox_"+p.id);this.curGbox.css({display:"block",left:y[0],top:y[1],height:y[2]});if($.isFunction(p.resizeStart)){p.resizeStart.call(this,x,i)}document.onselectstart=function(){return false}},dragMove:function(x){if(this.resizing){var diff=x.clientX-this.resizing.startX,h=this.headers[this.resizing.idx],newWidth=p.direction==="ltr"?h.width+diff:h.width-diff,hn,nWn;if(newWidth>33){this.curGbox.css({left:this.resizing.sOL+diff});if(p.forceFit===true){hn=this.headers[this.resizing.idx+p.nv];nWn=p.direction==="ltr"?hn.width-diff:hn.width+diff;if(nWn>33){h.newWidth=newWidth;hn.newWidth=nWn}}else{this.newWidth=p.direction==="ltr"?p.tblwidth+diff:p.tblwidth-diff;h.newWidth=newWidth}}}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var idx=this.resizing.idx,nw=this.headers[idx].newWidth||this.headers[idx].width;nw=parseInt(nw,10);this.resizing=false;$("#rs_m"+p.id).css("display","none");p.colModel[idx].width=nw;this.headers[idx].width=nw;this.headers[idx].el.style.width=nw+"px";this.cols[idx].style.width=nw+"px";if(this.footers.length>0){this.footers[idx].style.width=nw+"px"}if(p.forceFit===true){nw=this.headers[idx+p.nv].newWidth||this.headers[idx+p.nv].width;this.headers[idx+p.nv].width=nw;this.headers[idx+p.nv].el.style.width=nw+"px";this.cols[idx+p.nv].style.width=nw+"px";if(this.footers.length>0){this.footers[idx+p.nv].style.width=nw+"px"}p.colModel[idx+p.nv].width=nw}else{p.tblwidth=this.newWidth||p.tblwidth;$("table:first",this.bDiv).css("width",p.tblwidth+"px");$("table:first",this.hDiv).css("width",p.tblwidth+"px");this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(p.footerrow){$("table:first",this.sDiv).css("width",p.tblwidth+"px");this.sDiv.scrollLeft=this.bDiv.scrollLeft}}if($.isFunction(p.resizeStop)){p.resizeStop.call(this,nw,idx)}}this.curGbox=null;document.onselectstart=function(){return true}},populateVisible:function(){if(grid.timer){clearTimeout(grid.timer)}grid.timer=null;var dh=$(grid.bDiv).height();if(!dh){return}var table=$("table:first",grid.bDiv);var rows=$("> tbody > tr:gt(0):visible:first",table);var rh=rows.outerHeight()||grid.prevRowHeight;if(!rh){return}grid.prevRowHeight=rh;var rn=p.rowNum;var scrollTop=grid.scrollTop=grid.bDiv.scrollTop;var ttop=Math.round(table.position().top)-scrollTop;var tbot=ttop+table.height();var div=rh*rn;var page,npage,empty;if(tbot<dh&&ttop<=0&&(p.lastpage===undefined||parseInt((tbot+scrollTop+div-1)/div,10)<=p.lastpage)){npage=parseInt((dh-tbot+div-1)/div,10);if(tbot>=0||npage<2||p.scroll===true){page=Math.round((tbot+scrollTop)/div)+1;ttop=-1}else{ttop=1}}if(ttop>0){page=parseInt(scrollTop/div,10)+1;npage=parseInt((scrollTop+dh)/div,10)+2-page;empty=true}if(npage){if(p.lastpage&&page>p.lastpage||p.lastpage==1){return}if(grid.hDiv.loading){grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}else{p.page=page;if(empty){grid.selectionPreserver(table[0]);grid.emptyRows(grid.bDiv,false)}grid.populate(npage)}}},scrollGrid:function(){if(p.scroll){var scrollTop=grid.bDiv.scrollTop;if(grid.scrollTop===undefined){grid.scrollTop=0}if(scrollTop!=grid.scrollTop){grid.scrollTop=scrollTop;if(grid.timer){clearTimeout(grid.timer)}grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}}grid.hDiv.scrollLeft=grid.bDiv.scrollLeft;if(p.footerrow){grid.sDiv.scrollLeft=grid.bDiv.scrollLeft}},selectionPreserver:function(ts){var p=ts.p;var sr=p.selrow,sra=p.selarrrow?$.makeArray(p.selarrrow):null;var left=ts.grid.bDiv.scrollLeft;var complete=p.gridComplete;p.gridComplete=function(){p.selrow=null;p.selarrrow=[];if(p.multiselect&&sra&&sra.length>0){for(var i=0;i<sra.length;i++){if(sra[i]!=sr){$(ts).jqGrid("setSelection",sra[i],false)}}}if(sr){$(ts).jqGrid("setSelection",sr,false)}ts.grid.bDiv.scrollLeft=left;p.gridComplete=complete;if(p.gridComplete){complete()}}}};if(this.tagName!="TABLE"){alert("Element is not a table");return}$(this).empty();this.p=p;var i,dir,ts,clm;if(this.p.colNames.length===0){for(i=0;i<this.p.colModel.length;i++){this.p.colNames[i]=this.p.colModel[i].label||this.p.colModel[i].name}}if(this.p.colNames.length!==this.p.colModel.length){alert($.jgrid.errors.model);return}var gv=$("<div class='ui-jqgrid-view'></div>"),ii,isMSIE=$.browser.msie?true:false,isSafari=$.browser.safari?true:false;ts=this;ts.p.direction=$.trim(ts.p.direction.toLowerCase());if($.inArray(ts.p.direction,["ltr","rtl"])==-1){ts.p.direction="ltr"}dir=ts.p.direction;$(gv).insertBefore(this);$(this).appendTo(gv).removeClass("scroll");var eg=$("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");$(eg).insertBefore(gv).attr({id:"gbox_"+this.id,dir:dir});$(gv).appendTo(eg).attr("id","gview_"+this.id);if(isMSIE&&$.browser.version<=6){ii='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{ii=""}$("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(ii).insertBefore(gv);$("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(gv);$(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var sortkeys=["shiftKey","altKey","ctrlKey"],intNum=function(val,defval){val=parseInt(val,10);if(isNaN(val)){return defval?defval:0}else{return val}},formatCol=function(pos,rowInd,tv){var cm=ts.p.colModel[pos],ral=cm.align,result='style="',clas=cm.classes,nm=cm.name;if(ral){result+="text-align:"+ral+";"}if(cm.hidden===true){result+="display:none;"}if(rowInd===0){result+="width: "+grid.headers[pos].width+"px;"}result+='"'+(clas!==undefined?(' class="'+clas+'"'):"")+((cm.title&&tv)?(' title="'+$.jgrid.stripHtml(tv)+'"'):"");result+=' aria-describedby="'+ts.p.id+"_"+nm+'"';return result},cellVal=function(val){return val===undefined||val===null||val===""?"&#160;":(ts.p.autoencode?$.jgrid.htmlEncode(val):val+"")},formatter=function(rowId,cellval,colpos,rwdat,_act){var cm=ts.p.colModel[colpos],v;if(typeof cm.formatter!=="undefined"){var opts={rowId:rowId,colModel:cm,gid:ts.p.id,pos:colpos};if($.isFunction(cm.formatter)){v=cm.formatter.call(ts,cellval,opts,rwdat,_act)}else{if($.fmatter){v=$.fn.fmatter(cm.formatter,cellval,opts,rwdat,_act)}else{v=cellVal(cellval)}}}else{v=cellVal(cellval)}return v},addCell=function(rowId,cell,pos,irow,srvr){var v,prp;v=formatter(rowId,cell,pos,srvr,"add");prp=formatCol(pos,irow,v);return'<td role="gridcell" '+prp+">"+v+"</td>"},addMulti=function(rowid,pos,irow){var v='<input role="checkbox" type="checkbox" id="jqg_'+ts.p.id+"_"+rowid+'" class="cbox" name="jqg_'+ts.p.id+"_"+rowid+'"/>',prp=formatCol(pos,irow,"");return'<td role="gridcell" '+prp+">"+v+"</td>"},addRowNum=function(pos,irow,pG,rN){var v=(parseInt(pG,10)-1)*parseInt(rN,10)+1+irow,prp=formatCol(pos,irow,"");return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+prp+">"+v+"</td>"},reader=function(datatype){var field,f=[],j=0,i;for(i=0;i<ts.p.colModel.length;i++){field=ts.p.colModel[i];if(field.name!=="cb"&&field.name!=="subgrid"&&field.name!=="rn"){if(datatype=="local"){f[j]=field.name}else{f[j]=(datatype=="xml")?field.xmlmap||field.name:field.jsonmap||field.name}j++}}return f},orderedCols=function(offset){var order=ts.p.remapColumns;if(!order||!order.length){order=$.map(ts.p.colModel,function(v,i){return i

})}if(offset){order=$.map(order,function(v){return v<offset?null:v-offset})}return order},emptyRows=function(parent,scroll){if(ts.p.deepempty){$("#"+ts.p.id+" tbody:first tr:gt(0)").remove()}else{var trf=$("#"+ts.p.id+" tbody:first tr:first")[0];$("#"+ts.p.id+" tbody:first").empty().append(trf)}if(scroll&&ts.p.scroll){$(">div:first",parent).css({height:"auto"}).children("div:first").css({height:0,display:"none"});parent.scrollTop=0}},refreshIndex=function(){var datalen=ts.p.data.length,idname,i,val,ni=ts.p.rownumbers===true?1:0,gi=ts.p.multiselect===true?1:0,si=ts.p.subGrid===true?1:0;if(ts.p.keyIndex===false||ts.p.loadonce===true){idname=ts.p.localReader.id}else{idname=ts.p.colModel[ts.p.keyIndex+gi+si+ni].name}for(i=0;i<datalen;i++){val=$.jgrid.getAccessor(ts.p.data[i],idname);ts.p._index[val]=i}},addXmlData=function(xml,t,rcnt,more,adjust){var startReq=new Date(),locdata=(ts.p.datatype!="local"&&ts.p.loadonce)||ts.p.datatype=="xmlstring",xmlid,frd=ts.p.datatype=="local"?"local":"xml";if(locdata){ts.p.data=[];ts.p._index={};ts.p.localReader.id=xmlid="_id_"}ts.p.reccount=0;if($.isXMLDoc(xml)){if(ts.p.treeANode===-1&&!ts.p.scroll){emptyRows(t,false);rcnt=1}else{rcnt=rcnt>1?rcnt:1}}else{return}var i,fpos,ir=0,v,row,gi=0,si=0,ni=0,idn,getId,f=[],F,rd={},xmlr,rid,rowData=[],cn=(ts.p.altRows===true)?" "+ts.p.altclass:"",cn1;if(!ts.p.xmlReader.repeatitems){f=reader(frd)}if(ts.p.keyIndex===false){idn=ts.p.xmlReader.id}else{idn=ts.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(ts.p.remapColumns&&ts.p.remapColumns.length){idn=$.inArray(idn,ts.p.remapColumns)}idn=f[idn]}if((idn+"").indexOf("[")===-1){if(f.length){getId=function(trow,k){return $(idn,trow).text()||k}}else{getId=function(trow,k){return $(ts.p.xmlReader.cell,trow).eq(idn).text()||k}}}else{getId=function(trow,k){return trow.getAttribute(idn.replace(/[\[\]]/g,""))||k}}ts.p.userData={};$(ts.p.xmlReader.page,xml).each(function(){ts.p.page=this.textContent||this.text||0});$(ts.p.xmlReader.total,xml).each(function(){ts.p.lastpage=this.textContent||this.text;if(ts.p.lastpage===undefined){ts.p.lastpage=1}});$(ts.p.xmlReader.records,xml).each(function(){ts.p.records=this.textContent||this.text||0});$(ts.p.xmlReader.userdata,xml).each(function(){ts.p.userData[this.getAttribute("name")]=this.textContent||this.text});var gxml=$(ts.p.xmlReader.root+" "+ts.p.xmlReader.row,xml);if(!gxml){gxml=[]}var gl=gxml.length,j=0;if(gxml&&gl){var rn=parseInt(ts.p.rowNum,10),br=ts.p.scroll?(parseInt(ts.p.page,10)-1)*rn+1:1,altr;if(adjust){rn*=adjust+1}var afterInsRow=$.isFunction(ts.p.afterInsertRow),grpdata={},hiderow="";if(ts.p.grouping&&ts.p.groupingView.groupCollapse===true){hiderow=' style="display:none;"'}while(j<gl){xmlr=gxml[j];rid=getId(xmlr,br+j);altr=rcnt===0?0:rcnt+1;cn1=(altr+j)%2==1?cn:"";rowData.push("<tr"+hiderow+' id="'+rid+'" role="row" class ="ui-widget-content jqgrow ui-row-'+ts.p.direction+""+cn1+'">');if(ts.p.rownumbers===true){rowData.push(addRowNum(0,j,ts.p.page,ts.p.rowNum));ni=1}if(ts.p.multiselect===true){rowData.push(addMulti(rid,ni,j));gi=1}if(ts.p.subGrid===true){rowData.push($(ts).jqGrid("addSubGridCell",gi+ni,j+rcnt));si=1}if(ts.p.xmlReader.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var cells=$(ts.p.xmlReader.cell,xmlr);$.each(F,function(k){var cell=cells[this];if(!cell){return false}v=cell.textContent||cell.text;rd[ts.p.colModel[k+gi+si+ni].name]=v;rowData.push(addCell(rid,v,k+gi+si+ni,j+rcnt,xmlr))})}else{for(i=0;i<f.length;i++){v=$(f[i],xmlr).text();rd[ts.p.colModel[i+gi+si+ni].name]=v;rowData.push(addCell(rid,v,i+gi+si+ni,j+rcnt,xmlr))}}rowData.push("</tr>");if(ts.p.grouping){var grlen=ts.p.groupingView.groupField.length,grpitem=[];for(var z=0;z<grlen;z++){grpitem.push(rd[ts.p.groupingView.groupField[z]])}grpdata=$(ts).jqGrid("groupingPrepare",rowData,grpitem,grpdata,rd);rowData=[]}if(locdata){rd[xmlid]=rid;ts.p.data.push(rd)}if(ts.p.gridview===false){if(ts.p.treeGrid===true){fpos=ts.p.treeANode>-1?ts.p.treeANode:0;row=$(rowData.join(""))[0];$(ts.rows[j+fpos]).after(row);try{$(ts).jqGrid("setTreeNode",rd,row)}catch(e){}}else{$("tbody:first",t).append(rowData.join(""))}if(ts.p.subGrid===true){try{$(ts).jqGrid("addSubGrid",ts.rows[ts.rows.length-1],gi+ni)}catch(_){}}if(afterInsRow){ts.p.afterInsertRow.call(ts,rid,rd,xmlr)}rowData=[]}rd={};ir++;j++;if(ir==rn){break}}}if(ts.p.gridview===true){if(ts.p.grouping){$(ts).jqGrid("groupingRender",grpdata,ts.p.colModel.length);grpdata=null}else{$("tbody:first",t).append(rowData.join(""))}}ts.p.totaltime=new Date()-startReq;if(ir>0){if(ts.p.records===0){ts.p.records=gl}}rowData=null;if(!ts.p.treeGrid&&!ts.p.scroll){ts.grid.bDiv.scrollTop=0}ts.p.reccount=ir;ts.p.treeANode=-1;if(ts.p.userDataOnFooter){$(ts).jqGrid("footerData","set",ts.p.userData,true)}if(locdata){ts.p.records=gl;ts.p.lastpage=Math.ceil(gl/rn)}if(!more){ts.updatepager(false,true)}if(locdata){while(ir<gl){xmlr=gxml[ir];rid=getId(xmlr,ir);if(ts.p.xmlReader.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var cells2=$(ts.p.xmlReader.cell,xmlr);$.each(F,function(k){var cell=cells2[this];if(!cell){return false}v=cell.textContent||cell.text;rd[ts.p.colModel[k+gi+si+ni].name]=v})}else{for(i=0;i<f.length;i++){v=$(f[i],xmlr).text();rd[ts.p.colModel[i+gi+si+ni].name]=v}}rd[xmlid]=rid;ts.p.data.push(rd);rd={};ir++}refreshIndex()}},addJSONData=function(data,t,rcnt,more,adjust){var startReq=new Date();if(data){if(ts.p.treeANode===-1&&!ts.p.scroll){emptyRows(t,false);rcnt=1}else{rcnt=rcnt>1?rcnt:1}}else{return}var dReader,locid,frd,locdata=(ts.p.datatype!="local"&&ts.p.loadonce)||ts.p.datatype=="jsonstring";if(locdata){ts.p.data=[];ts.p._index={};locid=ts.p.localReader.id="_id_"}ts.p.reccount=0;if(ts.p.datatype=="local"){dReader=ts.p.localReader;frd="local"}else{dReader=ts.p.jsonReader;frd="json"}var ir=0,v,i,j,row,f=[],F,cur,gi=0,si=0,ni=0,len,drows,idn,rd={},fpos,idr,rowData=[],cn=(ts.p.altRows===true)?" "+ts.p.altclass:"",cn1,lp;ts.p.page=$.jgrid.getAccessor(data,dReader.page)||0;lp=$.jgrid.getAccessor(data,dReader.total);ts.p.lastpage=lp===undefined?1:lp;ts.p.records=$.jgrid.getAccessor(data,dReader.records)||0;ts.p.userData=$.jgrid.getAccessor(data,dReader.userdata)||{};if(!dReader.repeatitems){F=f=reader(frd)}if(ts.p.keyIndex===false){idn=dReader.id}else{idn=ts.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(ts.p.remapColumns&&ts.p.remapColumns.length){idn=$.inArray(idn,ts.p.remapColumns)}idn=f[idn]}drows=$.jgrid.getAccessor(data,dReader.root);if(!drows){drows=[]}len=drows.length;i=0;var rn=parseInt(ts.p.rowNum,10),br=ts.p.scroll?(parseInt(ts.p.page,10)-1)*rn+1:1,altr;if(adjust){rn*=adjust+1}var afterInsRow=$.isFunction(ts.p.afterInsertRow),grpdata={},hiderow="";if(ts.p.grouping&&ts.p.groupingView.groupCollapse===true){hiderow=' style="display:none;"'}while(i<len){cur=drows[i];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+i;if(f.length===0){if(dReader.cell){var ccur=cur[dReader.cell];idr=ccur[idn]||idr;ccur=null}}}altr=rcnt===1?0:rcnt;cn1=(altr+i)%2==1?cn:"";rowData.push("<tr"+hiderow+' id="'+idr+'" role="row" class= "ui-widget-content jqgrow ui-row-'+ts.p.direction+""+cn1+'">');if(ts.p.rownumbers===true){rowData.push(addRowNum(0,i,ts.p.page,ts.p.rowNum));ni=1}if(ts.p.multiselect){rowData.push(addMulti(idr,ni,i));gi=1}if(ts.p.subGrid){rowData.push($(ts).jqGrid("addSubGridCell",gi+ni,i+rcnt));si=1}if(dReader.repeatitems){if(dReader.cell){cur=$.jgrid.getAccessor(cur,dReader.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rowData.push(addCell(idr,v,j+gi+si+ni,i+rcnt,cur));

rd[ts.p.colModel[j+gi+si+ni].name]=v}rowData.push("</tr>");if(ts.p.grouping){var grlen=ts.p.groupingView.groupField.length,grpitem=[];for(var z=0;z<grlen;z++){grpitem.push(rd[ts.p.groupingView.groupField[z]])}grpdata=$(ts).jqGrid("groupingPrepare",rowData,grpitem,grpdata,rd);rowData=[]}if(locdata){rd[locid]=idr;ts.p.data.push(rd)}if(ts.p.gridview===false){if(ts.p.treeGrid===true){fpos=ts.p.treeANode>-1?ts.p.treeANode:0;row=$(rowData.join(""))[0];$(ts.rows[i+fpos]).after(row);try{$(ts).jqGrid("setTreeNode",rd,row)}catch(e){}}else{$("#"+ts.p.id+" tbody:first").append(rowData.join(""))}if(ts.p.subGrid===true){try{$(ts).jqGrid("addSubGrid",ts.rows[ts.rows.length-1],gi+ni)}catch(_){}}if(afterInsRow){ts.p.afterInsertRow.call(ts,idr,rd,cur)}rowData=[]}rd={};ir++;i++;if(ir==rn){break}}if(ts.p.gridview===true){if(ts.p.grouping){$(ts).jqGrid("groupingRender",grpdata,ts.p.colModel.length);grpdata=null}else{$("#"+ts.p.id+" tbody:first").append(rowData.join(""))}}ts.p.totaltime=new Date()-startReq;if(ir>0){if(ts.p.records===0){ts.p.records=len}}rowData=null;if(!ts.p.treeGrid&&!ts.p.scroll){ts.grid.bDiv.scrollTop=0}ts.p.reccount=ir;ts.p.treeANode=-1;if(ts.p.userDataOnFooter){$(ts).jqGrid("footerData","set",ts.p.userData,true)}if(locdata){ts.p.records=len;ts.p.lastpage=Math.ceil(len/rn)}if(!more){ts.updatepager(false,true)}if(locdata){while(ir<len){cur=drows[ir];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+ir;if(f.length===0){if(dReader.cell){var ccur2=cur[dReader.cell];idr=ccur2[idn]||idr;ccur2=null}}}if(cur){if(dReader.repeatitems){if(dReader.cell){cur=$.jgrid.getAccessor(cur,dReader.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rd[ts.p.colModel[j+gi+si+ni].name]=v}rd[locid]=idr;ts.p.data.push(rd);rd={}}ir++}refreshIndex()}},addLocalData=function(){var st,fndsort=false,cmtypes=[],grtypes=[],grindexes=[],srcformat,sorttype,newformat;if(!$.isArray(ts.p.data)){return}var grpview=ts.p.grouping?ts.p.groupingView:false;$.each(ts.p.colModel,function(i,v){sorttype=this.sorttype||"text";if(sorttype=="date"||sorttype=="datetime"){if(this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"){if(this.formatoptions&&this.formatoptions.srcformat){srcformat=this.formatoptions.srcformat}else{srcformat=$.jgrid.formatter.date.srcformat}if(this.formatoptions&&this.formatoptions.newformat){newformat=this.formatoptions.newformat}else{newformat=$.jgrid.formatter.date.newformat}}else{srcformat=newformat=this.datefmt||"Y-m-d"}cmtypes[this.name]={stype:sorttype,srcfmt:srcformat,newfmt:newformat}}else{cmtypes[this.name]={stype:sorttype,srcfmt:"",newfmt:""}}if(ts.p.grouping&&this.name==grpview.groupField[0]){var grindex=this.name;if(typeof this.index!="undefined"){grindex=this.index}grtypes[0]=cmtypes[grindex];grindexes.push(grindex)}if(!fndsort&&(this.index==ts.p.sortname||this.name==ts.p.sortname)){st=this.name;fndsort=true}});if(ts.p.treeGrid){$(ts).jqGrid("SortTree",st,ts.p.sortorder,cmtypes[st].stype,cmtypes[st].srcfmt);return}var compareFnMap={eq:function(queryObj){return queryObj.equals},ne:function(queryObj){return queryObj.not().equals},lt:function(queryObj){return queryObj.less},le:function(queryObj){return queryObj.lessOrEquals},gt:function(queryObj){return queryObj.greater},ge:function(queryObj){return queryObj.greaterOrEquals},cn:function(queryObj){return queryObj.contains},nc:function(queryObj){return queryObj.not().contains},bw:function(queryObj){return queryObj.startsWith},bn:function(queryObj){return queryObj.not().startsWith},en:function(queryObj){return queryObj.not().endsWith},ew:function(queryObj){return queryObj.endsWith},ni:function(queryObj){return queryObj.not().equals},"in":function(queryObj){return queryObj.equals}},query=$.jgrid.from(ts.p.data);if(ts.p.ignoreCase){query=query.ignoreCase()}if(ts.p.search===true){var srules=ts.p.postData.filters,opr;if(srules){if(typeof srules=="string"){srules=$.jgrid.parse(srules)}for(var i=0,l=srules.rules.length,rule;i<l;i++){rule=srules.rules[i];opr=srules.groupOp;if(compareFnMap[rule.op]&&rule.field&&rule.data&&opr){if(opr.toUpperCase()=="OR"){query=compareFnMap[rule.op](query)(rule.field,rule.data,cmtypes[rule.field]).or()}else{query=compareFnMap[rule.op](query)(rule.field,rule.data,cmtypes[rule.field])}}}}else{try{query=compareFnMap[ts.p.postData.searchOper](query)(ts.p.postData.searchField,ts.p.postData.searchString,cmtypes[ts.p.postData.searchField])}catch(se){}}}if(ts.p.grouping){query.orderBy(grindexes,grpview.groupOrder[0],grtypes[0].stype,grtypes[0].srcfmt);grpview.groupDataSorted=true}if(st&&ts.p.sortorder&&fndsort){if(ts.p.sortorder.toUpperCase()=="DESC"){query.orderBy(ts.p.sortname,"d",cmtypes[st].stype,cmtypes[st].srcfmt)}else{query.orderBy(ts.p.sortname,"a",cmtypes[st].stype,cmtypes[st].srcfmt)}}var queryResults=query.select(),recordsperpage=parseInt(ts.p.rowNum,10),total=queryResults.length,page=parseInt(ts.p.page,10),totalpages=Math.ceil(total/recordsperpage),retresult={};queryResults=recordsperpage==-1?queryResults.slice((page-1)*recordsperpage):queryResults.slice((page-1)*recordsperpage,page*recordsperpage);query=null;cmtypes=null;retresult[ts.p.localReader.total]=totalpages;retresult[ts.p.localReader.page]=page;retresult[ts.p.localReader.records]=total;retresult[ts.p.localReader.root]=queryResults;queryResults=null;return retresult},updatepager=function(rn,dnd){var cp,last,base,from,to,tot,fmt,pgboxes="";base=parseInt(ts.p.page,10)-1;if(base<0){base=0}base=base*parseInt(ts.p.rowNum,10);to=base+ts.p.reccount;if(ts.p.scroll){var rows=$("tbody:first > tr:gt(0)",ts.grid.bDiv);base=to-rows.length;ts.p.reccount=rows.length;var rh=rows.outerHeight()||ts.grid.prevRowHeight;if(rh){var top=base*rh;var height=parseInt(ts.p.records,10)*rh;$(">div:first",ts.grid.bDiv).css({height:height}).children("div:first").css({height:top,display:top?"":"none"})}ts.grid.bDiv.scrollLeft=ts.grid.hDiv.scrollLeft}pgboxes=ts.p.pager?ts.p.pager:"";pgboxes+=ts.p.toppager?(pgboxes?","+ts.p.toppager:ts.p.toppager):"";if(pgboxes){fmt=$.jgrid.formatter.integer||{};cp=intNum(ts.p.page);last=intNum(ts.p.lastpage);$(".selbox",pgboxes).attr("disabled",false);if(ts.p.pginput===true){$(".ui-pg-input",pgboxes).val(ts.p.page);$("#sp_1",pgboxes).html($.fmatter?$.fmatter.util.NumberFormat(ts.p.lastpage,fmt):ts.p.lastpage)}if(ts.p.viewrecords){if(ts.p.reccount===0){$(".ui-paging-info",pgboxes).html(ts.p.emptyrecords)}else{from=base+1;tot=ts.p.records;if($.fmatter){from=$.fmatter.util.NumberFormat(from,fmt);to=$.fmatter.util.NumberFormat(to,fmt);tot=$.fmatter.util.NumberFormat(tot,fmt)}$(".ui-paging-info",pgboxes).html($.jgrid.format(ts.p.recordtext,from,to,tot))}}if(ts.p.pgbuttons===true){if(cp<=0){cp=last=0}if(cp==1||cp===0){$("#first, #prev",ts.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");if(ts.p.toppager){$("#first_t, #prev_t",ts.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#first, #prev",ts.p.pager).removeClass("ui-state-disabled");if(ts.p.toppager){$("#first_t, #prev_t",ts.p.toppager).removeClass("ui-state-disabled")}}if(cp==last||cp===0){$("#next, #last",ts.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");if(ts.p.toppager){$("#next_t, #last_t",ts.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#next, #last",ts.p.pager).removeClass("ui-state-disabled");if(ts.p.toppager){$("#next_t, #last_t",ts.p.toppager).removeClass("ui-state-disabled")}}}}if(rn===true&&ts.p.rownumbers===true){$("td.jqgrid-rownum",ts.rows).each(function(i){$(this).html(base+1+i)

})}if(dnd&&ts.p.jqgdnd){$(ts).jqGrid("gridDnD","updateDnD")}if($.isFunction(ts.p.gridComplete)){ts.p.gridComplete.call(ts)}},beginReq=function(){ts.grid.hDiv.loading=true;if(ts.p.hiddengrid){return}switch(ts.p.loadui){case"disable":break;case"enable":$("#load_"+ts.p.id).show();break;case"block":$("#lui_"+ts.p.id).show();$("#load_"+ts.p.id).show();break}},endReq=function(){ts.grid.hDiv.loading=false;switch(ts.p.loadui){case"disable":break;case"enable":$("#load_"+ts.p.id).hide();break;case"block":$("#lui_"+ts.p.id).hide();$("#load_"+ts.p.id).hide();break}},populate=function(npage){if(!ts.grid.hDiv.loading){var pvis=ts.p.scroll&&npage===false;var prm={},dt,dstr,pN=ts.p.prmNames;if(ts.p.page<=0){ts.p.page=1}if(pN.search!==null){prm[pN.search]=ts.p.search}if(pN.nd!==null){prm[pN.nd]=new Date().getTime()}if(pN.rows!==null){prm[pN.rows]=ts.p.rowNum}if(pN.page!==null){prm[pN.page]=ts.p.page}if(pN.sort!==null){prm[pN.sort]=ts.p.sortname}if(pN.order!==null){prm[pN.order]=ts.p.sortorder}if(ts.p.rowTotal!==null&&pN.totalrows!==null){prm[pN.totalrows]=ts.p.rowTotal}var lc=ts.p.loadComplete;var lcf=$.isFunction(lc);if(!lcf){lc=null}var adjust=0;npage=npage||1;if(npage>1){if(pN.npage!==null){prm[pN.npage]=npage;adjust=npage-1;npage=1}else{lc=function(req){ts.p.page++;ts.grid.hDiv.loading=false;if(lcf){ts.p.loadComplete.call(ts,req)}populate(npage-1)}}}else{if(pN.npage!==null){delete ts.p.postData[pN.npage]}}if(ts.p.grouping){$(ts).jqGrid("groupingSetup");if(ts.p.groupingView.groupDataSorted===true){prm[pN.sort]=ts.p.groupingView.groupField[0]+" "+ts.p.groupingView.groupOrder[0]+", "+prm[pN.sort]}}$.extend(ts.p.postData,prm);var rcnt=!ts.p.scroll?1:ts.rows.length-1;if($.isFunction(ts.p.datatype)){ts.p.datatype.call(ts,ts.p.postData,"load_"+ts.p.id);return}else{if($.isFunction(ts.p.beforeRequest)){ts.p.beforeRequest.call(ts)}}dt=ts.p.datatype.toLowerCase();switch(dt){case"json":case"jsonp":case"xml":case"script":$.ajax($.extend({url:ts.p.url,type:ts.p.mtype,dataType:dt,data:$.isFunction(ts.p.serializeGridData)?ts.p.serializeGridData.call(ts,ts.p.postData):ts.p.postData,success:function(data,st){if(dt==="xml"){addXmlData(data,ts.grid.bDiv,rcnt,npage>1,adjust)}else{addJSONData(data,ts.grid.bDiv,rcnt,npage>1,adjust)}if(lc){lc.call(ts,data)}if(pvis){ts.grid.populateVisible()}if(ts.p.loadonce||ts.p.treeGrid){ts.p.datatype="local"}data=null;endReq()},error:function(xhr,st,err){if($.isFunction(ts.p.loadError)){ts.p.loadError.call(ts,xhr,st,err)}endReq();xhr=null},beforeSend:function(xhr){beginReq();if($.isFunction(ts.p.loadBeforeSend)){ts.p.loadBeforeSend.call(ts,xhr)}}},$.jgrid.ajaxOptions,ts.p.ajaxGridOptions));break;case"xmlstring":beginReq();dstr=$.jgrid.stringToDoc(ts.p.datastr);addXmlData(dstr,ts.grid.bDiv);if(lcf){ts.p.loadComplete.call(ts,dstr)}ts.p.datatype="local";ts.p.datastr=null;endReq();break;case"jsonstring":beginReq();if(typeof ts.p.datastr=="string"){dstr=$.jgrid.parse(ts.p.datastr)}else{dstr=ts.p.datastr}addJSONData(dstr,ts.grid.bDiv);if(lcf){ts.p.loadComplete.call(ts,dstr)}ts.p.datatype="local";ts.p.datastr=null;endReq();break;case"local":case"clientside":beginReq();ts.p.datatype="local";var req=addLocalData();addJSONData(req,ts.grid.bDiv,rcnt,npage>1,adjust);if(lc){lc.call(ts,req)}if(pvis){ts.grid.populateVisible()}endReq();break}}},setPager=function(pgid,tp){var sep="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",pginp="",pgl="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",str="",pgcnt,lft,cent,rgt,twd,tdw,i,clearVals=function(onpaging){var ret;if($.isFunction(ts.p.onPaging)){ret=ts.p.onPaging.call(ts,onpaging)}ts.p.selrow=null;if(ts.p.multiselect){ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.savedRow=[];if(ret=="stop"){return false}return true};pgid=pgid.substr(1);pgcnt="pg_"+pgid;lft=pgid+"_left";cent=pgid+"_center";rgt=pgid+"_right";$("#"+pgid).append("<div id='"+pgcnt+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+lft+"' align='left'></td><td id='"+cent+"' align='center' style='white-space:pre;'></td><td id='"+rgt+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(ts.p.rowList.length>0){str="<td dir='"+dir+"'>";str+="<select class='ui-pg-selbox' role='listbox'>";for(i=0;i<ts.p.rowList.length;i++){str+='<option role="option" value="'+ts.p.rowList[i]+'"'+((ts.p.rowNum==ts.p.rowList[i])?' selected="selected"':"")+">"+ts.p.rowList[i]+"</option>"}str+="</select></td>"}if(dir=="rtl"){pgl+=str}if(ts.p.pginput===true){pginp="<td dir='"+dir+"'>"+$.jgrid.format(ts.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1'></span>")+"</td>"}if(ts.p.pgbuttons===true){var po=["first"+tp,"prev"+tp,"next"+tp,"last"+tp];if(dir=="rtl"){po.reverse()}pgl+="<td id='"+po[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>";pgl+="<td id='"+po[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>";pgl+=pginp!==""?sep+pginp+sep:"";pgl+="<td id='"+po[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>";pgl+="<td id='"+po[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>"}else{if(pginp!==""){pgl+=pginp}}if(dir=="ltr"){pgl+=str}pgl+="</tr></tbody></table>";if(ts.p.viewrecords===true){$("td#"+pgid+"_"+ts.p.recordpos,"#"+pgcnt).append("<div dir='"+dir+"' style='text-align:"+ts.p.recordpos+"' class='ui-paging-info'></div>")}$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).append(pgl);tdw=$(".ui-jqgrid").css("font-size")||"11px";$(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+tdw+";visibility:hidden;' ></div>");twd=$(pgl).clone().appendTo("#testpg").width();$("#testpg").remove();if(twd>0){if(pginp!=""){twd+=50}$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).width(twd)}ts.p._nvtd=[];ts.p._nvtd[0]=twd?Math.floor((ts.p.width-twd)/2):Math.floor(ts.p.width/3);ts.p._nvtd[1]=0;pgl=null;$(".ui-pg-selbox","#"+pgcnt).bind("change",function(){ts.p.page=Math.round(ts.p.rowNum*(ts.p.page-1)/this.value-0.5)+1;ts.p.rowNum=this.value;if(tp){$(".ui-pg-selbox",ts.p.pager).val(this.value)}else{if(ts.p.toppager){$(".ui-pg-selbox",ts.p.toppager).val(this.value)}}if(!clearVals("records")){return false}populate();return false});if(ts.p.pgbuttons===true){$(".ui-pg-button","#"+pgcnt).hover(function(e){if($(this).hasClass("ui-state-disabled")){this.style.cursor="default"}else{$(this).addClass("ui-state-hover");this.style.cursor="pointer"}},function(e){if($(this).hasClass("ui-state-disabled")){}else{$(this).removeClass("ui-state-hover");this.style.cursor="default"}});$("#first"+tp+", #prev"+tp+", #next"+tp+", #last"+tp,"#"+pgid).click(function(e){var cp=intNum(ts.p.page,1),last=intNum(ts.p.lastpage,1),selclick=false,fp=true,pp=true,np=true,lp=true;if(last===0||last===1){fp=false;pp=false;np=false;lp=false}else{if(last>1&&cp>=1){if(cp===1){fp=false;pp=false}else{if(cp>1&&cp<last){}else{if(cp===last){np=false;lp=false}}}}else{if(last>1&&cp===0){np=false;lp=false;cp=last-1}}}if(this.id==="first"+tp&&fp){ts.p.page=1;selclick=true}if(this.id==="prev"+tp&&pp){ts.p.page=(cp-1);selclick=true}if(this.id==="next"+tp&&np){ts.p.page=(cp+1);

selclick=true}if(this.id==="last"+tp&&lp){ts.p.page=last;selclick=true}if(selclick){if(!clearVals(this.id)){return false}populate()}return false})}if(ts.p.pginput===true){$("input.ui-pg-input","#"+pgcnt).keypress(function(e){var key=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(key==13){ts.p.page=($(this).val()>0)?$(this).val():ts.p.page;if(!clearVals("user")){return false}populate();return false}return this})}},sortData=function(index,idxcol,reload,sor){if(!ts.p.colModel[idxcol].sortable){return}var so;if(ts.p.savedRow.length>0){return}if(!reload){if(ts.p.lastsort==idxcol){if(ts.p.sortorder=="asc"){ts.p.sortorder="desc"}else{if(ts.p.sortorder=="desc"){ts.p.sortorder="asc"}}}else{ts.p.sortorder=ts.p.colModel[idxcol].firstsortorder||"asc"}ts.p.page=1}if(sor){if(ts.p.lastsort==idxcol&&ts.p.sortorder==sor&&!reload){return}else{ts.p.sortorder=sor}}var thd=$("thead:first",ts.grid.hDiv).get(0);$("tr th:eq("+ts.p.lastsort+") span.ui-grid-ico-sort",thd).addClass("ui-state-disabled");$("tr th:eq("+ts.p.lastsort+")",thd).attr("aria-selected","false");$("tr th:eq("+idxcol+") span.ui-icon-"+ts.p.sortorder,thd).removeClass("ui-state-disabled");$("tr th:eq("+idxcol+")",thd).attr("aria-selected","true");if(!ts.p.viewsortcols[0]){if(ts.p.lastsort!=idxcol){$("tr th:eq("+ts.p.lastsort+") span.s-ico",thd).hide();$("tr th:eq("+idxcol+") span.s-ico",thd).show()}}index=index.substring(5);ts.p.sortname=ts.p.colModel[idxcol].index||index;so=ts.p.sortorder;if($.isFunction(ts.p.onSortCol)){if(ts.p.onSortCol.call(ts,index,idxcol,so)=="stop"){ts.p.lastsort=idxcol;return}}if(ts.p.datatype=="local"){if(ts.p.deselectAfterSort){$(ts).jqGrid("resetSelection")}}else{ts.p.selrow=null;if(ts.p.multiselect){$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.selarrrow=[];ts.p.savedRow=[]}if(ts.p.scroll){var sscroll=ts.grid.bDiv.scrollLeft;emptyRows(ts.grid.bDiv,true);ts.grid.hDiv.scrollLeft=sscroll}if(ts.p.subGrid&&ts.p.datatype=="local"){$("td.sgexpanded","#"+ts.p.id).each(function(){$(this).trigger("click")})}populate();ts.p.lastsort=idxcol;if(ts.p.sortname!=index&&idxcol){ts.p.lastsort=idxcol}},setColWidth=function(){var initwidth=0,brd=ts.p.cellLayout,vc=0,lvc,scw=ts.p.scrollOffset,cw,hs=false,aw,tw=0,gw=0,cl=0,cr;if(isSafari){brd=0}$.each(ts.p.colModel,function(i){if(typeof this.hidden==="undefined"){this.hidden=false}if(this.hidden===false){initwidth+=intNum(this.width,0);if(this.fixed){tw+=this.width;gw+=this.width+brd}else{vc++}cl++}});if(isNaN(ts.p.width)){ts.p.width=grid.width=initwidth}else{grid.width=ts.p.width}ts.p.tblwidth=initwidth;if(ts.p.shrinkToFit===false&&ts.p.forceFit===true){ts.p.forceFit=false}if(ts.p.shrinkToFit===true&&vc>0){aw=grid.width-brd*vc-gw;if(isNaN(ts.p.height)){}else{aw-=scw;hs=true}initwidth=0;$.each(ts.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=Math.round(aw*this.width/(ts.p.tblwidth-tw));this.width=cw;initwidth+=cw;lvc=i}});cr=0;if(hs){if(grid.width-gw-(initwidth+brd*vc)!==scw){cr=grid.width-gw-(initwidth+brd*vc)-scw}}else{if(!hs&&Math.abs(grid.width-gw-(initwidth+brd*vc))!==1){cr=grid.width-gw-(initwidth+brd*vc)}}ts.p.colModel[lvc].width+=cr;ts.p.tblwidth=initwidth+cr+tw+cl*brd;if(ts.p.tblwidth>ts.p.width){ts.p.colModel[lvc].width-=(ts.p.tblwidth-parseInt(ts.p.width,10));ts.p.tblwidth=ts.p.width}}},nextVisible=function(iCol){var ret=iCol,j=iCol,i;for(i=iCol+1;i<ts.p.colModel.length;i++){if(ts.p.colModel[i].hidden!==true){j=i;break}}return j-ret},getOffset=function(iCol){var i,ret={},brd1=isSafari?0:ts.p.cellLayout;ret[0]=ret[1]=ret[2]=0;for(i=0;i<=iCol;i++){if(ts.p.colModel[i].hidden===false){ret[0]+=ts.p.colModel[i].width+brd1}}if(ts.p.direction=="rtl"){ret[0]=ts.p.width-ret[0]}ret[0]=ret[0]-ts.grid.bDiv.scrollLeft;if($(ts.grid.cDiv).is(":visible")){ret[1]+=$(ts.grid.cDiv).height()+parseInt($(ts.grid.cDiv).css("padding-top"),10)+parseInt($(ts.grid.cDiv).css("padding-bottom"),10)}if(ts.p.toolbar[0]===true&&(ts.p.toolbar[1]=="top"||ts.p.toolbar[1]=="both")){ret[1]+=$(ts.grid.uDiv).height()+parseInt($(ts.grid.uDiv).css("border-top-width"),10)+parseInt($(ts.grid.uDiv).css("border-bottom-width"),10)}if(ts.p.toppager){ret[1]+=$(ts.grid.topDiv).height()+parseInt($(ts.grid.topDiv).css("border-bottom-width"),10)}ret[2]+=$(ts.grid.bDiv).height()+$(ts.grid.hDiv).height();return ret};this.p.id=this.id;if($.inArray(ts.p.multikey,sortkeys)==-1){ts.p.multikey=false}ts.p.keyIndex=false;for(i=0;i<ts.p.colModel.length;i++){clm=ts.p.colModel[i];clm=$.extend(clm,ts.p.cmTemplate,clm.template||{});if(ts.p.keyIndex===false&&ts.p.colModel[i].key===true){ts.p.keyIndex=i}}ts.p.sortorder=ts.p.sortorder.toLowerCase();if(ts.p.grouping===true){ts.p.scroll=false;ts.p.rownumbers=false;ts.p.subGrid=false;ts.p.treeGrid=false;ts.p.gridview=true}if(this.p.treeGrid===true){try{$(this).jqGrid("setTreeGrid")}catch(_){}if(ts.p.datatype!="local"){ts.p.localReader={id:"_id_"}}}if(this.p.subGrid){try{$(ts).jqGrid("setSubGrid")}catch(_){}}if(this.p.multiselect){this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>");this.p.colModel.unshift({name:"cb",width:isSafari?ts.p.multiselectWidth+ts.p.cellLayout:ts.p.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}if(this.p.rownumbers){this.p.colNames.unshift("");this.p.colModel.unshift({name:"rn",width:ts.p.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}ts.p.xmlReader=$.extend(true,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:true,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:true,cell:"cell"}},ts.p.xmlReader);ts.p.jsonReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:true,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},ts.p.jsonReader);ts.p.localReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:false,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},ts.p.localReader);if(ts.p.scroll){ts.p.pgbuttons=false;ts.p.pginput=false;ts.p.rowList=[]}if(ts.p.data.length){refreshIndex()}var thead="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",tdc,idn,w,res,sort,td,ptr,tbody,imgs,iac="",idc="";if(ts.p.shrinkToFit===true&&ts.p.forceFit===true){for(i=ts.p.colModel.length-1;i>=0;i--){if(!ts.p.colModel[i].hidden){ts.p.colModel[i].resizable=false;break}}}if(ts.p.viewsortcols[1]=="horizontal"){iac=" ui-i-asc";idc=" ui-i-desc"}tdc=isMSIE?"class='ui-th-div-ie'":"";imgs="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+iac+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+dir+"'></span>";imgs+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+idc+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+dir+"'></span></span>";for(i=0;i<this.p.colNames.length;i++){var tooltip=ts.p.headertitles?(' title="'+$.jgrid.stripHtml(ts.p.colNames[i])+'"'):"";thead+="<th id='"+ts.p.id+"_"+ts.p.colModel[i].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+dir+"'"+tooltip+">";idn=ts.p.colModel[i].index||ts.p.colModel[i].name;thead+="<div id='jqgh_"+ts.p.colModel[i].name+"' "+tdc+">"+ts.p.colNames[i];if(!ts.p.colModel[i].width){ts.p.colModel[i].width=150}else{ts.p.colModel[i].width=parseInt(ts.p.colModel[i].width,10)}if(typeof(ts.p.colModel[i].title)!=="boolean"){ts.p.colModel[i].title=true

}if(idn==ts.p.sortname){ts.p.lastsort=i}thead+=imgs+"</div></th>"}thead+="</tr></thead>";imgs=null;$(this).append(thead);$("thead tr:first th",this).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});if(this.p.multiselect){var emp=[],chk;$("#cb_"+$.jgrid.jqID(ts.p.id),this).bind("click",function(){if(this.checked){$("[id^=jqg_"+ts.p.id+"_]").attr("checked","checked");$(ts.rows).each(function(i){if(i>0){if(!$(this).hasClass("subgrid")&&!$(this).hasClass("jqgroup")){$(this).addClass("ui-state-highlight").attr("aria-selected","true");ts.p.selarrrow.push(this.id);ts.p.selrow=this.id}}});chk=true;emp=[]}else{$("[id^=jqg_"+ts.p.id+"_]").removeAttr("checked");$(ts.rows).each(function(i){if(i>0){if(!$(this).hasClass("subgrid")){$(this).removeClass("ui-state-highlight").attr("aria-selected","false");emp.push(this.id)}}});ts.p.selarrrow=[];ts.p.selrow=null;chk=false}if($.isFunction(ts.p.onSelectAll)){ts.p.onSelectAll.call(ts,chk?ts.p.selarrrow:emp,chk)}})}if(ts.p.autowidth===true){var pw=$(eg).innerWidth();ts.p.width=pw>0?pw:"nw"}setColWidth();$(eg).css("width",grid.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+ts.p.id+"'>&#160;</div>");$(gv).css("width",grid.width+"px");thead=$("thead:first",ts).get(0);var tfoot="";if(ts.p.footerrow){tfoot+="<table role='grid' style='width:"+ts.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+dir+"'>"}var thr=$("tr:first",thead),firstr="<tr class='jqgfirstrow' role='row' style='height:auto'>";ts.p.disableClick=false;$("th",thr).each(function(j){w=ts.p.colModel[j].width;if(typeof ts.p.colModel[j].resizable==="undefined"){ts.p.colModel[j].resizable=true}if(ts.p.colModel[j].resizable){res=document.createElement("span");$(res).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+dir);if(!$.browser.opera){$(res).css("cursor","col-resize")}$(this).addClass(ts.p.resizeclass)}else{res=""}$(this).css("width",w+"px").prepend(res);var hdcol="";if(ts.p.colModel[j].hidden){$(this).css("display","none");hdcol="display:none;"}firstr+="<td role='gridcell' style='height:0px;width:"+w+"px;"+hdcol+"'></td>";grid.headers[j]={width:w,el:this};sort=ts.p.colModel[j].sortable;if(typeof sort!=="boolean"){ts.p.colModel[j].sortable=true;sort=true}var nm=ts.p.colModel[j].name;if(!(nm=="cb"||nm=="subgrid"||nm=="rn")){if(ts.p.viewsortcols[2]){$("div",this).addClass("ui-jqgrid-sortable")}}if(sort){if(ts.p.viewsortcols[0]){$("div span.s-ico",this).show();if(j==ts.p.lastsort){$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled")}}else{if(j==ts.p.lastsort){$("div span.s-ico",this).show();$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled")}}}if(ts.p.footerrow){tfoot+="<td role='gridcell' "+formatCol(j,0,"")+">&#160;</td>"}}).mousedown(function(e){if($(e.target).closest("th>span.ui-jqgrid-resize").length!=1){return}var ci=$.jgrid.getCellIndex(this);if(ts.p.forceFit===true){ts.p.nv=nextVisible(ci)}grid.dragStart(ci,e,getOffset(ci));return false}).click(function(e){if(ts.p.disableClick){ts.p.disableClick=false;return false}var s="th>div.ui-jqgrid-sortable",r,d;if(!ts.p.viewsortcols[2]){s="th>div>span>span.ui-grid-ico-sort"}var t=$(e.target).closest(s);if(t.length!=1){return}var ci=$.jgrid.getCellIndex(this);if(!ts.p.viewsortcols[2]){r=true;d=t.attr("sort")}sortData($("div",this)[0].id,ci,r,d);return false});if(ts.p.sortable&&$.fn.sortable){try{$(ts).jqGrid("sortableColumns",thr)}catch(e){}}if(ts.p.footerrow){tfoot+="</tr></tbody></table>"}firstr+="</tr>";tbody=document.createElement("tbody");this.appendChild(tbody);$(this).addClass("ui-jqgrid-btable").append(firstr);firstr=null;var hTable=$("<table class='ui-jqgrid-htable' style='width:"+ts.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(thead),hg=(ts.p.caption&&ts.p.hiddengrid===true)?true:false,hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");thead=null;grid.hDiv=document.createElement("div");$(grid.hDiv).css({width:grid.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(hb);$(hb).append(hTable);hTable=null;if(hg){$(grid.hDiv).hide()}if(ts.p.pager){if(typeof ts.p.pager=="string"){if(ts.p.pager.substr(0,1)!="#"){ts.p.pager="#"+ts.p.pager}}else{ts.p.pager="#"+$(ts.p.pager).attr("id")}$(ts.p.pager).css({width:grid.width+"px"}).appendTo(eg).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom");if(hg){$(ts.p.pager).hide()}setPager(ts.p.pager,"")}if(ts.p.cellEdit===false&&ts.p.hoverrows===true){$(ts).bind("mouseover",function(e){ptr=$(e.target).closest("tr.jqgrow");if($(ptr).attr("class")!=="subgrid"){$(ptr).addClass("ui-state-hover")}return false}).bind("mouseout",function(e){ptr=$(e.target).closest("tr.jqgrow");$(ptr).removeClass("ui-state-hover");return false})}var ri,ci;$(ts).before(grid.hDiv).click(function(e){td=e.target;var scb=$(td).hasClass("cbox");ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0){return this}var cSel=true;if($.isFunction(ts.p.beforeSelectRow)){cSel=ts.p.beforeSelectRow.call(ts,ptr[0].id,e)}if(td.tagName=="A"||((td.tagName=="INPUT"||td.tagName=="TEXTAREA"||td.tagName=="OPTION"||td.tagName=="SELECT")&&!scb)){return this}if(cSel===true){if(ts.p.cellEdit===true){if(ts.p.multiselect&&scb){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);try{$(ts).jqGrid("editCell",ri,ci,true)}catch(_){}}}else{if(!ts.p.multikey){if(ts.p.multiselect&&ts.p.multiboxonly){if(scb){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{$(ts.p.selarrrow).each(function(i,n){var ind=ts.rows.namedItem(n);$(ind).removeClass("ui-state-highlight");$("#jqg_"+ts.p.id+"_"+$.jgrid.jqID(n)).attr("checked",false)});ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false);$(ts).jqGrid("setSelection",ptr[0].id,true)}}else{$(ts).jqGrid("setSelection",ptr[0].id,true)}}else{if(e[ts.p.multikey]){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{if(ts.p.multiselect&&scb){scb=$("[id^=jqg_"+ts.p.id+"_]").attr("checked");$("[id^=jqg_"+ts.p.id+"_]").attr("checked",!scb)}}}}if($.isFunction(ts.p.onCellSelect)){ri=ptr[0].id;ci=$.jgrid.getCellIndex(td);ts.p.onCellSelect.call(ts,ri,ci,$(td).html(),e)}e.stopPropagation()}else{return this}}).bind("reloadGrid",function(e,opts){if(ts.p.treeGrid===true){ts.p.datatype=ts.p.treedatatype}if(opts&&opts.current){ts.grid.selectionPreserver(ts)}if(ts.p.datatype=="local"){$(ts).jqGrid("resetSelection");if(ts.p.data.length){refreshIndex()}}else{if(!ts.p.treeGrid){ts.p.selrow=null;if(ts.p.multiselect){ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.savedRow=[]}}if(ts.p.scroll){emptyRows(ts.grid.bDiv,true)}if(opts&&opts.page){var page=opts.page;if(page>ts.p.lastpage){page=ts.p.lastpage}if(page<1){page=1}ts.p.page=page;if(ts.grid.prevRowHeight){ts.grid.bDiv.scrollTop=(page-1)*ts.grid.prevRowHeight*ts.p.rowNum}else{ts.grid.bDiv.scrollTop=0}}if(ts.grid.prevRowHeight&&ts.p.scroll){delete ts.p.lastpage;ts.grid.populateVisible()}else{ts.grid.populate()}return false});if($.isFunction(this.p.ondblClickRow)){$(this).dblclick(function(e){td=e.target;ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0){return false}ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);ts.p.ondblClickRow.call(ts,$(ptr).attr("id"),ri,ci,e);return false})}if($.isFunction(this.p.onRightClickRow)){$(this).bind("contextmenu",function(e){td=e.target;

ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0){return false}if(!ts.p.multiselect){$(ts).jqGrid("setSelection",ptr[0].id,true)}ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);ts.p.onRightClickRow.call(ts,$(ptr).attr("id"),ri,ci,e);return false})}grid.bDiv=document.createElement("div");$(grid.bDiv).append($('<div style="position:relative;'+(isMSIE&&$.browser.version<8?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:ts.p.height+(isNaN(ts.p.height)?"":"px"),width:(grid.width)+"px"}).scroll(grid.scrollGrid);$("table:first",grid.bDiv).css({width:ts.p.tblwidth+"px"});if(isMSIE){if($("tbody",this).size()==2){$("tbody:gt(0)",this).remove()}if(ts.p.multikey){$(grid.bDiv).bind("selectstart",function(){return false})}}else{if(ts.p.multikey){$(grid.bDiv).bind("mousedown",function(){return false})}}if(hg){$(grid.bDiv).hide()}grid.cDiv=document.createElement("div");var arf=ts.p.hidegrid===true?$("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){arf.addClass("ui-state-hover")},function(){arf.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css((dir=="rtl"?"left":"right"),"0px"):"";$(grid.cDiv).append(arf).append("<span class='ui-jqgrid-title"+(dir=="rtl"?"-rtl":"")+"'>"+ts.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");$(grid.cDiv).insertBefore(grid.hDiv);if(ts.p.toolbar[0]){grid.uDiv=document.createElement("div");if(ts.p.toolbar[1]=="top"){$(grid.uDiv).insertBefore(grid.hDiv)}else{if(ts.p.toolbar[1]=="bottom"){$(grid.uDiv).insertAfter(grid.hDiv)}}if(ts.p.toolbar[1]=="both"){grid.ubDiv=document.createElement("div");$(grid.uDiv).insertBefore(grid.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id);$(grid.ubDiv).insertAfter(grid.hDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id);if(hg){$(grid.ubDiv).hide()}}else{$(grid.uDiv).width(grid.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id)}if(hg){$(grid.uDiv).hide()}}if(ts.p.toppager){ts.p.toppager=ts.p.id+"_toppager";grid.topDiv=$("<div id='"+ts.p.toppager+"'></div>")[0];ts.p.toppager="#"+ts.p.toppager;$(grid.topDiv).insertBefore(grid.hDiv).addClass("ui-state-default ui-jqgrid-toppager").width(grid.width);setPager(ts.p.toppager,"_t")}if(ts.p.footerrow){grid.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0];hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");$(grid.sDiv).append(hb).insertAfter(grid.hDiv).width(grid.width);$(hb).append(tfoot);grid.footers=$(".ui-jqgrid-ftable",grid.sDiv)[0].rows[0].cells;if(ts.p.rownumbers){grid.footers[0].className="ui-state-default jqgrid-rownum"}if(hg){$(grid.sDiv).hide()}}hb=null;if(ts.p.caption){var tdt=ts.p.datatype;if(ts.p.hidegrid===true){$(".ui-jqgrid-titlebar-close",grid.cDiv).click(function(e){var onHdCl=$.isFunction(ts.p.onHeaderClick),elems=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",counter,self=this;if(ts.p.toolbar[0]===true){if(ts.p.toolbar[1]=="both"){elems+=", #"+$(grid.ubDiv).attr("id")}elems+=", #"+$(grid.uDiv).attr("id")}counter=$(elems,"#gview_"+ts.p.id).length;if(ts.p.gridstate=="visible"){$(elems,"#gbox_"+ts.p.id).slideUp("fast",function(){counter--;if(counter==0){$("span",self).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");ts.p.gridstate="hidden";if($("#gbox_"+ts.p.id).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+ts.p.id).hide()}if(onHdCl){if(!hg){ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)}}}})}else{if(ts.p.gridstate=="hidden"){$(elems,"#gbox_"+ts.p.id).slideDown("fast",function(){counter--;if(counter==0){$("span",self).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(hg){ts.p.datatype=tdt;populate();hg=false}ts.p.gridstate="visible";if($("#gbox_"+ts.p.id).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+ts.p.id).show()}if(onHdCl){if(!hg){ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)}}}})}}return false});if(hg){ts.p.datatype="local";$(".ui-jqgrid-titlebar-close",grid.cDiv).trigger("click")}}}else{$(grid.cDiv).hide()}$(grid.hDiv).after(grid.bDiv).mousemove(function(e){if(grid.resizing){grid.dragMove(e);return false}});$(".ui-jqgrid-labels",grid.hDiv).bind("selectstart",function(){return false});$(document).mouseup(function(e){if(grid.resizing){grid.dragEnd();return false}return true});ts.formatCol=formatCol;ts.sortData=sortData;ts.updatepager=updatepager;ts.refreshIndex=refreshIndex;ts.formatter=function(rowId,cellval,colpos,rwdat,act){return formatter(rowId,cellval,colpos,rwdat,act)};$.extend(grid,{populate:populate,emptyRows:emptyRows});this.grid=grid;ts.addXmlData=function(d){addXmlData(d,ts.grid.bDiv)};ts.addJSONData=function(d){addJSONData(d,ts.grid.bDiv)};this.grid.cols=this.rows[0].cells;populate();ts.p.hiddengrid=false;$(window).unload(function(){ts=null})})};$.jgrid.extend({getGridParam:function(pName){var $t=this[0];if(!$t||!$t.grid){return}if(!pName){return $t.p}else{return typeof($t.p[pName])!="undefined"?$t.p[pName]:null}},setGridParam:function(newParams){return this.each(function(){if(this.grid&&typeof(newParams)==="object"){$.extend(true,this.p,newParams)}})},getDataIDs:function(){var ids=[],i=0,len,j=0;this.each(function(){len=this.rows.length;if(len&&len>0){while(i<len){if($(this.rows[i]).hasClass("jqgrow")){ids[j]=this.rows[i].id;j++}i++}}});return ids},setSelection:function(selection,onsr){return this.each(function(){var $t=this,stat,pt,ner,ia,tpsr;if(selection===undefined){return}onsr=onsr===false?false:true;pt=$t.rows.namedItem(selection+"");if(!pt){return}function scrGrid(iR){var ch=$($t.grid.bDiv)[0].clientHeight,st=$($t.grid.bDiv)[0].scrollTop,rpos=$t.rows[iR].offsetTop,rh=$t.rows[iR].clientHeight;if(rpos+rh>=ch+st){$($t.grid.bDiv)[0].scrollTop=rpos-(ch+st)+rh+st}else{if(rpos<ch+st){if(rpos<st){$($t.grid.bDiv)[0].scrollTop=rpos}}}}if($t.p.scrollrows===true){ner=$t.rows.namedItem(selection).rowIndex;if(ner>=0){scrGrid(ner)}}if(!$t.p.multiselect){if(pt.className!=="ui-subgrid"){if($t.p.selrow){$($t.rows.namedItem($t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false")}if($t.p.selrow!=pt.id){$t.p.selrow=pt.id;$(pt).addClass("ui-state-highlight").attr("aria-selected","true");if($t.p.onSelectRow&&onsr){$t.p.onSelectRow.call($t,$t.p.selrow,true)}}else{$t.p.selrow=null}}}else{$t.p.selrow=pt.id;ia=$.inArray($t.p.selrow,$t.p.selarrrow);if(ia===-1){if(pt.className!=="ui-subgrid"){$(pt).addClass("ui-state-highlight").attr("aria-selected","true")}stat=true;$("#jqg_"+$t.p.id+"_"+$.jgrid.jqID($t.p.selrow)).attr("checked",stat);$t.p.selarrrow.push($t.p.selrow);if($t.p.onSelectRow&&onsr){$t.p.onSelectRow.call($t,$t.p.selrow,stat)}}else{if(pt.className!=="ui-subgrid"){$(pt).removeClass("ui-state-highlight").attr("aria-selected","false")}stat=false;$("#jqg_"+$t.p.id+"_"+$.jgrid.jqID($t.p.selrow)).attr("checked",stat);$t.p.selarrrow.splice(ia,1);if($t.p.onSelectRow&&onsr){$t.p.onSelectRow.call($t,$t.p.selrow,stat)}tpsr=$t.p.selarrrow[0];$t.p.selrow=(tpsr===undefined)?null:tpsr}}})},resetSelection:function(){return this.each(function(){var t=this,ind;if(!t.p.multiselect){if(t.p.selrow){$("#"+t.p.id+" tbody:first tr#"+$.jgrid.jqID(t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false");t.p.selrow=null}}else{$(t.p.selarrrow).each(function(i,n){ind=t.rows.namedItem(n);$(ind).removeClass("ui-state-highlight").attr("aria-selected","false");

$("#jqg_"+t.p.id+"_"+$.jgrid.jqID(n)).attr("checked",false)});$("#cb_"+$.jgrid.jqID(t.p.id)).attr("checked",false);t.p.selarrrow=[]}t.p.savedRow=[]})},getRowData:function(rowid){var res={},resall,getall=false,len,j=0;this.each(function(){var $t=this,nm,ind;if(typeof(rowid)=="undefined"){getall=true;resall=[];len=$t.rows.length}else{ind=$t.rows.namedItem(rowid);if(!ind){return res}len=2}while(j<len){if(getall){ind=$t.rows[j]}if($(ind).hasClass("jqgrow")){$("td",ind).each(function(i){nm=$t.p.colModel[i].name;if(nm!=="cb"&&nm!=="subgrid"&&nm!=="rn"){if($t.p.treeGrid===true&&nm==$t.p.ExpandColumn){res[nm]=$.jgrid.htmlDecode($("span:first",this).html())}else{try{res[nm]=$.unformat(this,{rowId:ind.id,colModel:$t.p.colModel[i]},i)}catch(e){res[nm]=$.jgrid.htmlDecode($(this).html())}}}});if(getall){resall.push(res);res={}}}j++}});return resall?resall:res},delRowData:function(rowid){var success=false,rowInd,ia,ri;this.each(function(){var $t=this;rowInd=$t.rows.namedItem(rowid);if(!rowInd){return false}else{ri=rowInd.rowIndex;$(rowInd).remove();$t.p.records--;$t.p.reccount--;$t.updatepager(true,false);success=true;if($t.p.multiselect){ia=$.inArray(rowid,$t.p.selarrrow);if(ia!=-1){$t.p.selarrrow.splice(ia,1)}}if(rowid==$t.p.selrow){$t.p.selrow=null}}if($t.p.datatype=="local"){var pos=$t.p._index[rowid];if(typeof(pos)!="undefined"){$t.p.data.splice(pos,1);$t.refreshIndex()}}if($t.p.altRows===true&&success){var cn=$t.p.altclass;$($t.rows).each(function(i){if(i%2==1){$(this).addClass(cn)}else{$(this).removeClass(cn)}})}});return success},setRowData:function(rowid,data,cssp){var nm,success=true,title;this.each(function(){if(!this.grid){return false}var t=this,vl,ind,cp=typeof cssp,lcdata={};ind=t.rows.namedItem(rowid);if(!ind){return false}if(data){try{$(this.p.colModel).each(function(i){nm=this.name;if(data[nm]!==undefined){lcdata[nm]=this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"?$.unformat.date(data[nm],this):data[nm];vl=t.formatter(rowid,data[nm],i,data,"edit");title=this.title?{title:$.jgrid.stripHtml(vl)}:{};if(t.p.treeGrid===true&&nm==t.p.ExpandColumn){$("td:eq("+i+") > span:first",ind).html(vl).attr(title)}else{$("td:eq("+i+")",ind).html(vl).attr(title)}}});if(t.p.datatype=="local"){var pos=t.p._index[rowid];if(typeof(pos)!="undefined"){t.p.data[pos]=$.extend(true,t.p.data[pos],lcdata)}lcdata=null}}catch(e){success=false}}if(success){if(cp==="string"){$(ind).addClass(cssp)}else{if(cp==="object"){$(ind).css(cssp)}}}});return success},addRowData:function(rowid,rdata,pos,src){if(!pos){pos="last"}var success=false,nm,row,gi,si,ni,sind,i,v,prp="",aradd,cnm,cn,data,cm;if(rdata){if($.isArray(rdata)){aradd=true;pos="last";cnm=rowid}else{rdata=[rdata];aradd=false}this.each(function(){var t=this,datalen=rdata.length;ni=t.p.rownumbers===true?1:0;gi=t.p.multiselect===true?1:0;si=t.p.subGrid===true?1:0;if(!aradd){if(typeof(rowid)!="undefined"){rowid=rowid+""}else{rowid=(t.p.records+1)+"";if(t.p.keyIndex!==false){cnm=t.p.colModel[t.p.keyIndex+gi+si+ni].name;if(typeof rdata[0][cnm]!="undefined"){rowid=rdata[0][cnm]}}}}cn=t.p.altclass;var k=0,cna="",lcdata={},air=$.isFunction(t.p.afterInsertRow)?true:false;while(k<datalen){data=rdata[k];row="";if(aradd){try{rowid=data[cnm]}catch(e){rowid=(t.p.records+1)+""}cna=t.p.altRows===true?(t.rows.length-1)%2===0?cn:"":""}if(ni){prp=t.formatCol(0,1,"");row+='<td role="gridcell" aria-describedby="'+t.p.id+'_rn" class="ui-state-default jqgrid-rownum" '+prp+">0</td>"}if(gi){v='<input role="checkbox" type="checkbox" id="jqg_'+t.p.id+"_"+rowid+'" class="cbox"/>';prp=t.formatCol(ni,1,"");row+='<td role="gridcell" aria-describedby="'+t.p.id+'_cb" '+prp+">"+v+"</td>"}if(si){row+=$(t).jqGrid("addSubGridCell",gi+ni,1)}for(i=gi+si+ni;i<t.p.colModel.length;i++){cm=t.p.colModel[i];nm=cm.name;lcdata[nm]=cm.formatter&&typeof(cm.formatter)==="string"&&cm.formatter=="date"?$.unformat.date(data[nm],cm):data[nm];v=t.formatter(rowid,$.jgrid.getAccessor(data,nm),i,data,"edit");prp=t.formatCol(i,1,v);row+='<td role="gridcell" aria-describedby="'+t.p.id+"_"+nm+'" '+prp+">"+v+"</td>"}row='<tr id="'+rowid+'" role="row" class="ui-widget-content jqgrow ui-row-'+t.p.direction+" "+cna+'">'+row+"</tr>";if(t.p.subGrid===true){row=$(row)[0];$(t).jqGrid("addSubGrid",row,gi+ni)}if(t.rows.length===0){$("table:first",t.grid.bDiv).append(row)}else{switch(pos){case"last":$(t.rows[t.rows.length-1]).after(row);break;case"first":$(t.rows[0]).after(row);break;case"after":sind=t.rows.namedItem(src);if(sind){if($(t.rows[sind.rowIndex+1]).hasClass("ui-subgrid")){$(t.rows[sind.rowIndex+1]).after(row)}else{$(sind).after(row)}}break;case"before":sind=t.rows.namedItem(src);if(sind){$(sind).before(row);sind=sind.rowIndex}break}}t.p.records++;t.p.reccount++;if(air){t.p.afterInsertRow.call(t,rowid,data,data)}k++;if(t.p.datatype=="local"){t.p._index[rowid]=t.p.data.length;t.p.data.push(lcdata);lcdata={}}}if(t.p.altRows===true&&!aradd){if(pos=="last"){if((t.rows.length-1)%2==1){$(t.rows[t.rows.length-1]).addClass(cn)}}else{$(t.rows).each(function(i){if(i%2==1){$(this).addClass(cn)}else{$(this).removeClass(cn)}})}}t.updatepager(true,true);success=true})}return success},footerData:function(action,data,format){var nm,success=false,res={},title;function isEmpty(obj){for(var i in obj){if(obj.hasOwnProperty(i)){return false}}return true}if(typeof(action)=="undefined"){action="get"}if(typeof(format)!="boolean"){format=true}action=action.toLowerCase();this.each(function(){var t=this,vl;if(!t.grid||!t.p.footerrow){return false}if(action=="set"){if(isEmpty(data)){return false}}success=true;$(this.p.colModel).each(function(i){nm=this.name;if(action=="set"){if(data[nm]!==undefined){vl=format?t.formatter("",data[nm],i,data,"edit"):data[nm];title=this.title?{title:$.jgrid.stripHtml(vl)}:{};$("tr.footrow td:eq("+i+")",t.grid.sDiv).html(vl).attr(title);success=true}}else{if(action=="get"){res[nm]=$("tr.footrow td:eq("+i+")",t.grid.sDiv).html()}}})});return action=="get"?res:success},ShowHideCol:function(colname,show){return this.each(function(){var $t=this,fndh=false;if(!$t.grid){return}if(typeof colname==="string"){colname=[colname]}show=show!="none"?"":"none";var sw=show===""?true:false;$(this.p.colModel).each(function(i){if($.inArray(this.name,colname)!==-1&&this.hidden===sw){$("tr",$t.grid.hDiv).each(function(){$("th:eq("+i+")",this).css("display",show)});$($t.rows).each(function(j){$("td:eq("+i+")",$t.rows[j]).css("display",show)});if($t.p.footerrow){$("td:eq("+i+")",$t.grid.sDiv).css("display",show)}if(show=="none"){$t.p.tblwidth-=this.width+$t.p.cellLayout}else{$t.p.tblwidth+=this.width}this.hidden=!sw;fndh=true}});if(fndh===true){$("table:first",$t.grid.hDiv).width($t.p.tblwidth);$("table:first",$t.grid.bDiv).width($t.p.tblwidth);$t.grid.hDiv.scrollLeft=$t.grid.bDiv.scrollLeft;if($t.p.footerrow){$("table:first",$t.grid.sDiv).width($t.p.tblwidth);$t.grid.sDiv.scrollLeft=$t.grid.bDiv.scrollLeft}if($t.p.shrinkToFit===true){$($t).jqGrid("setGridWidth",$t.grid.width-0.001,true)}}})},hideCol:function(colname){return this.each(function(){$(this).jqGrid("ShowHideCol",colname,"none")})},showCol:function(colname){return this.each(function(){$(this).jqGrid("ShowHideCol",colname,"")})},remapColumns:function(permutation,updateCells,keepHeader){function resortArray(a){var ac;if(a.length){ac=$.makeArray(a)}else{ac=$.extend({},a)}$.each(permutation,function(i){a[i]=ac[this]})}var ts=this.get(0);function resortRows(parent,clobj){$(">tr"+(clobj||""),parent).each(function(){var row=this;var elems=$.makeArray(row.cells);

$.each(permutation,function(){var e=elems[this];if(e){row.appendChild(e)}})})}resortArray(ts.p.colModel);resortArray(ts.p.colNames);resortArray(ts.grid.headers);resortRows($("thead:first",ts.grid.hDiv),keepHeader&&":not(.ui-jqgrid-labels)");if(updateCells){resortRows($("#"+ts.p.id+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot")}if(ts.p.footerrow){resortRows($("tbody:first",ts.grid.sDiv))}if(ts.p.remapColumns){if(!ts.p.remapColumns.length){ts.p.remapColumns=$.makeArray(permutation)}else{resortArray(ts.p.remapColumns)}}ts.p.lastsort=$.inArray(ts.p.lastsort,permutation);if(ts.p.treeGrid){ts.p.expColInd=$.inArray(ts.p.expColInd,permutation)}},setGridWidth:function(nwidth,shrink){return this.each(function(){if(!this.grid){return}var $t=this,cw,initwidth=0,brd=$t.p.cellLayout,lvc,vc=0,hs=false,scw=$t.p.scrollOffset,aw,gw=0,tw=0,cl=0,cr;if(typeof shrink!="boolean"){shrink=$t.p.shrinkToFit}if(isNaN(nwidth)){return}else{nwidth=parseInt(nwidth,10);$t.grid.width=$t.p.width=nwidth}$("#gbox_"+$t.p.id).css("width",nwidth+"px");$("#gview_"+$t.p.id).css("width",nwidth+"px");$($t.grid.bDiv).css("width",nwidth+"px");$($t.grid.hDiv).css("width",nwidth+"px");if($t.p.pager){$($t.p.pager).css("width",nwidth+"px")}if($t.p.toppager){$($t.p.toppager).css("width",nwidth+"px")}if($t.p.toolbar[0]===true){$($t.grid.uDiv).css("width",nwidth+"px");if($t.p.toolbar[1]=="both"){$($t.grid.ubDiv).css("width",nwidth+"px")}}if($t.p.footerrow){$($t.grid.sDiv).css("width",nwidth+"px")}if(shrink===false&&$t.p.forceFit===true){$t.p.forceFit=false}if(shrink===true){if($.browser.safari){brd=0}$.each($t.p.colModel,function(i){if(this.hidden===false){initwidth+=parseInt(this.width,10);if(this.fixed){tw+=this.width;gw+=this.width+brd}else{vc++}cl++}});if(vc===0){return}$t.p.tblwidth=initwidth;aw=nwidth-brd*vc-gw;if(!isNaN($t.p.height)){if($($t.grid.bDiv)[0].clientHeight<$($t.grid.bDiv)[0].scrollHeight||$t.rows.length===1){hs=true;aw-=scw}}initwidth=0;var cle=$t.grid.cols.length>0;$.each($t.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=Math.round(aw*this.width/($t.p.tblwidth-tw));if(cw<0){return}this.width=cw;initwidth+=cw;$t.grid.headers[i].width=cw;$t.grid.headers[i].el.style.width=cw+"px";if($t.p.footerrow){$t.grid.footers[i].style.width=cw+"px"}if(cle){$t.grid.cols[i].style.width=cw+"px"}lvc=i}});cr=0;if(hs){if(nwidth-gw-(initwidth+brd*vc)!==scw){cr=nwidth-gw-(initwidth+brd*vc)-scw}}else{if(Math.abs(nwidth-gw-(initwidth+brd*vc))!==1){cr=nwidth-gw-(initwidth+brd*vc)}}$t.p.colModel[lvc].width+=cr;$t.p.tblwidth=initwidth+cr+tw+brd*cl;if($t.p.tblwidth>nwidth){var delta=$t.p.tblwidth-parseInt(nwidth,10);$t.p.tblwidth=nwidth;cw=$t.p.colModel[lvc].width=$t.p.colModel[lvc].width-delta}else{cw=$t.p.colModel[lvc].width}$t.grid.headers[lvc].width=cw;$t.grid.headers[lvc].el.style.width=cw+"px";if(cle){$t.grid.cols[lvc].style.width=cw+"px"}$("table:first",$t.grid.bDiv).css("width",$t.p.tblwidth+"px");$("table:first",$t.grid.hDiv).css("width",$t.p.tblwidth+"px");$t.grid.hDiv.scrollLeft=$t.grid.bDiv.scrollLeft;if($t.p.footerrow){$t.grid.footers[lvc].style.width=cw+"px";$("table:first",$t.grid.sDiv).css("width",$t.p.tblwidth+"px")}}})},setGridHeight:function(nh){return this.each(function(){var $t=this;if(!$t.grid){return}$($t.grid.bDiv).css({height:nh+(isNaN(nh)?"":"px")});$t.p.height=nh;if($t.p.scroll){$t.grid.populateVisible()}})},setCaption:function(newcap){return this.each(function(){this.p.caption=newcap;$("span.ui-jqgrid-title",this.grid.cDiv).html(newcap);$(this.grid.cDiv).show()})},setLabel:function(colname,nData,prop,attrp){return this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(colname)){$($t.p.colModel).each(function(i){if(this.name==colname){pos=i;return false}})}else{pos=parseInt(colname,10)}if(pos>=0){var thecol=$("tr.ui-jqgrid-labels th:eq("+pos+")",$t.grid.hDiv);if(nData){var ico=$(".s-ico",thecol);$("[id^=jqgh_]",thecol).empty().html(nData).append(ico);$t.p.colNames[pos]=nData}if(prop){if(typeof prop==="string"){$(thecol).addClass(prop)}else{$(thecol).css(prop)}}if(typeof attrp==="object"){$(thecol).attr(attrp)}}})},setCell:function(rowid,colname,nData,cssp,attrp,forceupd){return this.each(function(){var $t=this,pos=-1,v,title;if(!$t.grid){return}if(isNaN(colname)){$($t.p.colModel).each(function(i){if(this.name==colname){pos=i;return false}})}else{pos=parseInt(colname,10)}if(pos>=0){var ind=$t.rows.namedItem(rowid);if(ind){var tcell=$("td:eq("+pos+")",ind);if(nData!==""||forceupd===true){v=$t.formatter(rowid,nData,pos,ind,"edit");title=$t.p.colModel[pos].title?{title:$.jgrid.stripHtml(v)}:{};if($t.p.treeGrid&&$(".tree-wrap",$(tcell)).length>0){$("span",$(tcell)).html(v).attr(title)}else{$(tcell).html(v).attr(title)}if($t.p.datatype=="local"){var cm=$t.p.colModel[pos],index;nData=cm.formatter&&typeof(cm.formatter)==="string"&&cm.formatter=="date"?$.unformat.date(nData,cm):nData;index=$t.p._index[rowid];if(typeof index!="undefined"){$t.p.data[index][cm.name]=nData}}}if(typeof cssp==="string"){$(tcell).addClass(cssp)}else{if(cssp){$(tcell).css(cssp)}}if(typeof attrp==="object"){$(tcell).attr(attrp)}}}})},getCell:function(rowid,col){var ret=false;this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(col)){$($t.p.colModel).each(function(i){if(this.name===col){pos=i;return false}})}else{pos=parseInt(col,10)}if(pos>=0){var ind=$t.rows.namedItem(rowid);if(ind){try{ret=$.unformat($("td:eq("+pos+")",ind),{rowId:ind.id,colModel:$t.p.colModel[pos]},pos)}catch(e){ret=$.jgrid.htmlDecode($("td:eq("+pos+")",ind).html())}}}});return ret},getCol:function(col,obj,mathopr){var ret=[],val,sum=0;obj=typeof(obj)!="boolean"?false:obj;if(typeof mathopr=="undefined"){mathopr=false}this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(col)){$($t.p.colModel).each(function(i){if(this.name===col){pos=i;return false}})}else{pos=parseInt(col,10)}if(pos>=0){var ln=$t.rows.length,i=0;if(ln&&ln>0){while(i<ln){if($($t.rows[i]).hasClass("jqgrow")){try{val=$.unformat($($t.rows[i].cells[pos]),{rowId:$t.rows[i].id,colModel:$t.p.colModel[pos]},pos)}catch(e){val=$.jgrid.htmlDecode($t.rows[i].cells[pos].innerHTML)}if(mathopr){sum+=parseFloat(val)}else{if(obj){ret.push({id:$t.rows[i].id,value:val})}else{ret[i]=val}}}i++}if(mathopr){switch(mathopr.toLowerCase()){case"sum":ret=sum;break;case"avg":ret=sum/ln;break;case"count":ret=ln;break}}}}});return ret},clearGridData:function(clearfooter){return this.each(function(){var $t=this;if(!$t.grid){return}if(typeof clearfooter!="boolean"){clearfooter=false}if($t.p.deepempty){$("#"+$t.p.id+" tbody:first tr:gt(0)").remove()}else{var trf=$("#"+$t.p.id+" tbody:first tr:first")[0];$("#"+$t.p.id+" tbody:first").empty().append(trf)}if($t.p.footerrow&&clearfooter){$(".ui-jqgrid-ftable td",$t.grid.sDiv).html("&#160;")}$t.p.selrow=null;$t.p.selarrrow=[];$t.p.savedRow=[];$t.p.records=0;$t.p.page=1;$t.p.lastpage=0;$t.p.reccount=0;$t.p.data=[];$t.p_index={};$t.updatepager(true,false)})},getInd:function(rowid,rc){var ret=false,rw;this.each(function(){rw=this.rows.namedItem(rowid);if(rw){ret=rc===true?rw:rw.rowIndex}});return ret}})})(jQuery);(function(b){b.extend(b.jgrid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");if(a.o){a.o.remove()}},hideModal:function(a,e){e=b.extend({jqm:true,gb:""},e||{});if(e.onClose){var h=e.onClose(a);if(typeof h=="boolean"&&!h){return}}if(b.fn.jqm&&e.jqm===true){b(a).attr("aria-hidden","true").jqmHide()}else{if(e.gb!==""){try{b(".jqgrid-overlay:first",e.gb).hide()}catch(g){}}b(a).hide().attr("aria-hidden","true")

}},findPos:function(f){var e=0,a=0;if(f.offsetParent){do{e+=f.offsetLeft;a+=f.offsetTop}while(f=f.offsetParent)}return[e,a]},createModal:function(p,A,E,I,G,H){var v=document.createElement("div"),F,a=this;F=b(E.gbox).attr("dir")=="rtl"?true:false;v.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";v.id=p.themodal;var C=document.createElement("div");C.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";C.id=p.modalhead;b(C).append("<span class='ui-jqdialog-title'>"+E.caption+"</span>");var e=b("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){e.addClass("ui-state-hover")},function(){e.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");b(C).append(e);if(F){v.dir="rtl";b(".ui-jqdialog-title",C).css("float","right");b(".ui-jqdialog-titlebar-close",C).css("left",0.3+"em")}else{v.dir="ltr";b(".ui-jqdialog-title",C).css("float","left");b(".ui-jqdialog-titlebar-close",C).css("right",0.3+"em")}var y=document.createElement("div");b(y).addClass("ui-jqdialog-content ui-widget-content").attr("id",p.modalcontent);b(y).append(A);v.appendChild(y);b(v).prepend(C);if(H===true){b("body").append(v)}else{b(v).insertBefore(I)}if(typeof E.jqModal==="undefined"){E.jqModal=true}var D={};if(b.fn.jqm&&E.jqModal===true){if(E.left===0&&E.top===0){var z=[];z=this.findPos(G);E.left=z[0]+4;E.top=z[1]+4}D.top=E.top+"px";D.left=E.left}else{if(E.left!==0||E.top!==0){D.left=E.left;D.top=E.top+"px"}}b("a.ui-jqdialog-titlebar-close",C).click(function(d){var f=b("#"+p.themodal).data("onClose")||E.onClose;var c=b("#"+p.themodal).data("gbox")||E.gbox;a.hideModal("#"+p.themodal,{gb:c,jqm:E.jqModal,onClose:f});return false});if(E.width===0||!E.width){E.width=300}if(E.height===0||!E.height){E.height=200}if(!E.zIndex){var w=b(I).parents("*[role=dialog]").first().css("z-index");if(w){E.zIndex=parseInt(w)+1}else{E.zIndex=950}}var x=0;if(F&&D.left&&!H){x=b(E.gbox).width()-(!isNaN(E.width)?parseInt(E.width,10):0)-8;D.left=parseInt(D.left,10)+parseInt(x,10)}if(D.left){D.left+="px"}b(v).css(b.extend({width:isNaN(E.width)?"auto":E.width+"px",height:isNaN(E.height)?"auto":E.height+"px",zIndex:E.zIndex,overflow:"hidden"},D)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":p.modalhead,"aria-hidden":"true"});if(typeof E.drag=="undefined"){E.drag=true}if(typeof E.resize=="undefined"){E.resize=true}if(E.drag){b(C).css("cursor","move");if(b.fn.jqDrag){b(v).jqDrag(C)}else{try{b(v).draggable({handle:b("#"+C.id)})}catch(B){}}}if(E.resize){if(b.fn.jqResize){b(v).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>");b("#"+p.themodal).jqResize(".jqResize",p.scrollelm?"#"+p.scrollelm:false)}else{try{b(v).resizable({handles:"se, sw",alsoResize:p.scrollelm?"#"+p.scrollelm:false})}catch(B){}}}if(E.closeOnEscape===true){b(v).keydown(function(c){if(c.which==27){var d=b("#"+p.themodal).data("onClose")||E.onClose;a.hideModal(this,{gb:E.gbox,jqm:E.jqModal,onClose:d})}})}},viewModal:function(a,e){e=b.extend({toTop:true,overlay:10,modal:false,onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:true,jqM:true},e||{});if(b.fn.jqm&&e.jqm===true){if(e.jqM){b(a).attr("aria-hidden","false").jqm(e).jqmShow()}else{b(a).attr("aria-hidden","false").jqmShow()}}else{if(e.gbox!==""){b(".jqgrid-overlay:first",e.gbox).show();b(a).data("gbox",e.gbox)}b(a).show().attr("aria-hidden","false");try{b(":input:visible",a)[0].focus()}catch(f){}}},info_dialog:function(e,u,z,q){var s={width:290,height:"auto",dataheight:"auto",drag:true,resize:false,caption:"<b>"+e+"</b>",left:250,top:170,zIndex:1000,jqModal:true,modal:false,closeOnEscape:true,align:"center",buttonalign:"center",buttons:[]};b.extend(s,q||{});var y=s.jqModal,a=this;if(b.fn.jqm&&!y){y=false}var w="";if(s.buttons.length>0){for(var x=0;x<s.buttons.length;x++){if(typeof s.buttons[x].id=="undefined"){s.buttons[x].id="info_button_"+x}w+="<a href='javascript:void(0)' id='"+s.buttons[x].id+"' class='fm-button ui-state-default ui-corner-all'>"+s.buttons[x].text+"</a>"}}var t=isNaN(s.dataheight)?s.dataheight:s.dataheight+"px",r="text-align:"+s.align+";";var A="<div id='info_id'>";A+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+t+";"+r+"'>"+u+"</div>";A+=z?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+s.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+z+"</a>"+w+"</div>":w!==""?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+s.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+w+"</div>":"";A+="</div>";try{if(b("#info_dialog").attr("aria-hidden")=="false"){this.hideModal("#info_dialog",{jqm:y})}b("#info_dialog").remove()}catch(v){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},A,s,"","",true);if(w){b.each(s.buttons,function(c){b("#"+this.id,"#info_id").bind("click",function(){s.buttons[c].onClick.call(b("#info_dialog"));return false})})}b("#closedialog","#info_id").click(function(c){a.hideModal("#info_dialog",{jqm:y});return false});b(".fm-button","#info_dialog").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});if(b.isFunction(s.beforeOpen)){s.beforeOpen()}this.viewModal("#info_dialog",{onHide:function(c){c.w.hide().remove();if(c.o){c.o.remove()}},modal:s.modal,jqm:y});if(b.isFunction(s.afterOpen)){s.afterOpen()}try{b("#info_dialog").focus()}catch(v){}},createEl:function(L,K,y,H,A){var z="";if(K.defaultValue){delete K.defaultValue}function G(c,d){if(b.isFunction(d.dataInit)){c.id=d.id;d.dataInit(c);delete d.id;delete d.dataInit}if(d.dataEvents){b.each(d.dataEvents,function(){if(this.data!==undefined){b(c).bind(this.type,this.data,this.fn)}else{b(c).bind(this.type,this.fn)}});delete d.dataEvents}return d}switch(L){case"textarea":z=document.createElement("textarea");if(H){if(!K.cols){b(z).css({width:"98%"})}}else{if(!K.cols){K.cols=20}}if(!K.rows){K.rows=2}if(y=="&nbsp;"||y=="&#160;"||(y.length==1&&y.charCodeAt(0)==160)){y=""}z.value=y;K=G(z,K);b(z).attr(K).attr({role:"textbox",multiline:"true"});break;case"checkbox":z=document.createElement("input");z.type="checkbox";if(!K.value){var a=y.toLowerCase();if(a.search(/(false|0|no|off|undefined)/i)<0&&a!==""){z.checked=true;z.defaultChecked=true;z.value=y}else{z.value="on"}b(z).attr("offval","off")}else{var E=K.value.split(":");if(y===E[0]){z.checked=true;z.defaultChecked=true}z.value=E[0];b(z).attr("offval",E[1]);try{delete K.value}catch(B){}}K=G(z,K);b(z).attr(K).attr("role","checkbox");break;case"select":z=document.createElement("select");z.setAttribute("role","select");var N,J=[];if(K.multiple===true){N=true;z.multiple="multiple";b(z).attr("aria-multiselectable","true")}else{N=false}if(typeof(K.dataUrl)!="undefined"){b.ajax(b.extend({url:K.dataUrl,type:"GET",dataType:"html",success:function(d,f){try{delete K.dataUrl;delete K.value}catch(h){}var g;if(typeof(K.buildSelect)!="undefined"){var c=K.buildSelect(d);g=b(c).html();delete K.buildSelect}else{g=b(d).html()}if(g){b(z).append(g);K=G(z,K);if(typeof K.size==="undefined"){K.size=N?3:1}if(N){J=y.split(",");J=b.map(J,function(j){return b.trim(j)})}else{J[0]=b.trim(y)

}b(z).attr(K);setTimeout(function(){b("option",z).each(function(j){if(j===0){this.selected=""}b(this).attr("role","option");if(b.inArray(b.trim(b(this).text()),J)>-1||b.inArray(b.trim(b(this).val()),J)>-1){this.selected="selected";if(!N){return false}}})},0)}}},A||{}))}else{if(K.value){var D;if(N){J=y.split(",");J=b.map(J,function(c){return b.trim(c)});if(typeof K.size==="undefined"){K.size=3}}else{K.size=1}if(typeof K.value==="function"){K.value=K.value()}var C,F,I;if(typeof K.value==="string"){C=K.value.split(";");for(D=0;D<C.length;D++){F=C[D].split(":");if(F.length>2){F[1]=b.map(F,function(c,d){if(d>0){return c}}).join(":")}I=document.createElement("option");I.setAttribute("role","option");I.value=F[0];I.innerHTML=F[1];if(!N&&(b.trim(F[0])==b.trim(y)||b.trim(F[1])==b.trim(y))){I.selected="selected"}if(N&&(b.inArray(b.trim(F[1]),J)>-1||b.inArray(b.trim(F[0]),J)>-1)){I.selected="selected"}z.appendChild(I)}}else{if(typeof K.value==="object"){var M=K.value;for(var e in M){if(M.hasOwnProperty(e)){I=document.createElement("option");I.setAttribute("role","option");I.value=e;I.innerHTML=M[e];if(!N&&(b.trim(e)==b.trim(y)||b.trim(M[e])==b.trim(y))){I.selected="selected"}if(N&&(b.inArray(b.trim(M[e]),J)>-1||b.inArray(b.trim(e),J)>-1)){I.selected="selected"}z.appendChild(I)}}}}K=G(z,K);try{delete K.value}catch(B){}b(z).attr(K)}}break;case"text":case"password":case"button":var x;if(L=="button"){x="button"}else{x="textbox"}z=document.createElement("input");z.type=L;z.value=y;K=G(z,K);if(L!="button"){if(H){if(!K.size){b(z).css({width:"98%"})}}else{if(!K.size){K.size=20}}}b(z).attr(K).attr("role",x);break;case"image":case"file":z=document.createElement("input");z.type=L;K=G(z,K);b(z).attr(K);break;case"custom":z=document.createElement("span");try{if(b.isFunction(K.custom_element)){var O=K.custom_element.call(this,y,K);if(O){O=b(O).addClass("customelement").attr({id:K.id,name:K.name});b(z).empty().append(O)}else{throw"e2"}}else{throw"e1"}}catch(B){if(B=="e1"){this.info_dialog(b.jgrid.errors.errcap,"function 'custom_element' "+b.jgrid.edit.msg.nodefined,b.jgrid.edit.bClose)}if(B=="e2"){this.info_dialog(b.jgrid.errors.errcap,"function 'custom_element' "+b.jgrid.edit.msg.novalue,b.jgrid.edit.bClose)}else{this.info_dialog(b.jgrid.errors.errcap,typeof(B)==="string"?B:B.message,b.jgrid.edit.bClose)}}break}return z},checkDate:function(r,A){var t=function(c){return(((c%4===0)&&(c%100!==0||(c%400===0)))?29:28)},u=function(d){for(var c=1;c<=d;c++){this[c]=31;if(c==4||c==6||c==9||c==11){this[c]=30}if(c==2){this[c]=29}}return this};var y={},a;r=r.toLowerCase();if(r.indexOf("/")!=-1){a="/"}else{if(r.indexOf("-")!=-1){a="-"}else{if(r.indexOf(".")!=-1){a="."}else{a="/"}}}r=r.split(a);A=A.split(a);if(A.length!=3){return false}var w=-1,j,x=-1,z=-1;for(var v=0;v<r.length;v++){var B=isNaN(A[v])?0:parseInt(A[v],10);y[r[v]]=B;j=r[v];if(j.indexOf("y")!=-1){w=v}if(j.indexOf("m")!=-1){z=v}if(j.indexOf("d")!=-1){x=v}}if(r[w]=="y"||r[w]=="yyyy"){j=4}else{if(r[w]=="yy"){j=2}else{j=-1}}var C=u(12),s;if(w===-1){return false}else{s=y[r[w]].toString();if(j==2&&s.length==1){j=1}if(s.length!=j||(y[r[w]]===0&&A[w]!="00")){return false}}if(z===-1){return false}else{s=y[r[z]].toString();if(s.length<1||y[r[z]]<1||y[r[z]]>12){return false}}if(x===-1){return false}else{s=y[r[x]].toString();if(s.length<1||y[r[x]]<1||y[r[x]]>31||(y[r[z]]==2&&y[r[x]]>t(y[r[w]]))||y[r[x]]>C[y[r[z]]]){return false}}return true},isEmpty:function(a){if(a.match(/^\s+$/)||a===""){return true}else{return false}},checkTime:function(e){var f=/^(\d{1,2}):(\d{2})([ap]m)?$/,a;if(!this.isEmpty(e)){a=e.match(f);if(a){if(a[3]){if(a[1]<1||a[1]>12){return false}}else{if(a[1]>23){return false}}if(a[2]>59){return false}}else{return false}}return true},checkValues:function(x,e,s){var u,t,a,w,r;if(typeof(e)=="string"){for(t=0,r=s.p.colModel.length;t<r;t++){if(s.p.colModel[t].name==e){u=s.p.colModel[t].editrules;e=t;try{a=s.p.colModel[t].formoptions.label}catch(g){}break}}}else{if(e>=0){u=s.p.colModel[e].editrules}}if(u){if(!a){a=s.p.colNames[e]}if(u.required===true){if(this.isEmpty(x)){return[false,a+": "+b.jgrid.edit.msg.required,""]}}var v=u.required===false?false:true;if(u.number===true){if(!(v===false&&this.isEmpty(x))){if(isNaN(x)){return[false,a+": "+b.jgrid.edit.msg.number,""]}}}if(typeof u.minValue!="undefined"&&!isNaN(u.minValue)){if(parseFloat(x)<parseFloat(u.minValue)){return[false,a+": "+b.jgrid.edit.msg.minValue+" "+u.minValue,""]}}if(typeof u.maxValue!="undefined"&&!isNaN(u.maxValue)){if(parseFloat(x)>parseFloat(u.maxValue)){return[false,a+": "+b.jgrid.edit.msg.maxValue+" "+u.maxValue,""]}}var y;if(u.email===true){if(!(v===false&&this.isEmpty(x))){y=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;if(!y.test(x)){return[false,a+": "+b.jgrid.edit.msg.email,""]}}}if(u.integer===true){if(!(v===false&&this.isEmpty(x))){if(isNaN(x)){return[false,a+": "+b.jgrid.edit.msg.integer,""]}if((x%1!==0)||(x.indexOf(".")!=-1)){return[false,a+": "+b.jgrid.edit.msg.integer,""]}}}if(u.date===true){if(!(v===false&&this.isEmpty(x))){if(s.p.colModel[e].formatoptions&&s.p.colModel[e].formatoptions.newformat){w=s.p.colModel[e].formatoptions.newformat}else{w=s.p.colModel[e].datefmt||"Y-m-d"}if(!this.checkDate(w,x)){return[false,a+": "+b.jgrid.edit.msg.date+" - "+w,""]}}}if(u.time===true){if(!(v===false&&this.isEmpty(x))){if(!this.checkTime(x)){return[false,a+": "+b.jgrid.edit.msg.date+" - hh:mm (am/pm)",""]}}}if(u.url===true){if(!(v===false&&this.isEmpty(x))){y=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;if(!y.test(x)){return[false,a+": "+b.jgrid.edit.msg.url,""]}}}if(u.custom===true){if(!(v===false&&this.isEmpty(x))){if(b.isFunction(u.custom_func)){var q=u.custom_func.call(s,x,a);if(b.isArray(q)){return q}else{return[false,b.jgrid.edit.msg.customarray,""]}}else{return[false,b.jgrid.edit.msg.customfcheck,""]}}}}return[true,"",""]}})})(jQuery);(function(c){var d=null;c.jgrid.extend({searchGrid:function(a){a=c.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,multipleSearch:false,cloneSearchRowOnAdd:true,sopt:null,stringResult:undefined,onClose:null,useDataProxy:false,overlay:true},c.jgrid.search,a||{});return this.each(function(){var y=this;if(!y.grid){return}var C="fbox_"+y.p.id,B=true;function G(m,o){var g=m.p.postData[o.sFilter];if(typeof(g)=="string"){g=c.jgrid.parse(g)}if(g){if(g.groupOp){m.SearchFilter.setGroupOp(g.groupOp)}if(g.rules){var f,h=0,l=g.rules.length,n=false;

for(;h<l;h++){f=g.rules[h];if(f.field!==undefined&&f.op!==undefined&&f.data!==undefined){n=m.SearchFilter.setFilter({sfref:m.SearchFilter.$.find(".sf:last"),filter:c.extend({},f)});if(n){m.SearchFilter.add()}}}}}}function E(g){if(a.onClose){var f=a.onClose(g);if(typeof f=="boolean"&&!f){return}}g.hide();if(a.overlay===true){c(".jqgrid-overlay:first","#gbox_"+y.p.id).hide()}}function D(){var f=c(".ui-searchFilter").length;if(f>1){var g=c("#"+C).css("zIndex");c("#"+C).css({zIndex:parseInt(g,10)+f})}c("#"+C).show();if(a.overlay===true){c(".jqgrid-overlay:first","#gbox_"+y.p.id).show()}try{c(":input:visible","#"+C)[0].focus()}catch(h){}}function I(l){var h=(l!==undefined),f=c("#"+y.p.id),g={};if(a.multipleSearch===false){g[a.sField]=l.rules[0].field;g[a.sValue]=l.rules[0].data;g[a.sOper]=l.rules[0].op}else{g[a.sFilter]=l}f[0].p.search=h;c.extend(f[0].p.postData,g);f.trigger("reloadGrid",[{page:1}]);if(a.closeAfterSearch){E(c("#"+C))}}function k(l){var f=l&&l.hasOwnProperty("reload")?l.reload:true,g=c("#"+y.p.id),h={};g[0].p.search=false;if(a.multipleSearch===false){h[a.sField]=h[a.sValue]=h[a.sOper]=""}else{h[a.sFilter]=""}c.extend(g[0].p.postData,h);if(f){g.trigger("reloadGrid",[{page:1}])}if(a.closeAfterReset){E(c("#"+C))}}if(c.fn.searchFilter){if(a.recreateFilter===true){c("#"+C).remove()}if(c("#"+C).html()!=null){if(c.isFunction(a.beforeShowSearch)){B=a.beforeShowSearch(c("#"+C));if(typeof(B)=="undefined"){B=true}}if(B===false){return}D();if(c.isFunction(a.afterShowSearch)){a.afterShowSearch(c("#"+C))}}else{var j=[],F=c("#"+y.p.id).jqGrid("getGridParam","colNames"),J=c("#"+y.p.id).jqGrid("getGridParam","colModel"),H=["eq","ne","lt","le","gt","ge","bw","bn","in","ni","ew","en","cn","nc"],z,K,A,b=[];if(a.sopt!==null){A=0;for(z=0;z<a.sopt.length;z++){if((K=c.inArray(a.sopt[z],H))!=-1){b[A]={op:a.sopt[z],text:a.odata[K]};A++}}}else{for(z=0;z<H.length;z++){b[z]={op:H[z],text:a.odata[z]}}}c.each(J,function(p,r){var h=(typeof r.search==="undefined")?true:r.search,l=(r.hidden===true),m=c.extend({},{text:F[p],itemval:r.index||r.name},this.searchoptions),q=(m.searchhidden===true);if(typeof m.sopt!=="undefined"){A=0;m.ops=[];if(m.sopt.length>0){for(z=0;z<m.sopt.length;z++){if((K=c.inArray(m.sopt[z],H))!=-1){m.ops[A]={op:m.sopt[z],text:a.odata[K]};A++}}}}if(typeof(this.stype)==="undefined"){this.stype="text"}if(this.stype=="select"){if(m.dataUrl!==undefined){}else{var n;if(m.value){n=m.value}else{if(this.editoptions){n=this.editoptions.value}}if(n){m.dataValues=[];if(typeof(n)==="string"){var o=n.split(";"),f;for(z=0;z<o.length;z++){f=o[z].split(":");m.dataValues[z]={value:f[0],text:f[1]}}}else{if(typeof(n)==="object"){z=0;for(var g in n){if(n.hasOwnProperty(g)){m.dataValues[z]={value:g,text:n[g]};z++}}}}}}}if((q&&h)||(h&&!l)){j.push(m)}});if(j.length>0){c("<div id='"+C+"' role='dialog' tabindex='-1'></div>").insertBefore("#gview_"+y.p.id);if(a.stringResult===undefined){a.stringResult=a.multipleSearch}y.SearchFilter=c("#"+C).searchFilter(j,{groupOps:a.groupOps,operators:b,onClose:E,resetText:a.Reset,searchText:a.Find,windowTitle:a.caption,rulesText:a.rulesText,matchText:a.matchText,onSearch:I,onReset:k,stringResult:a.stringResult,ajaxSelectOptions:c.extend({},c.jgrid.ajaxOptions,y.p.ajaxSelectOptions||{}),clone:a.cloneSearchRowOnAdd});c(".ui-widget-overlay","#"+C).remove();if(y.p.direction=="rtl"){c(".ui-closer","#"+C).css("float","left")}if(a.drag===true){c("#"+C+" table thead tr:first td:first").css("cursor","move");if(jQuery.fn.jqDrag){c("#"+C).jqDrag(c("#"+C+" table thead tr:first td:first"))}else{try{c("#"+C).draggable({handle:c("#"+C+" table thead tr:first td:first")})}catch(e){}}}if(a.multipleSearch===false){c(".ui-del, .ui-add, .ui-del, .ui-add-last, .matchText, .rulesText","#"+C).hide();c("select[name='groupOp']","#"+C).hide()}if(a.multipleSearch===true&&a.loadDefaults===true){G(y,a)}if(c.isFunction(a.onInitializeSearch)){a.onInitializeSearch(c("#"+C))}if(c.isFunction(a.beforeShowSearch)){B=a.beforeShowSearch(c("#"+C));if(typeof(B)=="undefined"){B=true}}if(B===false){return}D();if(c.isFunction(a.afterShowSearch)){a.afterShowSearch(c("#"+C))}if(a.closeOnEscape===true){c("#"+C).keydown(function(f){if(f.which==27){E(c("#"+C))}if(f.which==13){c(".ui-search",this).click()}})}}}}})},editGridRow:function(b,a){a=c.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true},c.jgrid.edit,a||{});d=a;return this.each(function(){var aR=this;if(!aR.grid||!b){return}var av=aR.p.id,ay="FrmGrid_"+av,aB="TblGrid_"+av,aN={themodal:"editmod"+av,modalhead:"edithd"+av,modalcontent:"editcnt"+av,scrollelm:ay},au=c.isFunction(d.beforeShowForm)?d.beforeShowForm:false,aj=c.isFunction(d.afterShowForm)?d.afterShowForm:false,ak=c.isFunction(d.beforeInitData)?d.beforeInitData:false,aH=c.isFunction(d.onInitializeForm)?d.onInitializeForm:false,ap=null,Y=true,ao=1,aF=0,at,ag,aq,aw;if(b=="new"){b="_empty";a.caption=a.addCaption}else{a.caption=a.editCaption}if(a.recreateForm===true&&c("#"+aN.themodal).html()!=null){c("#"+aN.themodal).remove()}var aL=true;if(a.checkOnUpdate&&a.jqModal&&!a.modal){aL=false}function aa(){c(".FormElement","#"+aB).each(function(j){var e=c(".customelement",this);if(e.length){var g=e[0],k=c(g).attr("name");c.each(aR.p.colModel,function(n,l){if(this.name==k&&this.editoptions&&c.isFunction(this.editoptions.custom_value)){try{at[k]=this.editoptions.custom_value(c("#"+k,"#"+aB),"get");if(at[k]===undefined){throw"e1"}}catch(m){if(m=="e1"){c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+c.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,m.message,jQuery.jgrid.edit.bClose)}}return true}})}else{switch(c(this).get(0).type){case"checkbox":if(c(this).attr("checked")){at[this.name]=c(this).val()}else{var h=c(this).attr("offval");at[this.name]=h}break;case"select-one":at[this.name]=c("option:selected",this).val();ag[this.name]=c("option:selected",this).text();break;case"select-multiple":at[this.name]=c(this).val();if(at[this.name]){at[this.name]=at[this.name].join(",")}else{at[this.name]=""}var f=[];c("option:selected",this).each(function(m,l){f[m]=c(l).text()});ag[this.name]=f.join(",");break;case"password":case"text":case"textarea":case"button":at[this.name]=c(this).val();break}if(aR.p.autoencode){at[this.name]=c.jgrid.htmlEncode(at[this.name])}}});return true}function aD(e,p,s,u){var h,o,f,t=0,q,j,g,m=[],v=false,n="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",k="";for(var r=1;r<=u;r++){k+=n}if(e!="_empty"){v=c(p).jqGrid("getInd",e)}c(p.p.colModel).each(function(x){h=this.name;if(this.editrules&&this.editrules.edithidden===true){o=false}else{o=this.hidden===true?true:false}j=o?"style='display:none'":"";if(h!=="cb"&&h!=="subgrid"&&this.editable===true&&h!=="rn"){if(v===false){q=""}else{if(h==p.p.ExpandColumn&&p.p.treeGrid===true){q=c("td:eq("+x+")",p.rows[v]).text()

}else{try{q=c.unformat(c("td:eq("+x+")",p.rows[v]),{rowId:e,colModel:this},x)}catch(z){q=c("td:eq("+x+")",p.rows[v]).html()}}}var y=c.extend({},this.editoptions||{},{id:h,name:h}),A=c.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),w=parseInt(A.rowpos,10)||t+1,B=parseInt((parseInt(A.colpos,10)||1)*2,10);if(e=="_empty"&&y.defaultValue){q=c.isFunction(y.defaultValue)?y.defaultValue():y.defaultValue}if(!this.edittype){this.edittype="text"}if(aR.p.autoencode){q=c.jgrid.htmlDecode(q)}g=c.jgrid.createEl(this.edittype,y,q,false,c.extend({},c.jgrid.ajaxOptions,p.p.ajaxSelectOptions||{}));if(q===""&&this.edittype=="checkbox"){q=c(g).attr("offval")}if(q===""&&this.edittype=="select"){q=c("option:eq(0)",g).text()}if(d.checkOnSubmit||d.checkOnUpdate){d._savedData[h]=q}c(g).addClass("FormElement");if(this.edittype=="text"||this.edittype=="textarea"){c(g).addClass("ui-widget-content ui-corner-all")}f=c(s).find("tr[rowpos="+w+"]");if(A.rowabove){var C=c("<tr><td class='contentinfo' colspan='"+(u*2)+"'>"+A.rowcontent+"</td></tr>");c(s).append(C);C[0].rp=w}if(f.length===0){f=c("<tr "+j+" rowpos='"+w+"'></tr>").addClass("FormData").attr("id","tr_"+h);c(f).append(k);c(s).append(f);f[0].rp=w}c("td:eq("+(B-2)+")",f[0]).html(typeof A.label==="undefined"?p.p.colNames[x]:A.label);c("td:eq("+(B-1)+")",f[0]).append(A.elmprefix).append(g).append(A.elmsuffix);m[t]=x;t++}});if(t>0){var l=c("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(u*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+p.p.id+"_id' value='"+e+"'/></td></tr>");l[0].rp=t+999;c(s).append(l);if(d.checkOnSubmit||d.checkOnUpdate){d._savedData[p.p.id+"_id"]=e}}return m}function aG(g,m,q){var h,p=0,l,n,f,o,k;if(d.checkOnSubmit||d.checkOnUpdate){d._savedData={};d._savedData[m.p.id+"_id"]=g}var j=m.p.colModel;if(g=="_empty"){c(j).each(function(r){h=this.name;f=c.extend({},this.editoptions||{});n=c("#"+c.jgrid.jqID(h),"#"+q);if(n[0]!=null){o="";if(f.defaultValue){o=c.isFunction(f.defaultValue)?f.defaultValue():f.defaultValue;if(n[0].type=="checkbox"){k=o.toLowerCase();if(k.search(/(false|0|no|off|undefined)/i)<0&&k!==""){n[0].checked=true;n[0].defaultChecked=true;n[0].value=o}else{n.attr({checked:"",defaultChecked:""})}}else{n.val(o)}}else{if(n[0].type=="checkbox"){n[0].checked=false;n[0].defaultChecked=false;o=c(n).attr("offval")}else{if(n[0].type&&n[0].type.substr(0,6)=="select"){n[0].selectedIndex=0}else{n.val(o)}}}if(d.checkOnSubmit===true||d.checkOnUpdate){d._savedData[h]=o}}});c("#id_g","#"+q).val(g);return}var e=c(m).jqGrid("getInd",g,true);if(!e){return}c("td",e).each(function(s){h=j[s].name;if(h!=="cb"&&h!=="subgrid"&&h!=="rn"&&j[s].editable===true){if(h==m.p.ExpandColumn&&m.p.treeGrid===true){l=c(this).text()}else{try{l=c.unformat(c(this),{rowId:g,colModel:j[s]},s)}catch(t){l=c(this).html()}}if(aR.p.autoencode){l=c.jgrid.htmlDecode(l)}if(d.checkOnSubmit===true||d.checkOnUpdate){d._savedData[h]=l}h=c.jgrid.jqID(h);switch(j[s].edittype){case"password":case"text":case"button":case"image":c("#"+h,"#"+q).val(l);break;case"textarea":if(l=="&nbsp;"||l=="&#160;"||(l.length==1&&l.charCodeAt(0)==160)){l=""}c("#"+h,"#"+q).val(l);break;case"select":var u=l.split(",");u=c.map(u,function(w){return c.trim(w)});c("#"+h+" option","#"+q).each(function(w){if(!j[s].editoptions.multiple&&(u[0]==c.trim(c(this).text())||u[0]==c.trim(c(this).val()))){this.selected=true}else{if(j[s].editoptions.multiple){if(c.inArray(c.trim(c(this).text()),u)>-1||c.inArray(c.trim(c(this).val()),u)>-1){this.selected=true}else{this.selected=false}}else{this.selected=false}}});break;case"checkbox":l=l+"";if(j[s].editoptions&&j[s].editoptions.value){var v=j[s].editoptions.value.split(":");if(v[0]==l){c("#"+h,"#"+q).attr("checked",true);c("#"+h,"#"+q).attr("defaultChecked",true)}else{c("#"+h,"#"+q).attr("checked",false);c("#"+h,"#"+q).attr("defaultChecked","")}}else{l=l.toLowerCase();if(l.search(/(false|0|no|off|undefined)/i)<0&&l!==""){c("#"+h,"#"+q).attr("checked",true);c("#"+h,"#"+q).attr("defaultChecked",true)}else{c("#"+h,"#"+q).attr("checked",false);c("#"+h,"#"+q).attr("defaultChecked","")}}break;case"custom":try{if(j[s].editoptions&&c.isFunction(j[s].editoptions.custom_value)){j[s].editoptions.custom_value(c("#"+h,"#"+q),"set",l)}else{throw"e1"}}catch(r){if(r=="e1"){c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+c.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}else{c.jgrid.info_dialog(jQuery.jgrid.errors.errcap,r.message,jQuery.jgrid.edit.bClose)}}break}p++}});if(p>0){c("#id_g","#"+aB).val(g)}}function aM(){var j,k=[true,"",""],g={},n=aR.p.prmNames,l,e;if(c.isFunction(d.beforeCheckValues)){var m=d.beforeCheckValues(at,c("#"+ay),at[aR.p.id+"_id"]=="_empty"?n.addoper:n.editoper);if(m&&typeof(m)==="object"){at=m}}for(var h in at){if(at.hasOwnProperty(h)){k=c.jgrid.checkValues(at[h],h,aR);if(k[0]===false){break}}}if(k[0]){if(c.isFunction(d.onclickSubmit)){g=d.onclickSubmit(d,at)||{}}if(c.isFunction(d.beforeSubmit)){k=d.beforeSubmit(at,c("#"+ay))}}if(k[0]&&!d.processing){d.processing=true;c("#sData","#"+aB+"_2").addClass("ui-state-active");e=n.oper;l=n.id;at[e]=(c.trim(at[aR.p.id+"_id"])=="_empty")?n.addoper:n.editoper;if(at[e]!=n.addoper){at[l]=at[aR.p.id+"_id"]}else{if(at[l]===undefined){at[l]=at[aR.p.id+"_id"]}}delete at[aR.p.id+"_id"];at=c.extend(at,d.editData,g);var f=c.extend({url:d.url?d.url:c(aR).jqGrid("getGridParam","editurl"),type:d.mtype,data:c.isFunction(d.serializeEditData)?d.serializeEditData(at):at,complete:function(r,p){if(p!="success"){k[0]=false;if(c.isFunction(d.errorTextFormat)){k[1]=d.errorTextFormat(r)}else{k[1]=p+" Status: '"+r.statusText+"'. Error code: "+r.status}}else{if(c.isFunction(d.afterSubmit)){k=d.afterSubmit(r,at)}}if(k[0]===false){c("#FormError>td","#"+aB).html(k[1]);c("#FormError","#"+aB).show()}else{c.each(aR.p.colModel,function(u,s){if(ag[this.name]&&this.formatter&&this.formatter=="select"){try{delete ag[this.name]}catch(t){}}});at=c.extend(at,ag);if(aR.p.autoencode){c.each(at,function(s,t){at[s]=c.jgrid.htmlDecode(t)})}d.reloadAfterSubmit=d.reloadAfterSubmit&&aR.p.datatype!="local";if(at[e]==n.addoper){if(!k[2]){k[2]=(parseInt(aR.p.records,10)+1)+""}at[l]=k[2];if(d.closeAfterAdd){if(d.reloadAfterSubmit){c(aR).trigger("reloadGrid")}else{c(aR).jqGrid("addRowData",k[2],at,a.addedrow);c(aR).jqGrid("setSelection",k[2])}c.jgrid.hideModal("#"+aN.themodal,{gb:"#gbox_"+av,jqm:a.jqModal,onClose:d.onClose})}else{if(d.clearAfterAdd){if(d.reloadAfterSubmit){c(aR).trigger("reloadGrid")}else{c(aR).jqGrid("addRowData",k[2],at,a.addedrow)}aG("_empty",aR,ay)}else{if(d.reloadAfterSubmit){c(aR).trigger("reloadGrid")}else{c(aR).jqGrid("addRowData",k[2],at,a.addedrow)}}}}else{if(d.reloadAfterSubmit){c(aR).trigger("reloadGrid");if(!d.closeAfterEdit){setTimeout(function(){c(aR).jqGrid("setSelection",at[l])},1000)}}else{if(aR.p.treeGrid===true){c(aR).jqGrid("setTreeRow",at[l],at)}else{c(aR).jqGrid("setRowData",at[l],at)}}if(d.closeAfterEdit){c.jgrid.hideModal("#"+aN.themodal,{gb:"#gbox_"+av,jqm:a.jqModal,onClose:d.onClose})}}if(c.isFunction(d.afterComplete)){j=r;setTimeout(function(){d.afterComplete(j,at,c("#"+ay));j=null},500)}}d.processing=false;if(d.checkOnSubmit||d.checkOnUpdate){c("#"+ay).data("disabled",false);if(d._savedData[aR.p.id+"_id"]!="_empty"){for(var o in d._savedData){if(at[o]){d._savedData[o]=at[o]}}}}c("#sData","#"+aB+"_2").removeClass("ui-state-active");try{c(":input:visible","#"+ay)[0].focus()

}catch(q){}},error:function(q,p,o){c("#FormError>td","#"+aB).html(p+" : "+o);c("#FormError","#"+aB).show();d.processing=false;c("#"+ay).data("disabled",false);c("#sData","#"+aB+"_2").removeClass("ui-state-active")}},c.jgrid.ajaxOptions,d.ajaxEditOptions);if(!f.url&&!d.useDataProxy){if(c.isFunction(aR.p.dataProxy)){d.useDataProxy=true}else{k[0]=false;k[1]+=" "+c.jgrid.errors.nourl}}if(k[0]){if(d.useDataProxy){aR.p.dataProxy.call(aR,f,"set_"+aR.p.id)}else{c.ajax(f)}}}if(k[0]===false){c("#FormError>td","#"+aB).html(k[1]);c("#FormError","#"+aB).show()}}function am(e,h){var g=false,f;for(f in e){if(e[f]!=h[f]){g=true;break}}return g}function aP(){var e=true;c("#FormError","#"+aB).hide();if(d.checkOnUpdate){at={};ag={};aa();aq=c.extend({},at,ag);aw=am(aq,d._savedData);if(aw){c("#"+ay).data("disabled",true);c(".confirm","#"+aN.themodal).show();e=false}}return e}function ab(){if(b!=="_empty"&&typeof(aR.p.savedRow)!=="undefined"&&aR.p.savedRow.length>0&&c.isFunction(c.fn.jqGrid.restoreRow)){for(var e=0;e<aR.p.savedRow.length;e++){if(aR.p.savedRow[e].id==b){c(aR).jqGrid("restoreRow",b);break}}}}if(c("#"+aN.themodal).html()!=null){if(ak){Y=ak(c("#"+ay));if(typeof(Y)=="undefined"){Y=true}}if(Y===false){return}ab();c(".ui-jqdialog-title","#"+aN.modalhead).html(a.caption);c("#FormError","#"+aB).hide();if(d.topinfo){c(".topinfo","#"+aB+"_2").html(d.topinfo);c(".tinfo","#"+aB+"_2").show()}else{c(".tinfo","#"+aB+"_2").hide()}if(d.bottominfo){c(".bottominfo","#"+aB+"_2").html(d.bottominfo);c(".binfo","#"+aB+"_2").show()}else{c(".binfo","#"+aB+"_2").hide()}aG(b,aR,ay);if(b=="_empty"||!d.viewPagerButtons){c("#pData, #nData","#"+aB+"_2").hide()}else{c("#pData, #nData","#"+aB+"_2").show()}if(d.processing===true){d.processing=false;c("#sData","#"+aB+"_2").removeClass("ui-state-active")}if(c("#"+ay).data("disabled")===true){c(".confirm","#"+aN.themodal).hide();c("#"+ay).data("disabled",false)}if(au){au(c("#"+ay))}c("#"+aN.themodal).data("onClose",d.onClose);c.jgrid.viewModal("#"+aN.themodal,{gbox:"#gbox_"+av,jqm:a.jqModal,jqM:false,overlay:a.overlay,modal:a.modal});if(!aL){c(".jqmOverlay").click(function(){if(!aP()){return false}c.jgrid.hideModal("#"+aN.themodal,{gb:"#gbox_"+av,jqm:a.jqModal,onClose:d.onClose});return false})}if(aj){aj(c("#"+ay))}}else{var aE=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px",ad=c("<form name='FormPost' id='"+ay+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+aE+";'></form>").data("disabled",false),ax=c("<table id='"+aB+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");if(ak){Y=ak(c("#"+ay));if(typeof(Y)=="undefined"){Y=true}}if(Y===false){return}ab();c(aR.p.colModel).each(function(f){var e=this.formoptions;ao=Math.max(ao,e?e.colpos||0:0);aF=Math.max(aF,e?e.rowpos||0:0)});c(ad).append(ax);var al=c("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+(ao*2)+"'></td></tr>");al[0].rp=0;c(ax).append(al);al=c("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+(ao*2)+"'>"+d.topinfo+"</td></tr>");al[0].rp=0;c(ax).append(al);var aQ=aR.p.direction=="rtl"?true:false,ae=aQ?"nData":"pData",ac=aQ?"pData":"nData";aD(b,aR,ax,ao);var aK="<a href='javascript:void(0)' id='"+ae+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",aJ="<a href='javascript:void(0)' id='"+ac+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",aO="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+a.bSubmit+"</a>",aC="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+a.bCancel+"</a>";var ah="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+aB+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(aQ?aJ+aK:aK+aJ)+"</td><td class='EditButton'>"+aO+aC+"</td></tr>";ah+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+d.bottominfo+"</td></tr>";ah+="</tbody></table>";if(aF>0){var az=[];c.each(c(ax)[0].rows,function(f,e){az[f]=e});az.sort(function(e,f){if(e.rp>f.rp){return 1}if(e.rp<f.rp){return -1}return 0});c.each(az,function(f,e){c("tbody",ax).append(e)})}a.gbox="#gbox_"+av;var aI=false;if(a.closeOnEscape===true){a.closeOnEscape=false;aI=true}var ai=c("<span></span>").append(ad).append(ah);c.jgrid.createModal(aN,ai,a,"#gview_"+aR.p.id,c("#gbox_"+aR.p.id)[0]);if(aQ){c("#pData, #nData","#"+aB+"_2").css("float","right");c(".EditButton","#"+aB+"_2").css("text-align","left")}if(d.topinfo){c(".tinfo","#"+aB+"_2").show()}if(d.bottominfo){c(".binfo","#"+aB+"_2").show()}ai=null;ah=null;c("#"+aN.themodal).keydown(function(f){var e=f.target;if(c("#"+ay).data("disabled")===true){return false}if(d.savekey[0]===true&&f.which==d.savekey[1]){if(e.tagName!="TEXTAREA"){c("#sData","#"+aB+"_2").trigger("click");return false}}if(f.which===27){if(!aP()){return false}if(aI){c.jgrid.hideModal(this,{gb:a.gbox,jqm:a.jqModal,onClose:d.onClose})}return false}if(d.navkeys[0]===true){if(c("#id_g","#"+aB).val()=="_empty"){return true}if(f.which==d.navkeys[1]){c("#pData","#"+aB+"_2").trigger("click");return false}if(f.which==d.navkeys[2]){c("#nData","#"+aB+"_2").trigger("click");return false}}});if(a.checkOnUpdate){c("a.ui-jqdialog-titlebar-close span","#"+aN.themodal).removeClass("jqmClose");c("a.ui-jqdialog-titlebar-close","#"+aN.themodal).unbind("click").click(function(){if(!aP()){return false}c.jgrid.hideModal("#"+aN.themodal,{gb:"#gbox_"+av,jqm:a.jqModal,onClose:d.onClose});return false})}a.saveicon=c.extend([true,"left","ui-icon-disk"],a.saveicon);a.closeicon=c.extend([true,"left","ui-icon-close"],a.closeicon);if(a.saveicon[0]===true){c("#sData","#"+aB+"_2").addClass(a.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.saveicon[2]+"'></span>")}if(a.closeicon[0]===true){c("#cData","#"+aB+"_2").addClass(a.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.closeicon[2]+"'></span>")}if(d.checkOnSubmit||d.checkOnUpdate){aO="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bYes+"</a>";aJ="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bNo+"</a>";aC="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bExit+"</a>";var ar,aA=a.zIndex||999;aA++;if(c.browser.msie&&c.browser.version==6){ar='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{ar=""}c("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+aA+";display:none;'>&#160;"+ar+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(aA+1)+"'>"+a.saveData+"<br/><br/>"+aO+aJ+aC+"</div>").insertAfter("#"+ay);c("#sNew","#"+aN.themodal).click(function(){aM();c("#"+ay).data("disabled",false);c(".confirm","#"+aN.themodal).hide();return false});c("#nNew","#"+aN.themodal).click(function(){c(".confirm","#"+aN.themodal).hide();c("#"+ay).data("disabled",false);setTimeout(function(){c(":input","#"+ay)[0].focus()},0);return false});c("#cNew","#"+aN.themodal).click(function(){c(".confirm","#"+aN.themodal).hide();c("#"+ay).data("disabled",false);

c.jgrid.hideModal("#"+aN.themodal,{gb:"#gbox_"+av,jqm:a.jqModal,onClose:d.onClose});return false})}if(aH){aH(c("#"+ay))}if(b=="_empty"||!d.viewPagerButtons){c("#pData,#nData","#"+aB+"_2").hide()}else{c("#pData,#nData","#"+aB+"_2").show()}if(au){au(c("#"+ay))}c("#"+aN.themodal).data("onClose",d.onClose);c.jgrid.viewModal("#"+aN.themodal,{gbox:"#gbox_"+av,jqm:a.jqModal,overlay:a.overlay,modal:a.modal});if(!aL){c(".jqmOverlay").click(function(){if(!aP()){return false}c.jgrid.hideModal("#"+aN.themodal,{gb:"#gbox_"+av,jqm:a.jqModal,onClose:d.onClose});return false})}if(aj){aj(c("#"+ay))}c(".fm-button","#"+aN.themodal).hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")});c("#sData","#"+aB+"_2").click(function(e){at={};ag={};c("#FormError","#"+aB).hide();aa();if(at[aR.p.id+"_id"]=="_empty"){aM()}else{if(a.checkOnSubmit===true){aq=c.extend({},at,ag);aw=am(aq,d._savedData);if(aw){c("#"+ay).data("disabled",true);c(".confirm","#"+aN.themodal).show()}else{aM()}}else{aM()}}return false});c("#cData","#"+aB+"_2").click(function(e){if(!aP()){return false}c.jgrid.hideModal("#"+aN.themodal,{gb:"#gbox_"+av,jqm:a.jqModal,onClose:d.onClose});return false});c("#nData","#"+aB+"_2").click(function(f){if(!aP()){return false}c("#FormError","#"+aB).hide();var e=Z();e[0]=parseInt(e[0],10);if(e[0]!=-1&&e[1][e[0]+1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("next",c("#"+ay),e[1][e[0]])}aG(e[1][e[0]+1],aR,ay);c(aR).jqGrid("setSelection",e[1][e[0]+1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("next",c("#"+ay),e[1][e[0]+1])}an(e[0]+1,e[1].length-1)}return false});c("#pData","#"+aB+"_2").click(function(e){if(!aP()){return false}c("#FormError","#"+aB).hide();var f=Z();if(f[0]!=-1&&f[1][f[0]-1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("prev",c("#"+ay),f[1][f[0]])}aG(f[1][f[0]-1],aR,ay);c(aR).jqGrid("setSelection",f[1][f[0]-1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("prev",c("#"+ay),f[1][f[0]-1])}an(f[0]-1,f[1].length-1)}return false})}function an(f,e,g){if(f===0){c("#pData","#"+aB+"_2").addClass("ui-state-disabled")}else{c("#pData","#"+aB+"_2").removeClass("ui-state-disabled")}if(f==e){c("#nData","#"+aB+"_2").addClass("ui-state-disabled")}else{c("#nData","#"+aB+"_2").removeClass("ui-state-disabled")}}function Z(){var f=c(aR).jqGrid("getDataIDs"),g=c("#id_g","#"+aB).val(),e=c.inArray(g,f);return[e,f]}var af=Z();an(af[0],af[1].length-1)})},viewGridRow:function(b,a){a=c.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true},c.jgrid.view,a||{});return this.each(function(){var I=this;if(!I.grid||!b){return}if(!a.imgpath){a.imgpath=I.p.imgpath}var O=I.p.id,U="ViewGrid_"+O,M="ViewTbl_"+O,ab={themodal:"viewmod"+O,modalhead:"viewhd"+O,modalcontent:"viewcnt"+O,scrollelm:U},V=c.isFunction(a.beforeInitData)?a.beforeInitData:false,Y=true,ad=1,ae=0;function aa(){if(a.closeOnEscape===true||a.navkeys[0]===true){setTimeout(function(){c(".ui-jqdialog-titlebar-close","#"+ab.modalhead).focus()},0)}}function W(t,n,p,g){var x,u,m,j=0,B,A,e=[],o=false,s="<td class='CaptionTD form-view-label ui-widget-content' width='"+a.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",q="",w="<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",r=["integer","number","currency"],k=0,l=0,v,y,f;for(var h=1;h<=g;h++){q+=h==1?s:w}c(n.p.colModel).each(function(C){if(this.editrules&&this.editrules.edithidden===true){u=false}else{u=this.hidden===true?true:false}if(!u&&this.align==="right"){if(this.formatter&&c.inArray(this.formatter,r)!==-1){k=Math.max(k,parseInt(this.width,10))}else{l=Math.max(l,parseInt(this.width,10))}}});v=k!==0?k:l!==0?l:0;o=c(n).jqGrid("getInd",t);c(n.p.colModel).each(function(ah){x=this.name;y=false;if(this.editrules&&this.editrules.edithidden===true){u=false}else{u=this.hidden===true?true:false}A=u?"style='display:none'":"";f=(typeof this.viewable!="boolean")?true:this.viewable;if(x!=="cb"&&x!=="subgrid"&&x!=="rn"&&f){if(o===false){B=""}else{if(x==n.p.ExpandColumn&&n.p.treeGrid===true){B=c("td:eq("+ah+")",n.rows[o]).text()}else{B=c("td:eq("+ah+")",n.rows[o]).html()}}y=this.align==="right"&&v!==0?true:false;var ai=c.extend({},this.editoptions||{},{id:x,name:x}),C=c.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),F=parseInt(C.rowpos,10)||j+1,D=parseInt((parseInt(C.colpos,10)||1)*2,10);if(C.rowabove){var E=c("<tr><td class='contentinfo' colspan='"+(g*2)+"'>"+C.rowcontent+"</td></tr>");c(p).append(E);E[0].rp=F}m=c(p).find("tr[rowpos="+F+"]");if(m.length===0){m=c("<tr "+A+" rowpos='"+F+"'></tr>").addClass("FormData").attr("id","trv_"+x);c(m).append(q);c(p).append(m);m[0].rp=F}c("td:eq("+(D-2)+")",m[0]).html("<b>"+(typeof C.label==="undefined"?n.p.colNames[ah]:C.label)+"</b>");c("td:eq("+(D-1)+")",m[0]).append("<span>"+B+"</span>").attr("id","v_"+x);if(y){c("td:eq("+(D-1)+") span",m[0]).css({"text-align":"right",width:v+"px"})}e[j]=ah;j++}});if(j>0){var z=c("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(g*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>");z[0].rp=j+99;c(p).append(z)}return e}function X(f,m){var k,l,g=0,h,j,e;e=c(m).jqGrid("getInd",f,true);if(!e){return}c("td",e).each(function(n){k=m.p.colModel[n].name;if(m.p.colModel[n].editrules&&m.p.colModel[n].editrules.edithidden===true){l=false}else{l=m.p.colModel[n].hidden===true?true:false}if(k!=="cb"&&k!=="subgrid"&&k!=="rn"){if(k==m.p.ExpandColumn&&m.p.treeGrid===true){h=c(this).text()}else{h=c(this).html()}j=c.extend({},m.p.colModel[n].editoptions||{});k=c.jgrid.jqID("v_"+k);c("#"+k+" span","#"+M).html(h);if(l){c("#"+k,"#"+M).parents("tr:first").hide()}g++}});if(g>0){c("#id_g","#"+M).val(f)}}if(c("#"+ab.themodal).html()!=null){if(V){Y=V(c("#"+U));if(typeof(Y)=="undefined"){Y=true}}if(Y===false){return}c(".ui-jqdialog-title","#"+ab.modalhead).html(a.caption);c("#FormError","#"+M).hide();X(b,I);if(c.isFunction(a.beforeShowForm)){a.beforeShowForm(c("#"+U))}c.jgrid.viewModal("#"+ab.themodal,{gbox:"#gbox_"+O,jqm:a.jqModal,jqM:false,overlay:a.overlay,modal:a.modal});aa()}else{var H=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px";var Q=c("<form name='FormPost' id='"+U+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+H+";'></form>"),Z=c("<table id='"+M+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(V){Y=V(c("#"+U));if(typeof(Y)=="undefined"){Y=true}}if(Y===false){return}c(I.p.colModel).each(function(f){var e=this.formoptions;ad=Math.max(ad,e?e.colpos||0:0);ae=Math.max(ae,e?e.rowpos||0:0)});c(Q).append(Z);W(b,I,Z,ad);var G=I.p.direction=="rtl"?true:false,L=G?"nData":"pData",af=G?"pData":"nData",K="<a href='javascript:void(0)' id='"+L+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",J="<a href='javascript:void(0)' id='"+af+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",N="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+a.bClose+"</a>";

if(ae>0){var ag=[];c.each(c(Z)[0].rows,function(f,e){ag[f]=e});ag.sort(function(e,f){if(e.rp>f.rp){return 1}if(e.rp<f.rp){return -1}return 0});c.each(ag,function(f,e){c("tbody",Z).append(e)})}a.gbox="#gbox_"+O;var P=false;if(a.closeOnEscape===true){a.closeOnEscape=false;P=true}var S=c("<span></span>").append(Q).append("<table border='0' class='EditTable' id='"+M+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+a.labelswidth+"'>"+(G?J+K:K+J)+"</td><td class='EditButton'>"+N+"</td></tr></tbody></table>");c.jgrid.createModal(ab,S,a,"#gview_"+I.p.id,c("#gview_"+I.p.id)[0]);if(G){c("#pData, #nData","#"+M+"_2").css("float","right");c(".EditButton","#"+M+"_2").css("text-align","left")}if(!a.viewPagerButtons){c("#pData, #nData","#"+M+"_2").hide()}S=null;c("#"+ab.themodal).keydown(function(e){if(e.which===27){if(P){c.jgrid.hideModal(this,{gb:a.gbox,jqm:a.jqModal,onClose:a.onClose})}return false}if(a.navkeys[0]===true){if(e.which===a.navkeys[1]){c("#pData","#"+M+"_2").trigger("click");return false}if(e.which===a.navkeys[2]){c("#nData","#"+M+"_2").trigger("click");return false}}});a.closeicon=c.extend([true,"left","ui-icon-close"],a.closeicon);if(a.closeicon[0]===true){c("#cData","#"+M+"_2").addClass(a.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.closeicon[2]+"'></span>")}if(c.isFunction(a.beforeShowForm)){a.beforeShowForm(c("#"+U))}c.jgrid.viewModal("#"+ab.themodal,{gbox:"#gbox_"+O,jqm:a.jqModal,modal:a.modal});c(".fm-button:not(.ui-state-disabled)","#"+M+"_2").hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")});aa();c("#cData","#"+M+"_2").click(function(e){c.jgrid.hideModal("#"+ab.themodal,{gb:"#gbox_"+O,jqm:a.jqModal,onClose:a.onClose});return false});c("#nData","#"+M+"_2").click(function(f){c("#FormError","#"+M).hide();var e=ac();e[0]=parseInt(e[0],10);if(e[0]!=-1&&e[1][e[0]+1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("next",c("#"+U),e[1][e[0]])}X(e[1][e[0]+1],I);c(I).jqGrid("setSelection",e[1][e[0]+1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("next",c("#"+U),e[1][e[0]+1])}T(e[0]+1,e[1].length-1)}aa();return false});c("#pData","#"+M+"_2").click(function(e){c("#FormError","#"+M).hide();var f=ac();if(f[0]!=-1&&f[1][f[0]-1]){if(c.isFunction(a.onclickPgButtons)){a.onclickPgButtons("prev",c("#"+U),f[1][f[0]])}X(f[1][f[0]-1],I);c(I).jqGrid("setSelection",f[1][f[0]-1]);if(c.isFunction(a.afterclickPgButtons)){a.afterclickPgButtons("prev",c("#"+U),f[1][f[0]-1])}T(f[0]-1,f[1].length-1)}aa();return false})}function T(f,e,g){if(f===0){c("#pData","#"+M+"_2").addClass("ui-state-disabled")}else{c("#pData","#"+M+"_2").removeClass("ui-state-disabled")}if(f==e){c("#nData","#"+M+"_2").addClass("ui-state-disabled")}else{c("#nData","#"+M+"_2").removeClass("ui-state-disabled")}}function ac(){var f=c(I).jqGrid("getDataIDs"),g=c("#id_g","#"+M).val(),e=c.inArray(g,f);return[e,f]}var R=ac();T(R[0],R[1].length-1)})},delGridRow:function(b,a){a=c.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},c.jgrid.del,a||{});d=a;return this.each(function(){var y=this;if(!y.grid){return}if(!b){return}var x=typeof a.beforeShowForm==="function"?true:false,G=typeof a.afterShowForm==="function"?true:false,L=c.isFunction(a.beforeInitData)?a.beforeInitData:false,I=y.p.id,H={},C=true,B="DelTbl_"+I,M,w,z,D,F={themodal:"delmod"+I,modalhead:"delhd"+I,modalcontent:"delcnt"+I,scrollelm:B};if(jQuery.isArray(b)){b=b.join()}if(c("#"+F.themodal).html()!=null){if(L){C=L();if(typeof(C)=="undefined"){C=true}}if(C===false){return}c("#DelData>td","#"+B).text(b);c("#DelError","#"+B).hide();if(d.processing===true){d.processing=false;c("#dData","#"+B).removeClass("ui-state-active")}if(x){a.beforeShowForm(c("#"+B))}c.jgrid.viewModal("#"+F.themodal,{gbox:"#gbox_"+I,jqm:a.jqModal,jqM:false,overlay:a.overlay,modal:a.modal});if(G){a.afterShowForm(c("#"+B))}}else{if(L){C=L();if(typeof(C)=="undefined"){C=true}}if(C===false){return}var K=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px";var A="<div id='"+B+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+K+";'>";A+="<table class='DelTable'><tbody>";A+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";A+="<tr id='DelData' style='display:none'><td >"+b+"</td></tr>";A+='<tr><td class="delmsg" style="white-space:pre;">'+a.msg+"</td></tr><tr><td >&#160;</td></tr>";A+="</tbody></table></div>";var E="<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+a.bSubmit+"</a>",J="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+a.bCancel+"</a>";A+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+B+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+E+"&#160;"+J+"</td></tr></tbody></table>";a.gbox="#gbox_"+I;c.jgrid.createModal(F,A,a,"#gview_"+y.p.id,c("#gview_"+y.p.id)[0]);c(".fm-button","#"+B+"_2").hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")});a.delicon=c.extend([true,"left","ui-icon-scissors"],a.delicon);a.cancelicon=c.extend([true,"left","ui-icon-cancel"],a.cancelicon);if(a.delicon[0]===true){c("#dData","#"+B+"_2").addClass(a.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.delicon[2]+"'></span>")}if(a.cancelicon[0]===true){c("#eData","#"+B+"_2").addClass(a.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.cancelicon[2]+"'></span>")}c("#dData","#"+B+"_2").click(function(g){var e=[true,""];H={};var h=c("#DelData>td","#"+B).text();if(typeof a.onclickSubmit==="function"){H=a.onclickSubmit(d,h)||{}}if(typeof a.beforeSubmit==="function"){e=a.beforeSubmit(h)}if(e[0]&&!d.processing){d.processing=true;c(this).addClass("ui-state-active");z=y.p.prmNames;M=c.extend({},d.delData,H);D=z.oper;M[D]=z.deloper;w=z.id;M[w]=h;var f=c.extend({url:d.url?d.url:c(y).jqGrid("getGridParam","editurl"),type:a.mtype,data:c.isFunction(a.serializeDelData)?a.serializeDelData(M):M,complete:function(l,n){if(n!="success"){e[0]=false;if(c.isFunction(d.errorTextFormat)){e[1]=d.errorTextFormat(l)}else{e[1]=n+" Status: '"+l.statusText+"'. Error code: "+l.status}}else{if(typeof d.afterSubmit==="function"){e=d.afterSubmit(l,M)}}if(e[0]===false){c("#DelError>td","#"+B).html(e[1]);c("#DelError","#"+B).show()}else{if(d.reloadAfterSubmit&&y.p.datatype!="local"){c(y).trigger("reloadGrid")}else{var j=[];j=h.split(",");if(y.p.treeGrid===true){try{c(y).jqGrid("delTreeNode",j[0])}catch(k){}}else{for(var m=0;m<j.length;m++){c(y).jqGrid("delRowData",j[m])}}y.p.selrow=null;y.p.selarrrow=[]}if(c.isFunction(d.afterComplete)){setTimeout(function(){d.afterComplete(l,h)},500)}}d.processing=false;c("#dData","#"+B+"_2").removeClass("ui-state-active");if(e[0]){c.jgrid.hideModal("#"+F.themodal,{gb:"#gbox_"+I,jqm:a.jqModal,onClose:d.onClose})}},error:function(k,j,l){c("#DelError>td","#"+B).html(j+" : "+l);c("#DelError","#"+B).show();d.processing=false;

c("#dData","#"+B+"_2").removeClass("ui-state-active")}},c.jgrid.ajaxOptions,a.ajaxDelOptions);if(!f.url&&!d.useDataProxy){if(c.isFunction(y.p.dataProxy)){d.useDataProxy=true}else{e[0]=false;e[1]+=" "+c.jgrid.errors.nourl}}if(e[0]){if(d.useDataProxy){y.p.dataProxy.call(y,f,"del_"+y.p.id)}else{c.ajax(f)}}}if(e[0]===false){c("#DelError>td","#"+B).html(e[1]);c("#DelError","#"+B).show()}return false});c("#eData","#"+B+"_2").click(function(e){c.jgrid.hideModal("#"+F.themodal,{gb:"#gbox_"+I,jqm:a.jqModal,onClose:d.onClose});return false});if(x){a.beforeShowForm(c("#"+B))}c.jgrid.viewModal("#"+F.themodal,{gbox:"#gbox_"+I,jqm:a.jqModal,overlay:a.overlay,modal:a.modal});if(G){a.afterShowForm(c("#"+B))}}if(a.closeOnEscape===true){setTimeout(function(){c(".ui-jqdialog-titlebar-close","#"+F.modalhead).focus()},0)}})},navGrid:function(l,b,m,k,n,o,a){b=c.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false},c.jgrid.nav,b||{});return this.each(function(){var z={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},h=this,j,A,f,y;if(!h.grid||typeof l!="string"){return}if(c("#"+z.themodal).html()===null){if(typeof window.innerWidth!="undefined"){j=window.innerWidth;A=window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){j=document.documentElement.clientWidth;A=document.documentElement.clientHeight}else{j=1024;A=768}}c.jgrid.createModal(z,"<div>"+b.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+h.p.id,jqModal:true,drag:true,resize:true,caption:b.alertcap,top:A/2-25,left:j/2-100,width:200,height:"auto",closeOnEscape:b.closeOnEscape},"","",true)}var e=1;if(b.cloneToTop&&h.p.toppager){e=2}for(var g=0;g<e;g++){var E,C=c("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),B="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",x,D;if(g===0){x=l;D=h.p.id;if(x==h.p.toppager){D+="_top";e=1}}else{x=h.p.toppager;D=h.p.id+"_top"}if(h.p.direction=="rtl"){c(C).attr("dir","rtl").css("float","right")}if(b.add){k=k||{};E=c("<td class='ui-pg-button ui-corner-all'></td>");c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.addicon+"'></span>"+b.addtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.addtitle||"",id:k.id||"add_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){if(typeof b.addfunc=="function"){b.addfunc()}else{c(h).jqGrid("editGridRow","new",k)}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.edit){E=c("<td class='ui-pg-button ui-corner-all'></td>");m=m||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.editicon+"'></span>"+b.edittext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.edittitle||"",id:m.id||"edit_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){var p=h.p.selrow;if(p){if(typeof b.editfunc=="function"){b.editfunc(p)}else{c(h).jqGrid("editGridRow",p,m)}}else{c.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+h.p.id,jqm:true});c("#jqg_alrt").focus()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.view){E=c("<td class='ui-pg-button ui-corner-all'></td>");a=a||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.viewicon+"'></span>"+b.viewtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.viewtitle||"",id:a.id||"view_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){var p=h.p.selrow;if(p){c(h).jqGrid("viewGridRow",p,a)}else{c.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+h.p.id,jqm:true});c("#jqg_alrt").focus()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.del){E=c("<td class='ui-pg-button ui-corner-all'></td>");n=n||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.delicon+"'></span>"+b.deltext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.deltitle||"",id:n.id||"del_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){var p;if(h.p.multiselect){p=h.p.selarrrow;if(p.length===0){p=null}}else{p=h.p.selrow}if(p){if("function"==typeof b.delfunc){b.delfunc(p)}else{c(h).jqGrid("delGridRow",p,n)}}else{c.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+h.p.id,jqm:true});c("#jqg_alrt").focus()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.add||b.edit||b.del||b.view){c("tr",C).append(B)}if(b.search){E=c("<td class='ui-pg-button ui-corner-all'></td>");o=o||{};c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.searchicon+"'></span>"+b.searchtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.searchtitle||"",id:o.id||"search_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){c(h).jqGrid("searchGrid",o)}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}if(b.refresh){E=c("<td class='ui-pg-button ui-corner-all'></td>");c(E).append("<div class='ui-pg-div'><span class='ui-icon "+b.refreshicon+"'></span>"+b.refreshtext+"</div>");c("tr",C).append(E);c(E,C).attr({title:b.refreshtitle||"",id:"refresh_"+D}).click(function(){if(!c(this).hasClass("ui-state-disabled")){if(c.isFunction(b.beforeRefresh)){b.beforeRefresh()}h.p.search=false;try{var p=h.p.id;c("#fbox_"+p).searchFilter().reset({reload:false});if(c.isFunction(h.clearToolbar)){h.clearToolbar(false)}}catch(q){}switch(b.refreshstate){case"firstpage":c(h).trigger("reloadGrid",[{page:1}]);break;case"current":c(h).trigger("reloadGrid",[{current:true}]);break}if(c.isFunction(b.afterRefresh)){b.afterRefresh()}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")});E=null}y=c(".ui-jqgrid").css("font-size")||"11px";c("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+y+";visibility:hidden;' ></div>");f=c(C).clone().appendTo("#testpg2").width();c("#testpg2").remove();c(x+"_"+b.position,x).append(C);if(h.p._nvtd){if(f>h.p._nvtd[0]){c(x+"_"+b.position,x).width(f);h.p._nvtd[0]=f}h.p._nvtd[1]=f}y=null;f=null;C=null}})},navButtonAdd:function(b,a){a=c.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},a||{});return this.each(function(){if(!this.grid){return}if(b.indexOf("#")!==0){b="#"+b}var k=c(".navtable",b)[0],h=this;if(k){var j=c("<td></td>");if(a.buttonicon.toString().toUpperCase()=="NONE"){c(j).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+a.caption+"</div>")}else{c(j).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+a.buttonicon+"'></span>"+a.caption+"</div>")

}if(a.id){c(j).attr("id",a.id)}if(a.position=="first"){if(k.rows[0].cells.length===0){c("tr",k).append(j)}else{c("tr td:eq(0)",k).before(j)}}else{c("tr",k).append(j)}c(j,k).attr("title",a.title||"").click(function(e){if(!c(this).hasClass("ui-state-disabled")){if(c.isFunction(a.onClickButton)){a.onClickButton.call(h,e)}}return false}).hover(function(){if(!c(this).hasClass("ui-state-disabled")){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")})}})},navSeparatorAdd:function(b,a){a=c.extend({sepclass:"ui-separator",sepcontent:""},a||{});return this.each(function(){if(!this.grid){return}if(b.indexOf("#")!==0){b="#"+b}var g=c(".navtable",b)[0];if(g){var h="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+a.sepclass+"'></span>"+a.sepcontent+"</td>";c("tr",g).append(h)}})},GridToForm:function(b,a){return this.each(function(){var h=this;if(!h.grid){return}var j=c(h).jqGrid("getRowData",b);if(j){for(var k in j){if(c("[name="+k+"]",a).is("input:radio")||c("[name="+k+"]",a).is("input:checkbox")){c("[name="+k+"]",a).each(function(){if(c(this).val()==j[k]){c(this).attr("checked","checked")}else{c(this).attr("checked","")}})}else{c("[name="+k+"]",a).val(j[k])}}}})},FormToGrid:function(g,b,a,h){return this.each(function(){var e=this;if(!e.grid){return}if(!a){a="set"}if(!h){h="first"}var k=c(b).serializeArray();var f={};c.each(k,function(m,j){f[j.name]=j.value});if(a=="add"){c(e).jqGrid("addRowData",g,f,h)}else{if(a=="set"){c(e).jqGrid("setRowData",g,f)}}})}})})(jQuery);(function(b){b.jgrid.extend({editRow:function(r,l,m,a,s,p,q,o,n){return this.each(function(){var f=this,k,e,h,g=0,u=null,c={},j,d;if(!f.grid){return}j=b(f).jqGrid("getInd",r,true);if(j===false){return}h=b(j).attr("editable")||"0";if(h=="0"&&!b(j).hasClass("not-editable-row")){d=f.p.colModel;b("td",j).each(function(t){k=d[t].name;var z=f.p.treeGrid===true&&k==f.p.ExpandColumn;if(z){e=b("span:first",this).html()}else{try{e=b.unformat(this,{rowId:r,colModel:d[t]},t)}catch(B){e=b(this).html()}}if(k!="cb"&&k!="subgrid"&&k!="rn"){if(f.p.autoencode){e=b.jgrid.htmlDecode(e)}c[k]=e;if(d[t].editable===true){if(u===null){u=t}if(z){b("span:first",this).html("")}else{b(this).html("")}var A=b.extend({},d[t].editoptions||{},{id:r+"_"+k,name:k});if(!d[t].edittype){d[t].edittype="text"}var C=b.jgrid.createEl(d[t].edittype,A,e,true,b.extend({},b.jgrid.ajaxOptions,f.p.ajaxSelectOptions||{}));b(C).addClass("editable");if(z){b("span:first",this).append(C)}else{b(this).append(C)}if(d[t].edittype=="select"&&d[t].editoptions.multiple===true&&b.browser.msie){b(C).width(b(C).width())}g++}}});if(g>0){c.id=r;f.p.savedRow.push(c);b(j).attr("editable","1");b("td:eq("+u+") input",j).focus();if(l===true){b(j).bind("keydown",function(t){if(t.keyCode===27){b(f).jqGrid("restoreRow",r,n)}if(t.keyCode===13){var w=t.target;if(w.tagName=="TEXTAREA"){return true}b(f).jqGrid("saveRow",r,a,s,p,q,o,n);return false}t.stopPropagation()})}if(b.isFunction(m)){m.call(f,r)}}}})},saveRow:function(j,k,m,l,n,o,a){return this.each(function(){var J=this,C,I={},g={},A,G,H,B;if(!J.grid){return}B=b(J).jqGrid("getInd",j,true);if(B===false){return}A=b(B).attr("editable");m=m?m:J.p.editurl;if(A==="1"){var D;b("td",B).each(function(p){D=J.p.colModel[p];C=D.name;if(C!="cb"&&C!="subgrid"&&D.editable===true&&C!="rn"){switch(D.edittype){case"checkbox":var q=["Yes","No"];if(D.editoptions){q=D.editoptions.value.split(":")}I[C]=b("input",this).attr("checked")?q[0]:q[1];break;case"text":case"password":case"textarea":case"button":I[C]=b("input, textarea",this).val();break;case"select":if(!D.editoptions.multiple){I[C]=b("select>option:selected",this).val();g[C]=b("select>option:selected",this).text()}else{var t=b("select",this),r=[];I[C]=b(t).val();if(I[C]){I[C]=I[C].join(",")}else{I[C]=""}b("select > option:selected",this).each(function(v,u){r[v]=b(u).text()});g[C]=r.join(",")}if(D.formatter&&D.formatter=="select"){g={}}break;case"custom":try{if(D.editoptions&&b.isFunction(D.editoptions.custom_value)){I[C]=D.editoptions.custom_value.call(J,b(".customelement",this),"get");if(I[C]===undefined){throw"e2"}}else{throw"e1"}}catch(s){if(s=="e1"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(s=="e2"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,s.message,jQuery.jgrid.edit.bClose)}}break}H=b.jgrid.checkValues(I[C],p,J);if(H[0]===false){H[1]=I[C]+" "+H[1];return false}if(J.p.autoencode){I[C]=b.jgrid.htmlEncode(I[C])}}});if(H[0]===false){try{var c=b.jgrid.findPos(b("#"+b.jgrid.jqID(j),J.grid.bDiv)[0]);b.jgrid.info_dialog(b.jgrid.errors.errcap,H[1],b.jgrid.edit.bClose,{left:c[0],top:c[1]})}catch(E){alert(H[1])}return}if(I){var F,d,h;d=J.p.prmNames;h=d.oper;F=d.id;I[h]=d.editoper;I[F]=j;if(typeof(J.p.inlineData)=="undefined"){J.p.inlineData={}}if(typeof(l)=="undefined"){l={}}I=b.extend({},I,J.p.inlineData,l)}if(m=="clientArray"){I=b.extend({},I,g);if(J.p.autoencode){b.each(I,function(p,q){I[p]=b.jgrid.htmlDecode(q)})}var e=b(J).jqGrid("setRowData",j,I);b(B).attr("editable","0");for(var f=0;f<J.p.savedRow.length;f++){if(J.p.savedRow[f].id==j){G=f;break}}if(G>=0){J.p.savedRow.splice(G,1)}if(b.isFunction(n)){n.call(J,j,e)}}else{b("#lui_"+J.p.id).show();b.ajax(b.extend({url:m,data:b.isFunction(J.p.serializeRowData)?J.p.serializeRowData.call(J,I):I,type:"POST",complete:function(r,q){b("#lui_"+J.p.id).hide();if(q==="success"){var s;if(b.isFunction(k)){s=k.call(J,r)}else{s=true}if(s===true){if(J.p.autoencode){b.each(I,function(u,t){I[u]=b.jgrid.htmlDecode(t)})}I=b.extend({},I,g);b(J).jqGrid("setRowData",j,I);b(B).attr("editable","0");for(var p=0;p<J.p.savedRow.length;p++){if(J.p.savedRow[p].id==j){G=p;break}}if(G>=0){J.p.savedRow.splice(G,1)}if(b.isFunction(n)){n.call(J,j,r)}}else{if(b.isFunction(o)){o.call(J,j,r,q)}b(J).jqGrid("restoreRow",j,a)}}},error:function(q,p){b("#lui_"+J.p.id).hide();if(b.isFunction(o)){o.call(J,j,q,p)}else{alert("Error Row: "+j+" Result: "+q.status+":"+q.statusText+" Status: "+p)}b(J).jqGrid("restoreRow",j,a)}},b.jgrid.ajaxOptions,J.p.ajaxRowOptions||{}))}b(B).unbind("keydown")}})},restoreRow:function(d,a){return this.each(function(){var c=this,o,m,e={};if(!c.grid){return}m=b(c).jqGrid("getInd",d,true);if(m===false){return}for(var n=0;n<c.p.savedRow.length;n++){if(c.p.savedRow[n].id==d){o=n;break}}if(o>=0){if(b.isFunction(b.fn.datepicker)){try{b("input.hasDatepicker","#"+b.jgrid.jqID(m.id)).datepicker("hide")}catch(k){}}b.each(c.p.colModel,function(g,f){if(this.editable===true&&this.name in c.p.savedRow[o]){e[this.name]=c.p.savedRow[o][this.name]}});b(c).jqGrid("setRowData",d,e);b(m).attr("editable","0").unbind("keydown");c.p.savedRow.splice(o,1)}if(b.isFunction(a)){a.call(c,d)}})}})})(jQuery);(function(b){b.jgrid.extend({editCell:function(e,f,a){return this.each(function(){var c=this,s,p,d;if(!c.grid||c.p.cellEdit!==true){return}f=parseInt(f,10);c.p.selrow=c.rows[e].id;if(!c.p.knv){b(c).jqGrid("GridNav")}if(c.p.savedRow.length>0){if(a===true){if(e==c.p.iRow&&f==c.p.iCol){return}}b(c).jqGrid("saveCell",c.p.savedRow[0].id,c.p.savedRow[0].ic)}else{window.setTimeout(function(){b("#"+c.p.knv).attr("tabindex","-1").focus()},0)}s=c.p.colModel[f].name;if(s=="subgrid"||s=="cb"||s=="rn"){return}d=b("td:eq("+f+")",c.rows[e]);if(c.p.colModel[f].editable===true&&a===true&&!d.hasClass("not-editable-cell")){if(parseInt(c.p.iCol,10)>=0&&parseInt(c.p.iRow,10)>=0){b("td:eq("+c.p.iCol+")",c.rows[c.p.iRow]).removeClass("edit-cell ui-state-highlight");

b(c.rows[c.p.iRow]).removeClass("selected-row ui-state-hover")}b(d).addClass("edit-cell ui-state-highlight");b(c.rows[e]).addClass("selected-row ui-state-hover");try{p=b.unformat(d,{rowId:c.rows[e].id,colModel:c.p.colModel[f]},f)}catch(r){p=b(d).html()}if(c.p.autoencode){p=b.jgrid.htmlDecode(p)}if(!c.p.colModel[f].edittype){c.p.colModel[f].edittype="text"}c.p.savedRow.push({id:e,ic:f,name:s,v:p});if(b.isFunction(c.p.formatCell)){var o=c.p.formatCell.call(c,c.rows[e].id,s,p,e,f);if(o!==undefined){p=o}}var q=b.extend({},c.p.colModel[f].editoptions||{},{id:e+"_"+s,name:s});var n=b.jgrid.createEl(c.p.colModel[f].edittype,q,p,true,b.extend({},b.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}));if(b.isFunction(c.p.beforeEditCell)){c.p.beforeEditCell.call(c,c.rows[e].id,s,p,e,f)}b(d).html("").append(n).attr("tabindex","0");window.setTimeout(function(){b(n).focus()},0);b("input, select, textarea",d).bind("keydown",function(g){if(g.keyCode===27){if(b("input.hasDatepicker",d).length>0){if(b(".ui-datepicker").is(":hidden")){b(c).jqGrid("restoreCell",e,f)}else{b("input.hasDatepicker",d).datepicker("hide")}}else{b(c).jqGrid("restoreCell",e,f)}}if(g.keyCode===13){b(c).jqGrid("saveCell",e,f)}if(g.keyCode==9){if(!c.grid.hDiv.loading){if(g.shiftKey){b(c).jqGrid("prevCell",e,f)}else{b(c).jqGrid("nextCell",e,f)}}else{return false}}g.stopPropagation()});if(b.isFunction(c.p.afterEditCell)){c.p.afterEditCell.call(c,c.rows[e].id,s,p,e,f)}}else{if(parseInt(c.p.iCol,10)>=0&&parseInt(c.p.iRow,10)>=0){b("td:eq("+c.p.iCol+")",c.rows[c.p.iRow]).removeClass("edit-cell ui-state-highlight");b(c.rows[c.p.iRow]).removeClass("selected-row ui-state-hover")}d.addClass("edit-cell ui-state-highlight");b(c.rows[e]).addClass("selected-row ui-state-hover");if(b.isFunction(c.p.onSelectCell)){p=d.html().replace(/\&#160\;/ig,"");c.p.onSelectCell.call(c,c.rows[e].id,s,p,e,f)}}c.p.iCol=f;c.p.iRow=e})},saveCell:function(d,a){return this.each(function(){var v=this,L;if(!v.grid||v.p.cellEdit!==true){return}if(v.p.savedRow.length>=1){L=0}else{L=null}if(L!==null){var D=b("td:eq("+a+")",v.rows[d]),F,O,J=v.p.colModel[a],N=J.name,K=b.jgrid.jqID(N);switch(J.edittype){case"select":if(!J.editoptions.multiple){F=b("#"+d+"_"+K+">option:selected",v.rows[d]).val();O=b("#"+d+"_"+K+">option:selected",v.rows[d]).text()}else{var z=b("#"+d+"_"+K,v.rows[d]),A=[];F=b(z).val();if(F){F.join(",")}else{F=""}b("option:selected",z).each(function(g,f){A[g]=b(f).text()});O=A.join(",")}if(J.formatter){O=F}break;case"checkbox":var C=["Yes","No"];if(J.editoptions){C=J.editoptions.value.split(":")}F=b("#"+d+"_"+K,v.rows[d]).attr("checked")?C[0]:C[1];O=F;break;case"password":case"text":case"textarea":case"button":F=b("#"+d+"_"+K,v.rows[d]).val();O=F;break;case"custom":try{if(J.editoptions&&b.isFunction(J.editoptions.custom_value)){F=J.editoptions.custom_value.call(v,b(".customelement",D),"get");if(F===undefined){throw"e2"}else{O=F}}else{throw"e1"}}catch(e){if(e=="e1"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(e=="e2"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,e.message,jQuery.jgrid.edit.bClose)}}break}if(O!=v.p.savedRow[L].v){if(b.isFunction(v.p.beforeSaveCell)){var B=v.p.beforeSaveCell.call(v,v.rows[d].id,N,F,d,a);if(B){F=B;O=B}}var M=b.jgrid.checkValues(F,a,v);if(M[0]===true){var H={};if(b.isFunction(v.p.beforeSubmitCell)){H=v.p.beforeSubmitCell.call(v,v.rows[d].id,N,F,d,a);if(!H){H={}}}if(b("input.hasDatepicker",D).length>0){b("input.hasDatepicker",D).datepicker("hide")}if(v.p.cellsubmit=="remote"){if(v.p.cellurl){var c={};if(v.p.autoencode){F=b.jgrid.htmlEncode(F)}c[N]=F;var E,G,I;I=v.p.prmNames;E=I.id;G=I.oper;c[E]=v.rows[d].id;c[G]=I.editoper;c=b.extend(H,c);b("#lui_"+v.p.id).show();v.grid.hDiv.loading=true;b.ajax(b.extend({url:v.p.cellurl,data:b.isFunction(v.p.serializeCellData)?v.p.serializeCellData.call(v,c):c,type:"POST",complete:function(g,h){b("#lui_"+v.p.id).hide();v.grid.hDiv.loading=false;if(h=="success"){if(b.isFunction(v.p.afterSubmitCell)){var f=v.p.afterSubmitCell.call(v,g,c.id,N,F,d,a);if(f[0]===true){b(D).empty();b(v).jqGrid("setCell",v.rows[d].id,a,O,false,false,true);b(D).addClass("dirty-cell");b(v.rows[d]).addClass("edited");if(b.isFunction(v.p.afterSaveCell)){v.p.afterSaveCell.call(v,v.rows[d].id,N,F,d,a)}v.p.savedRow.splice(0,1)}else{b.jgrid.info_dialog(b.jgrid.errors.errcap,f[1],b.jgrid.edit.bClose);b(v).jqGrid("restoreCell",d,a)}}else{b(D).empty();b(v).jqGrid("setCell",v.rows[d].id,a,O,false,false,true);b(D).addClass("dirty-cell");b(v.rows[d]).addClass("edited");if(b.isFunction(v.p.afterSaveCell)){v.p.afterSaveCell.call(v,v.rows[d].id,N,F,d,a)}v.p.savedRow.splice(0,1)}}},error:function(g,f){b("#lui_"+v.p.id).hide();v.grid.hDiv.loading=false;if(b.isFunction(v.p.errorCell)){v.p.errorCell.call(v,g,f);b(v).jqGrid("restoreCell",d,a)}else{b.jgrid.info_dialog(b.jgrid.errors.errcap,g.status+" : "+g.statusText+"<br/>"+f,b.jgrid.edit.bClose);b(v).jqGrid("restoreCell",d,a)}}},b.jgrid.ajaxOptions,v.p.ajaxCellOptions||{}))}else{try{b.jgrid.info_dialog(b.jgrid.errors.errcap,b.jgrid.errors.nourl,b.jgrid.edit.bClose);b(v).jqGrid("restoreCell",d,a)}catch(e){}}}if(v.p.cellsubmit=="clientArray"){b(D).empty();b(v).jqGrid("setCell",v.rows[d].id,a,O,false,false,true);b(D).addClass("dirty-cell");b(v.rows[d]).addClass("edited");if(b.isFunction(v.p.afterSaveCell)){v.p.afterSaveCell.call(v,v.rows[d].id,N,F,d,a)}v.p.savedRow.splice(0,1)}}else{try{window.setTimeout(function(){b.jgrid.info_dialog(b.jgrid.errors.errcap,F+" "+M[1],b.jgrid.edit.bClose)},100);b(v).jqGrid("restoreCell",d,a)}catch(e){}}}else{b(v).jqGrid("restoreCell",d,a)}}if(b.browser.opera){b("#"+v.p.knv).attr("tabindex","-1").focus()}else{window.setTimeout(function(){b("#"+v.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(d,a){return this.each(function(){var c=this,k;if(!c.grid||c.p.cellEdit!==true){return}if(c.p.savedRow.length>=1){k=0}else{k=null}if(k!==null){var e=b("td:eq("+a+")",c.rows[d]);if(b.isFunction(b.fn.datepicker)){try{b("input.hasDatepicker",e).datepicker("hide")}catch(j){}}b(e).empty().attr("tabindex","-1");b(c).jqGrid("setCell",c.rows[d].id,a,c.p.savedRow[k].v,false,false,true);if(b.isFunction(c.p.afterRestoreCell)){c.p.afterRestoreCell.call(c,c.rows[d].id,c.p.savedRow[k].v,d,a)}c.p.savedRow.splice(0,1)}window.setTimeout(function(){b("#"+c.p.knv).attr("tabindex","-1").focus()},0)})},nextCell:function(d,a){return this.each(function(){var c=this,g=false;if(!c.grid||c.p.cellEdit!==true){return}for(var h=a+1;h<c.p.colModel.length;h++){if(c.p.colModel[h].editable===true){g=h;break}}if(g!==false){b(c).jqGrid("editCell",d,g,true)}else{if(c.p.savedRow.length>0){b(c).jqGrid("saveCell",d,a)}}})},prevCell:function(d,a){return this.each(function(){var c=this,g=false;if(!c.grid||c.p.cellEdit!==true){return}for(var h=a-1;h>=0;h--){if(c.p.colModel[h].editable===true){g=h;break}}if(g!==false){b(c).jqGrid("editCell",d,g,true)}else{if(c.p.savedRow.length>0){b(c).jqGrid("saveCell",d,a)}}})},GridNav:function(){return this.each(function(){var h=this;if(!h.grid||h.p.cellEdit!==true){return}h.p.knv=h.p.id+"_kn";var j=b("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+h.p.knv+"'></span></span>"),l,m;b(j).insertBefore(h.grid.cDiv);b("#"+h.p.knv).focus().keydown(function(c){m=c.keyCode;

if(h.p.direction=="rtl"){if(m==37){m=39}else{if(m==39){m=37}}}switch(m){case 38:if(h.p.iRow-1>0){k(h.p.iRow-1,h.p.iCol,"vu");b(h).jqGrid("editCell",h.p.iRow-1,h.p.iCol,false)}break;case 40:if(h.p.iRow+1<=h.rows.length-1){k(h.p.iRow+1,h.p.iCol,"vd");b(h).jqGrid("editCell",h.p.iRow+1,h.p.iCol,false)}break;case 37:if(h.p.iCol-1>=0){l=a(h.p.iCol-1,"lft");k(h.p.iRow,l,"h");b(h).jqGrid("editCell",h.p.iRow,l,false)}break;case 39:if(h.p.iCol+1<=h.p.colModel.length-1){l=a(h.p.iCol+1,"rgt");k(h.p.iRow,l,"h");b(h).jqGrid("editCell",h.p.iRow,l,false)}break;case 13:if(parseInt(h.p.iCol,10)>=0&&parseInt(h.p.iRow,10)>=0){b(h).jqGrid("editCell",h.p.iRow,h.p.iCol,true)}break}return false});function k(d,f,e){if(e.substr(0,1)=="v"){var x=b(h.grid.bDiv)[0].clientHeight,c=b(h.grid.bDiv)[0].scrollTop,y=h.rows[d].offsetTop+h.rows[d].clientHeight,t=h.rows[d].offsetTop;if(e=="vd"){if(y>=x){b(h.grid.bDiv)[0].scrollTop=b(h.grid.bDiv)[0].scrollTop+h.rows[d].clientHeight}}if(e=="vu"){if(t<c){b(h.grid.bDiv)[0].scrollTop=b(h.grid.bDiv)[0].scrollTop-h.rows[d].clientHeight}}}if(e=="h"){var u=b(h.grid.bDiv)[0].clientWidth,v=b(h.grid.bDiv)[0].scrollLeft,w=h.rows[d].cells[f].offsetLeft+h.rows[d].cells[f].clientWidth,g=h.rows[d].cells[f].offsetLeft;if(w>=u+parseInt(v,10)){b(h.grid.bDiv)[0].scrollLeft=b(h.grid.bDiv)[0].scrollLeft+h.rows[d].cells[f].clientWidth}else{if(g<v){b(h.grid.bDiv)[0].scrollLeft=b(h.grid.bDiv)[0].scrollLeft-h.rows[d].cells[f].clientWidth}}}}function a(c,f){var d,e;if(f=="lft"){d=c+1;for(e=c;e>=0;e--){if(h.p.colModel[e].hidden!==true){d=e;break}}}if(f=="rgt"){d=c-1;for(e=c;e<h.p.colModel.length;e++){if(h.p.colModel[e].hidden!==true){d=e;break}}}return d}})},getChangedCells:function(d){var a=[];if(!d){d="all"}this.each(function(){var c=this,f;if(!c.grid||c.p.cellEdit!==true){return}b(c.rows).each(function(h){var e={};if(b(this).hasClass("edited")){b("td",this).each(function(k){f=c.p.colModel[k].name;if(f!=="cb"&&f!=="subgrid"){if(d=="dirty"){if(b(this).hasClass("dirty-cell")){try{e[f]=b.unformat(this,{rowId:c.rows[h].id,colModel:c.p.colModel[k]},k)}catch(g){e[f]=b.jgrid.htmlDecode(b(this).html())}}}else{try{e[f]=b.unformat(this,{rowId:c.rows[h].id,colModel:c.p.colModel[k]},k)}catch(g){e[f]=b.jgrid.htmlDecode(b(this).html())}}}});e.id=this.id;a.push(e)}})});return a}})})(jQuery);(function(b){b.jgrid.extend({setSubGrid:function(){return this.each(function(){var e=this,a;e.p.colNames.unshift("");e.p.colModel.unshift({name:"subgrid",width:b.browser.safari?e.p.subGridWidth+e.p.cellLayout:e.p.subGridWidth,sortable:false,resizable:false,hidedlg:true,search:false,fixed:true});a=e.p.subGridModel;if(a[0]){a[0].align=b.extend([],a[0].align||[]);for(var f=0;f<a[0].name.length;f++){a[0].align[f]=a[0].align[f]||"left"}}})},addSubGridCell:function(g,j){var k="",h,a;this.each(function(){k=this.formatCol(g,j);h=this.p.gridview;a=this.p.id});if(h===false){return'<td role="grid" aria-describedby="'+a+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+k+"><a href='javascript:void(0);'><span class='ui-icon ui-icon-plus'></span></a></td>"}else{return'<td role="grid" aria-describedby="'+a+'_subgrid" '+k+"></td>"}},addSubGrid:function(a,d){return this.each(function(){var t=this;if(!t.grid){return}var z=function(g,h,e){var f=b("<td align='"+t.p.subGridModel[0].align[e]+"'></td>").html(h);b(g).append(f)};var A=function(l,e){var f,h,j,g=b("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),m=b("<tr></tr>");for(h=0;h<t.p.subGridModel[0].name.length;h++){f=b("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+t.p.direction+"'></th>");b(f).html(t.p.subGridModel[0].name[h]);b(f).width(t.p.subGridModel[0].width[h]);b(m).append(f)}b(g).append(m);if(l){j=t.p.xmlReader.subgrid;b(j.root+" "+j.row,l).each(function(){m=b("<tr class='ui-widget-content ui-subtblcell'></tr>");if(j.repeatitems===true){b(j.cell,this).each(function(o){z(m,b(this).text()||"&#160;",o)})}else{var n=t.p.subGridModel[0].mapping||t.p.subGridModel[0].name;if(n){for(h=0;h<n.length;h++){z(m,b(n[h],this).text()||"&#160;",h)}}}b(g).append(m)})}var k=b("table:first",t.grid.bDiv).attr("id")+"_";b("#"+k+e).append(g);t.grid.hDiv.loading=false;b("#load_"+t.p.id).hide();return false};var y=function(l,o){var j,g,n,k,f,p,C=b("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),e=b("<tr></tr>");for(n=0;n<t.p.subGridModel[0].name.length;n++){j=b("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+t.p.direction+"'></th>");b(j).html(t.p.subGridModel[0].name[n]);b(j).width(t.p.subGridModel[0].width[n]);b(e).append(j)}b(C).append(e);if(l){f=t.p.jsonReader.subgrid;g=l[f.root];if(typeof g!=="undefined"){for(n=0;n<g.length;n++){k=g[n];e=b("<tr class='ui-widget-content ui-subtblcell'></tr>");if(f.repeatitems===true){if(f.cell){k=k[f.cell]}for(p=0;p<k.length;p++){z(e,k[p]||"&#160;",p)}}else{var m=t.p.subGridModel[0].mapping||t.p.subGridModel[0].name;if(m.length){for(p=0;p<m.length;p++){z(e,k[m[p]]||"&#160;",p)}}}b(C).append(e)}}}var h=b("table:first",t.grid.bDiv).attr("id")+"_";b("#"+h+o).append(C);t.grid.hDiv.loading=false;b("#load_"+t.p.id).hide();return false};var r=function(f){var j,e,g,h;j=b(f).attr("id");e={nd_:(new Date().getTime())};e[t.p.prmNames.subgridid]=j;if(!t.p.subGridModel[0]){return false}if(t.p.subGridModel[0].params){for(h=0;h<t.p.subGridModel[0].params.length;h++){for(g=0;g<t.p.colModel.length;g++){if(t.p.colModel[g].name==t.p.subGridModel[0].params[h]){e[t.p.colModel[g].name]=b("td:eq("+g+")",f).text().replace(/\&#160\;/ig,"")}}}}if(!t.grid.hDiv.loading){t.grid.hDiv.loading=true;b("#load_"+t.p.id).show();if(!t.p.subgridtype){t.p.subgridtype=t.p.datatype}if(b.isFunction(t.p.subgridtype)){t.p.subgridtype.call(t,e)}else{t.p.subgridtype=t.p.subgridtype.toLowerCase()}switch(t.p.subgridtype){case"xml":case"json":b.ajax(b.extend({type:t.p.mtype,url:t.p.subGridUrl,dataType:t.p.subgridtype,data:b.isFunction(t.p.serializeSubGridData)?t.p.serializeSubGridData.call(t,e):e,complete:function(k){if(t.p.subgridtype=="xml"){A(k.responseXML,j)}else{y(b.jgrid.parse(k.responseText),j)}k=null}},b.jgrid.ajaxOptions,t.p.ajaxSubgridOptions||{}));break}}return false};var s,q,c,v,u,w,x;b("td:eq("+d+")",a).click(function(e){if(b(this).hasClass("sgcollapsed")){c=t.p.id;s=b(this).parent();v=d>=1?"<td colspan='"+d+"'>&#160;</td>":"";q=b(s).attr("id");x=true;if(b.isFunction(t.p.subGridBeforeExpand)){x=t.p.subGridBeforeExpand.call(t,c+"_"+q,q)}if(x===false){return false}u=0;b.each(t.p.colModel,function(f,g){if(this.hidden===true||this.name=="rn"||this.name=="cb"){u++}});w="<tr role='row' class='ui-subgrid'>"+v+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon ui-icon-carat-1-sw'/></td><td colspan='"+parseInt(t.p.colNames.length-1-u,10)+"' class='ui-widget-content subgrid-data'><div id="+c+"_"+q+" class='tablediv'>";b(this).parent().after(w+"</div></td></tr>");if(b.isFunction(t.p.subGridRowExpanded)){t.p.subGridRowExpanded.call(t,c+"_"+q,q)}else{r(s)}b(this).html("<a href='javascript:void(0);'><span class='ui-icon ui-icon-minus'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded")}else{if(b(this).hasClass("sgexpanded")){x=true;if(b.isFunction(t.p.subGridRowColapsed)){s=b(this).parent();q=b(s).attr("id");x=t.p.subGridRowColapsed.call(t,c+"_"+q,q)}if(x===false){return false}b(this).parent().next().remove(".ui-subgrid");b(this).html("<a href='javascript:void(0);'><span class='ui-icon ui-icon-plus'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}}return false});t.subGridXml=function(e,f){A(e,f)

};t.subGridJson=function(e,f){y(e,f)}})},expandSubGridRow:function(a){return this.each(function(){var f=this;if(!f.grid&&!a){return}if(f.p.subGrid===true){var h=b(this).jqGrid("getInd",a,true);if(h){var g=b("td.sgcollapsed",h)[0];if(g){b(g).trigger("click")}}}})},collapseSubGridRow:function(a){return this.each(function(){var f=this;if(!f.grid&&!a){return}if(f.p.subGrid===true){var h=b(this).jqGrid("getInd",a,true);if(h){var g=b("td.sgexpanded",h)[0];if(g){b(g).trigger("click")}}}})},toggleSubGridRow:function(a){return this.each(function(){var f=this;if(!f.grid&&!a){return}if(f.p.subGrid===true){var h=b(this).jqGrid("getInd",a,true);if(h){var g=b("td.sgcollapsed",h)[0];if(g){b(g).trigger("click")}else{g=b("td.sgexpanded",h)[0];if(g){b(g).trigger("click")}}}}})}})})(jQuery);(function(b){b.jgrid.extend({setTreeNode:function(a,d){return this.each(function(){var w=this;if(!w.grid||!w.p.treeGrid){return}var s=w.p.expColInd,u=w.p.treeReader.expanded_field,y=w.p.treeReader.leaf_field,z=w.p.treeReader.level_field,v=w.p.treeReader.loaded;d.level=a[z];if(w.p.treeGridModel=="nested"){var c=a[w.p.treeReader.left_field],q=a[w.p.treeReader.right_field];if(!a[y]){a[y]=(parseInt(q,10)===parseInt(c,10)+1)?"true":"false"}}else{}var t=parseInt(a[z],10),x,r;if(w.p.tree_root_level===0){x=t+1;r=t}else{x=t;r=t-1}var A="<div class='tree-wrap tree-wrap-"+w.p.direction+"' style='width:"+(x*18)+"px;'>";A+="<div style='"+(w.p.direction=="rtl"?"right:":"left:")+(r*18)+"px;' class='ui-icon ";if(a[v]!=undefined){if(a[v]=="true"||a[v]===true){a[v]=true}else{a[v]=false}}if(a[y]=="true"||a[y]===true){A+=w.p.treeIcons.leaf+" tree-leaf'";a[y]=true;a[u]=false}else{if(a[u]=="true"||a[u]===true){A+=w.p.treeIcons.minus+" tree-minus treeclick'";a[u]=true}else{A+=w.p.treeIcons.plus+" tree-plus treeclick'";a[u]=false}a[y]=false}A+="</div></div>";if(!w.p.loadonce){a[w.p.localReader.id]=d.id;w.p.data.push(a);w.p._index[d.id]=w.p.data.length-1}if(parseInt(a[z],10)!==parseInt(w.p.tree_root_level,10)){if(!b(w).jqGrid("isVisibleNode",a)){b(d).css("display","none")}}b("td:eq("+s+")",d).wrapInner("<span></span>").prepend(A);b(".treeclick",d).bind("click",function(g){var h=g.target||g.srcElement,e=b(h,w.rows).closest("tr.jqgrow")[0].id,f=w.p._index[e],j=w.p.treeReader.leaf_field,k=w.p.treeReader.expanded_field;if(!w.p.data[f][j]){if(w.p.data[f][k]){b(w).jqGrid("collapseRow",w.p.data[f]);b(w).jqGrid("collapseNode",w.p.data[f])}else{b(w).jqGrid("expandRow",w.p.data[f]);b(w).jqGrid("expandNode",w.p.data[f])}}return false});if(w.p.ExpandColClick===true){b("span",d).css("cursor","pointer").bind("click",function(g){var h=g.target||g.srcElement,e=b(h,w.rows).closest("tr.jqgrow")[0].id,f=w.p._index[e],j=w.p.treeReader.leaf_field,k=w.p.treeReader.expanded_field;if(!w.p.data[f][j]){if(w.p.data[f][k]){b(w).jqGrid("collapseRow",w.p.data[f]);b(w).jqGrid("collapseNode",w.p.data[f])}else{b(w).jqGrid("expandRow",w.p.data[f]);b(w).jqGrid("expandNode",w.p.data[f])}}b(w).jqGrid("setSelection",e);return false})}})},setTreeGrid:function(){return this.each(function(){var f=this,g=0,a;if(!f.p.treeGrid){return}if(!f.p.treedatatype){b.extend(f.p,{treedatatype:f.p.datatype})}f.p.subGrid=false;f.p.altRows=false;f.p.pgbuttons=false;f.p.pginput=false;f.p.multiselect=false;f.p.rowList=[];a="ui-icon-triangle-1-"+(f.p.direction=="rtl"?"w":"e");f.p.treeIcons=b.extend({plus:a,minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},f.p.treeIcons||{});if(f.p.treeGridModel=="nested"){f.p.treeReader=b.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded"},f.p.treeReader)}else{if(f.p.treeGridModel=="adjacency"){f.p.treeReader=b.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded"},f.p.treeReader)}}for(var h in f.p.colModel){if(f.p.colModel.hasOwnProperty(h)){if(f.p.colModel[h].name==f.p.ExpandColumn){f.p.expColInd=g;break}g++}}if(!f.p.expColInd){f.p.expColInd=0}b.each(f.p.treeReader,function(d,c){if(c){f.p.colNames.push(c);f.p.colModel.push({name:c,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})})},expandRow:function(a){this.each(function(){var f=this;if(!f.grid||!f.p.treeGrid){return}var g=b(f).jqGrid("getNodeChildren",a),h=f.p.treeReader.expanded_field;b(g).each(function(d){var c=b.jgrid.getAccessor(this,f.p.localReader.id);b("#"+c,f.grid.bDiv).css("display","");if(this[h]){b(f).jqGrid("expandRow",this)}})})},collapseRow:function(a){this.each(function(){var f=this;if(!f.grid||!f.p.treeGrid){return}var g=b(f).jqGrid("getNodeChildren",a),h=f.p.treeReader.expanded_field;b(g).each(function(d){var c=b.jgrid.getAccessor(this,f.p.localReader.id);b("#"+c,f.grid.bDiv).css("display","none");if(this[h]){b(f).jqGrid("collapseRow",this)}})})},getRootNodes:function(){var a=[];this.each(function(){var f=this;if(!f.grid||!f.p.treeGrid){return}switch(f.p.treeGridModel){case"nested":var g=f.p.treeReader.level_field;b(f.p.data).each(function(c){if(parseInt(this[g],10)===parseInt(f.p.tree_root_level,10)){a.push(this)}});break;case"adjacency":var h=f.p.treeReader.parent_id_field;b(f.p.data).each(function(c){if(this[h]===null||String(this[h]).toLowerCase()=="null"){a.push(this)}});break}});return a},getNodeDepth:function(d){var a=null;this.each(function(){if(!this.grid||!this.p.treeGrid){return}var c=this;switch(c.p.treeGridModel){case"nested":var f=c.p.treeReader.level_field;a=parseInt(d[f],10)-parseInt(c.p.tree_root_level,10);break;case"adjacency":a=b(c).jqGrid("getNodeAncestors",d).length;break}});return a},getNodeParent:function(d){var a=null;this.each(function(){var r=this;if(!r.grid||!r.p.treeGrid){return}switch(r.p.treeGridModel){case"nested":var s=r.p.treeReader.left_field,c=r.p.treeReader.right_field,q=r.p.treeReader.level_field,n=parseInt(d[s],10),o=parseInt(d[c],10),u=parseInt(d[q],10);b(this.p.data).each(function(){if(parseInt(this[q],10)===u-1&&parseInt(this[s],10)<n&&parseInt(this[c],10)>o){a=this;return false}});break;case"adjacency":var p=r.p.treeReader.parent_id_field,t=r.p.localReader.id;b(this.p.data).each(function(f,e){if(this[t]==d[p]){a=this;return false}});break}});return a},getNodeChildren:function(d){var a=[];this.each(function(){var r=this;if(!r.grid||!r.p.treeGrid){return}switch(r.p.treeGridModel){case"nested":var s=r.p.treeReader.left_field,c=r.p.treeReader.right_field,q=r.p.treeReader.level_field,n=parseInt(d[s],10),o=parseInt(d[c],10),u=parseInt(d[q],10);b(this.p.data).each(function(e){if(parseInt(this[q],10)===u+1&&parseInt(this[s],10)>n&&parseInt(this[c],10)<o){a.push(this)}});break;case"adjacency":var p=r.p.treeReader.parent_id_field,t=r.p.localReader.id;b(this.p.data).each(function(f,e){if(this[p]==d[t]){a.push(this)}});break}});return a},getFullTreeNode:function(d){var a=[];this.each(function(){var t=this,s;if(!t.grid||!t.p.treeGrid){return}switch(t.p.treeGridModel){case"nested":var u=t.p.treeReader.left_field,c=t.p.treeReader.right_field,r=t.p.treeReader.level_field,o=parseInt(d[u],10),p=parseInt(d[c],10),w=parseInt(d[r],10);b(this.p.data).each(function(e){if(parseInt(this[r],10)>=w&&parseInt(this[u],10)>=o&&parseInt(this[u],10)<=p){a.push(this)}});break;case"adjacency":a.push(d);var q=t.p.treeReader.parent_id_field,v=t.p.localReader.id;b(this.p.data).each(function(e){s=a.length;for(e=0;e<s;e++){if(a[e][v]==this[q]){a.push(this);break}}});break}});return a},getNodeAncestors:function(d){var a=[];this.each(function(){if(!this.grid||!this.p.treeGrid){return}var c=b(this).jqGrid("getNodeParent",d);

while(c){a.push(c);c=b(this).jqGrid("getNodeParent",c)}});return a},isVisibleNode:function(d){var a=true;this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}var g=b(c).jqGrid("getNodeAncestors",d),h=c.p.treeReader.expanded_field;b(g).each(function(){a=a&&this[h];if(!a){return false}})});return a},isNodeLoaded:function(d){var a;this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}var f=c.p.treeReader.leaf_field;if(d.loaded!==undefined){a=d.loaded}else{if(d[f]||b(c).jqGrid("getNodeChildren",d).length>0){a=true}else{a=false}}});return a},expandNode:function(a){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var h=this.p.treeReader.expanded_field;if(!a[h]){var g=b.jgrid.getAccessor(a,this.p.localReader.id);var j=b("#"+g,this.grid.bDiv)[0];var k=this.p._index[g];if(b(this).jqGrid("isNodeLoaded",this.p.data[k])){a[h]=true;b("div.treeclick",j).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")}else{a[h]=true;b("div.treeclick",j).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus");this.p.treeANode=j.rowIndex;this.p.datatype=this.p.treedatatype;if(this.p.treeGridModel=="nested"){b(this).jqGrid("setGridParam",{postData:{nodeid:g,n_left:a.lft,n_right:a.rgt,n_level:a.level}})}else{b(this).jqGrid("setGridParam",{postData:{nodeid:g,parentid:a.parent_id,n_level:a.level}})}b(this).trigger("reloadGrid");if(this.p.treeGridModel=="nested"){b(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}})}else{b(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}})}}}})},collapseNode:function(a){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}if(a.expanded){a.expanded=false;var e=b.jgrid.getAccessor(a,this.p.localReader.id);var f=b("#"+e,this.grid.bDiv)[0];b("div.treeclick",f).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(f,h,a,g){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var e,r,c,o=[],s=this,d,p,q=b(this).jqGrid("getRootNodes");d=b.jgrid.from(q);d.orderBy(f,h,a,g);p=d.select();for(e=0,r=p.length;e<r;e++){c=p[e];o.push(c);b(this).jqGrid("collectChildrenSortTree",o,c,f,h,a,g)}b.each(o,function(l,k){var j=b.jgrid.getAccessor(this,s.p.localReader.id);b("#"+s.p.id+" tbody tr:eq("+l+")").after(b("tr#"+j,s.grid.bDiv))});d=null;p=null;o=null})},collectChildrenSortTree:function(a,j,h,l,m,k){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var e,g,o,d,c,f;d=b(this).jqGrid("getNodeChildren",j);c=b.jgrid.from(d);c.orderBy(h,l,m,k);f=c.select();for(e=0,g=f.length;e<g;e++){o=f[e];a.push(o);b(this).jqGrid("collectChildrenSortTree",a,o,h,l,m,k)}})},setTreeRow:function(a,f){var e=false;this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}e=b(c).jqGrid("setRowData",a,f)});return e},delTreeNode:function(a){return this.each(function(){var g=this;if(!g.grid||!g.p.treeGrid){return}var j=b(g).jqGrid("getInd",a,true);if(j){var h=b(g).jqGrid("getNodeChildren",j);if(h.length>0){for(var k=0;k<h.length;k++){b(g).jqGrid("delRowData",h[k].id)}}b(g).jqGrid("delRowData",j.id)}})}})})(jQuery);(function(b){b.jgrid.extend({getColProp:function(j){var a={},g=this[0];if(!g.grid){return false}var h=g.p.colModel;for(var k=0;k<h.length;k++){if(h[k].name==j){a=h[k];break}}return a},setColProp:function(d,a){return this.each(function(){if(this.grid){if(a){var c=this.p.colModel;for(var f=0;f<c.length;f++){if(c[f].name==d){b.extend(this.p.colModel[f],a);break}}}}})},sortGrid:function(f,a,e){return this.each(function(){var c=this,k=-1;if(!c.grid){return}if(!f){f=c.p.sortname}for(var d=0;d<c.p.colModel.length;d++){if(c.p.colModel[d].index==f||c.p.colModel[d].name==f){k=d;break}}if(k!=-1){var j=c.p.colModel[k].sortable;if(typeof j!=="boolean"){j=true}if(typeof a!=="boolean"){a=false}if(j){c.sortData("jqgh_"+f,k,a,e)}}})},GridDestroy:function(){return this.each(function(){if(this.grid){if(this.p.pager){b(this.p.pager).remove()}var d=this.id;try{b("#gbox_"+d).remove()}catch(a){}}})},GridUnload:function(){return this.each(function(){if(!this.grid){return}var e={id:b(this).attr("id"),cl:b(this).attr("class")};if(this.p.pager){b(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom")}var a=document.createElement("table");b(a).attr({id:e.id});a.className=e.cl;var f=this.id;b(a).removeClass("ui-jqgrid-btable");if(b(this.p.pager).parents("#gbox_"+f).length===1){b(a).insertBefore("#gbox_"+f).show();b(this.p.pager).insertBefore("#gbox_"+f)}else{b(a).insertBefore("#gbox_"+f).show()}b("#gbox_"+f).remove()})},setGridState:function(a){return this.each(function(){if(!this.grid){return}var d=this;if(a=="hidden"){b(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+d.p.id).slideUp("fast");if(d.p.pager){b(d.p.pager).slideUp("fast")}if(d.p.toppager){b(d.p.toppager).slideUp("fast")}if(d.p.toolbar[0]===true){if(d.p.toolbar[1]=="both"){b(d.grid.ubDiv).slideUp("fast")}b(d.grid.uDiv).slideUp("fast")}if(d.p.footerrow){b(".ui-jqgrid-sdiv","#gbox_"+d.p.id).slideUp("fast")}b(".ui-jqgrid-titlebar-close span",d.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");d.p.gridstate="hidden"}else{if(a=="visible"){b(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+d.p.id).slideDown("fast");if(d.p.pager){b(d.p.pager).slideDown("fast")}if(d.p.toppager){b(d.p.toppager).slideDown("fast")}if(d.p.toolbar[0]===true){if(d.p.toolbar[1]=="both"){b(d.grid.ubDiv).slideDown("fast")}b(d.grid.uDiv).slideDown("fast")}if(d.p.footerrow){b(".ui-jqgrid-sdiv","#gbox_"+d.p.id).slideDown("fast")}b(".ui-jqgrid-titlebar-close span",d.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");d.p.gridstate="visible"}}})},updateGridRows:function(k,m,l){var a,h=false,j;this.each(function(){var f=this,d,c,e,g;if(!f.grid){return false}if(!m){m="id"}if(k&&k.length>0){b(k).each(function(p){e=this;c=f.rows.namedItem(e[m]);if(c){g=e[m];if(l===true){if(f.p.jsonReader.repeatitems===true){if(f.p.jsonReader.cell){e=e[f.p.jsonReader.cell]}for(var q=0;q<e.length;q++){d=f.formatter(g,e[q],q,e,"edit");j=f.p.colModel[q].title?{title:b.jgrid.stripHtml(d)}:{};if(f.p.treeGrid===true&&a==f.p.ExpandColumn){b("td:eq("+q+") > span:first",c).html(d).attr(j)}else{b("td:eq("+q+")",c).html(d).attr(j)}}h=true;return true}}b(f.p.colModel).each(function(n){a=l===true?this.jsonmap||this.name:this.name;if(e[a]!==undefined){d=f.formatter(g,e[a],n,e,"edit");j=this.title?{title:b.jgrid.stripHtml(d)}:{};if(f.p.treeGrid===true&&a==f.p.ExpandColumn){b("td:eq("+n+") > span:first",c).html(d).attr(j)}else{b("td:eq("+n+")",c).html(d).attr(j)}h=true}})}})}});return h},filterGrid:function(d,a){a=b.extend({gridModel:false,gridNames:false,gridToolbar:false,filterModel:[],formtype:"horizontal",autosearch:true,formclass:"filterform",tableclass:"filtertable",buttonclass:"filterbutton",searchButton:"Search",clearButton:"Clear",enableSearch:false,enableClear:false,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,url:"",marksearched:true},a||{});return this.each(function(){var c=this;this.p=a;if(this.p.filterModel.length===0&&this.p.gridModel===false){alert("No filter is set");return}if(!d){alert("No target grid is set!");return}this.p.gridid=d.indexOf("#")!=-1?d:"#"+d;var u=b(this.p.gridid).jqGrid("getGridParam","colModel");if(u){if(this.p.gridModel===true){var t=b(this.p.gridid)[0];var r;b.each(u,function(f,e){var g=[];

this.search=this.search===false?false:true;if(this.editrules&&this.editrules.searchhidden===true){r=true}else{if(this.hidden===true){r=false}else{r=true}}if(this.search===true&&r===true){if(c.p.gridNames===true){g.label=t.p.colNames[f]}else{g.label=""}g.name=this.name;g.index=this.index||this.name;g.stype=this.edittype||"text";if(g.stype!="select"){g.stype="text"}g.defval=this.defval||"";g.surl=this.surl||"";g.sopt=this.editoptions||{};g.width=this.width;c.p.filterModel.push(g)}})}else{b.each(c.p.filterModel,function(f,e){for(var g=0;g<u.length;g++){if(this.name==u[g].name){this.index=u[g].index||this.name;break}}if(!this.index){this.index=this.name}})}}else{alert("Could not get grid colModel");return}var q=function(){var g={},h=0,k;var j=b(c.p.gridid)[0],l;j.p.searchdata={};if(b.isFunction(c.p.beforeSearch)){c.p.beforeSearch()}b.each(c.p.filterModel,function(y,m){l=this.index;switch(this.stype){case"select":k=b("select[name="+l+"]",c).val();if(k){g[l]=k;if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).addClass("dirty-cell")}h++}else{if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).removeClass("dirty-cell")}try{delete j.p.postData[this.index]}catch(x){}}break;default:k=b("input[name="+l+"]",c).val();if(k){g[l]=k;if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).addClass("dirty-cell")}h++}else{if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).removeClass("dirty-cell")}try{delete j.p.postData[this.index]}catch(x){}}}});var f=h>0?true:false;b.extend(j.p.postData,g);var e;if(c.p.url){e=b(j).jqGrid("getGridParam","url");b(j).jqGrid("setGridParam",{url:c.p.url})}b(j).jqGrid("setGridParam",{search:f}).trigger("reloadGrid",[{page:1}]);if(e){b(j).jqGrid("setGridParam",{url:e})}if(b.isFunction(c.p.afterSearch)){c.p.afterSearch()}};var n=function(){var g={},k,h=0;var j=b(c.p.gridid)[0],l;if(b.isFunction(c.p.beforeClear)){c.p.beforeClear()}b.each(c.p.filterModel,function(A,m){l=this.index;k=(this.defval)?this.defval:"";if(!this.stype){this.stype="text"}switch(this.stype){case"select":var y;b("select[name="+l+"] option",c).each(function(v){if(v===0){this.selected=true}if(b(this).text()==k){this.selected=true;y=b(this).val();return false}});if(y){g[l]=y;if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).addClass("dirty-cell")}h++}else{if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).removeClass("dirty-cell")}try{delete j.p.postData[this.index]}catch(z){}}break;case"text":b("input[name="+l+"]",c).val(k);if(k){g[l]=k;if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).addClass("dirty-cell")}h++}else{if(c.p.marksearched){b("#jqgh_"+this.name,j.grid.hDiv).removeClass("dirty-cell")}try{delete j.p.postData[this.index]}catch(z){}}break}});var f=h>0?true:false;b.extend(j.p.postData,g);var e;if(c.p.url){e=b(j).jqGrid("getGridParam","url");b(j).jqGrid("setGridParam",{url:c.p.url})}b(j).jqGrid("setGridParam",{search:f}).trigger("reloadGrid",[{page:1}]);if(e){b(j).jqGrid("setGridParam",{url:e})}if(b.isFunction(c.p.afterClear)){c.p.afterClear()}};var s;var o=function(){var g=document.createElement("tr");var j,e,k,h,f;if(c.p.formtype=="horizontal"){b(s).append(g)}b.each(c.p.filterModel,function(F,K){h=document.createElement("td");b(h).append("<label for='"+this.name+"'>"+this.label+"</label>");f=document.createElement("td");var G=this;if(!this.stype){this.stype="text"}switch(this.stype){case"select":if(this.surl){b(f).load(this.surl,function(){if(G.defval){b("select",this).val(G.defval)}b("select",this).attr({name:G.index||G.name,id:"sg_"+G.name});if(G.sopt){b("select",this).attr(G.sopt)}if(c.p.gridToolbar===true&&G.width){b("select",this).width(G.width)}if(c.p.autosearch===true){b("select",this).change(function(v){q();return false})}})}else{if(G.sopt.value){var M=G.sopt.value;var J=document.createElement("select");b(J).attr({name:G.index||G.name,id:"sg_"+G.name}).attr(G.sopt);var L,l,I;if(typeof M==="string"){L=M.split(";");for(var H=0;H<L.length;H++){l=L[H].split(":");I=document.createElement("option");I.value=l[0];I.innerHTML=l[1];if(l[1]==G.defval){I.selected="selected"}J.appendChild(I)}}else{if(typeof M==="object"){for(var m in M){if(M.hasOwnProperty(m)){F++;I=document.createElement("option");I.value=m;I.innerHTML=M[m];if(M[m]==G.defval){I.selected="selected"}J.appendChild(I)}}}}if(c.p.gridToolbar===true&&G.width){b(J).width(G.width)}b(f).append(J);if(c.p.autosearch===true){b(J).change(function(v){q();return false})}}}break;case"text":var E=this.defval?this.defval:"";b(f).append("<input type='text' name='"+(this.index||this.name)+"' id='sg_"+this.name+"' value='"+E+"'/>");if(G.sopt){b("input",f).attr(G.sopt)}if(c.p.gridToolbar===true&&G.width){if(b.browser.msie){b("input",f).width(G.width-4)}else{b("input",f).width(G.width-2)}}if(c.p.autosearch===true){b("input",f).keypress(function(v){var w=v.charCode?v.charCode:v.keyCode?v.keyCode:0;if(w==13){q();return false}return this})}break}if(c.p.formtype=="horizontal"){if(c.p.gridToolbar===true&&c.p.gridNames===false){b(g).append(f)}else{b(g).append(h).append(f)}b(g).append(f)}else{j=document.createElement("tr");b(j).append(h).append(f);b(s).append(j)}});f=document.createElement("td");if(c.p.enableSearch===true){e="<input type='button' id='sButton' class='"+c.p.buttonclass+"' value='"+c.p.searchButton+"'/>";b(f).append(e);b("input#sButton",f).click(function(){q();return false})}if(c.p.enableClear===true){k="<input type='button' id='cButton' class='"+c.p.buttonclass+"' value='"+c.p.clearButton+"'/>";b(f).append(k);b("input#cButton",f).click(function(){n();return false})}if(c.p.enableClear===true||c.p.enableSearch===true){if(c.p.formtype=="horizontal"){b(g).append(f)}else{j=document.createElement("tr");b(j).append("<td>&#160;</td>").append(f);b(s).append(j)}}};var p=b("<form name='SearchForm' style=display:inline;' class='"+this.p.formclass+"'></form>");s=b("<table class='"+this.p.tableclass+"' cellspacing='0' cellpading='0' border='0'><tbody></tbody></table>");b(p).append(s);o();b(this).append(p);this.triggerSearch=q;this.clearSearch=n})},filterToolbar:function(a){a=b.extend({autosearch:true,searchOnEnter:true,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:false,groupOp:"AND",defaultSearch:"bw"},a||{});return this.each(function(){var k=this;var q=function(){var f={},g=0,x,w,v={},j;b.each(k.p.colModel,function(t,r){w=this.index||this.name;switch(this.stype){case"select":j=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:"eq";x=b("select[name="+w+"]",k.grid.hDiv).val();if(x){f[w]=x;v[w]=j;g++}else{try{delete k.p.postData[w]}catch(s){}}break;case"text":j=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:a.defaultSearch;x=b("input[name="+w+"]",k.grid.hDiv).val();if(x){f[w]=x;v[w]=j;g++}else{try{delete k.p.postData[w]}catch(s){}}break}});var c=g>0?true:false;if(a.stringResult===true||k.p.datatype=="local"){var y='{"groupOp":"'+a.groupOp+'","rules":[';var d=0;b.each(f,function(s,r){if(d>0){y+=","}y+='{"field":"'+s+'",';y+='"op":"'+v[s]+'",';y+='"data":"'+r+'"}';d++});y+="]}";b.extend(k.p.postData,{filters:y})}else{b.extend(k.p.postData,f)}var e;if(k.p.searchurl){e=k.p.url;b(k).jqGrid("setGridParam",{url:k.p.searchurl})}var h=false;if(b.isFunction(a.beforeSearch)){h=a.beforeSearch.call(k)}if(!h){b(k).jqGrid("setGridParam",{search:c}).trigger("reloadGrid",[{page:1}])}if(e){b(k).jqGrid("setGridParam",{url:e})}if(b.isFunction(a.afterSearch)){a.afterSearch()}};var m=function(u){var h={},w,j=0,v;u=(typeof u!="boolean")?true:u;

b.each(k.p.colModel,function(y,r){w=(this.searchoptions&&this.searchoptions.defaultValue)?this.searchoptions.defaultValue:"";v=this.index||this.name;switch(this.stype){case"select":var s;b("select[name="+v+"] option",k.grid.hDiv).each(function(x){if(x===0){this.selected=true}if(b(this).text()==w){this.selected=true;s=b(this).val();return false}});if(s){h[v]=s;j++}else{try{delete k.p.postData[v]}catch(t){}}break;case"text":b("input[name="+v+"]",k.grid.hDiv).val(w);if(w){h[v]=w;j++}else{try{delete k.p.postData[v]}catch(t){}}break}});var e=j>0?true:false;if(a.stringResult===true||k.p.datatype=="local"){var d='{"groupOp":"'+a.groupOp+'","rules":[';var f=0;b.each(h,function(s,r){if(f>0){d+=","}d+='{"field":"'+s+'",';d+='"op":"eq",';d+='"data":"'+r+'"}';f++});d+="]}";b.extend(k.p.postData,{filters:d})}else{b.extend(k.p.postData,h)}var g;if(k.p.searchurl){g=k.p.url;b(k).jqGrid("setGridParam",{url:k.p.searchurl})}var c=false;if(b.isFunction(a.beforeClear)){c=a.beforeClear.call(k)}if(!c){if(u){b(k).jqGrid("setGridParam",{search:e}).trigger("reloadGrid",[{page:1}])}}if(g){b(k).jqGrid("setGridParam",{url:g})}if(b.isFunction(a.afterClear)){a.afterClear()}};var o=function(){var c=b("tr.ui-search-toolbar",k.grid.hDiv);if(c.css("display")=="none"){c.show()}else{c.hide()}};function l(e,c){var d=b(e);if(d[0]){jQuery.each(c,function(){if(this.data!==undefined){d.bind(this.type,this.data,this.fn)}else{d.bind(this.type,this.fn)}})}}var n=b("<tr class='ui-search-toolbar' role='rowheader'></tr>");var p;b.each(k.p.colModel,function(H,d){var E=this,G,h,J,C,f;h=b("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+k.p.direction+"'></th>");G=b("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");if(this.hidden===true){b(h).css("display","none")}this.search=this.search===false?false:true;if(typeof this.stype=="undefined"){this.stype="text"}J=b.extend({},this.searchoptions||{});if(this.search){switch(this.stype){case"select":C=this.surl||J.dataUrl;if(C){f=G;b.ajax(b.extend({url:C,dataType:"html",complete:function(t,r){if(J.buildSelect!==undefined){var s=J.buildSelect(t);if(s){b(f).append(s)}}else{b(f).append(t.responseText)}if(J.defaultValue){b("select",f).val(J.defaultValue)}b("select",f).attr({name:E.index||E.name,id:"gs_"+E.name});if(J.attr){b("select",f).attr(J.attr)}b("select",f).css({width:"100%"});if(J.dataInit!==undefined){J.dataInit(b("select",f)[0])}if(J.dataEvents!==undefined){l(b("select",f)[0],J.dataEvents)}if(a.autosearch===true){b("select",f).change(function(u){q();return false})}t=null}},b.jgrid.ajaxOptions,k.p.ajaxSelectOptions||{}))}else{var j;if(E.searchoptions&&E.searchoptions.value){j=E.searchoptions.value}else{if(E.editoptions&&E.editoptions.value){j=E.editoptions.value}}if(j){var K=document.createElement("select");K.style.width="100%";b(K).attr({name:E.index||E.name,id:"gs_"+E.name});var e,g,c;if(typeof j==="string"){e=j.split(";");for(var I=0;I<e.length;I++){g=e[I].split(":");c=document.createElement("option");c.value=g[0];c.innerHTML=g[1];K.appendChild(c)}}else{if(typeof j==="object"){for(var D in j){if(j.hasOwnProperty(D)){c=document.createElement("option");c.value=D;c.innerHTML=j[D];K.appendChild(c)}}}}if(J.defaultValue){b(K).val(J.defaultValue)}if(J.attr){b(K).attr(J.attr)}if(J.dataInit!==undefined){J.dataInit(K)}if(J.dataEvents!==undefined){l(K,J.dataEvents)}b(G).append(K);if(a.autosearch===true){b(K).change(function(r){q();return false})}}}break;case"text":var F=J.defaultValue?J.defaultValue:"";b(G).append("<input type='text' style='width:95%;padding:0px;' name='"+(E.index||E.name)+"' id='gs_"+E.name+"' value='"+F+"'/>");if(J.attr){b("input",G).attr(J.attr)}if(J.dataInit!==undefined){J.dataInit(b("input",G)[0])}if(J.dataEvents!==undefined){l(b("input",G)[0],J.dataEvents)}if(a.autosearch===true){if(a.searchOnEnter){b("input",G).keypress(function(s){var r=s.charCode?s.charCode:s.keyCode?s.keyCode:0;if(r==13){q();return false}return this})}else{b("input",G).keydown(function(s){var r=s.which;switch(r){case 13:return false;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:if(p){clearTimeout(p)}p=setTimeout(function(){q()},500)}})}}break}}b(h).append(G);b(n).append(h)});b("table thead",k.grid.hDiv).append(n);this.triggerToolbar=q;this.clearToolbar=m;this.toggleToolbar=o})}})})(jQuery);(function(b){b.jgrid.extend({getPostData:function(){var a=this[0];if(!a.grid){return}return a.p.postData},setPostData:function(a){var d=this[0];if(!d.grid){return}if(typeof(a)==="object"){d.p.postData=a}else{alert("Error: cannot add a non-object postData value. postData unchanged.")}},appendPostData:function(a){var d=this[0];if(!d.grid){return}if(typeof(a)==="object"){b.extend(d.p.postData,a)}else{alert("Error: cannot append a non-object postData value. postData unchanged.")}},setPostDataItem:function(a,f){var e=this[0];if(!e.grid){return}e.p.postData[a]=f},getPostDataItem:function(a){var d=this[0];if(!d.grid){return}return d.p.postData[a]},removePostDataItem:function(a){var d=this[0];if(!d.grid){return}delete d.p.postData[a]},getUserData:function(){var a=this[0];if(!a.grid){return}return a.p.userData},getUserDataItem:function(a){var d=this[0];if(!d.grid){return}return d.p.userData[a]}})})(jQuery);function tableToGrid(d,c){jQuery(d).each(function(){if(this.grid){return}jQuery(this).width("99%");var q=jQuery(this).width();var a=jQuery("input[type=checkbox]:first",jQuery(this));var v=jQuery("input[type=radio]:first",jQuery(this));var z=a.length>0;var w=!z&&v.length>0;var u=z||w;var s=[];var b=[];jQuery("th",jQuery(this)).each(function(){if(s.length===0&&u){s.push({name:"__selection__",index:"__selection__",width:0,hidden:true});b.push("__selection__")}else{s.push({name:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),index:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),width:jQuery(this).width()||150});b.push(jQuery(this).html())}});var x=[];var y=[];var r=[];jQuery("tbody > tr",jQuery(this)).each(function(){var e={};var f=0;jQuery("td",jQuery(this)).each(function(){if(f===0&&u){var h=jQuery("input",jQuery(this));var g=h.attr("value");y.push(g||x.length);if(h.attr("checked")){r.push(g)}e[s[f].name]=h.attr("value")}else{e[s[f].name]=jQuery(this).html()}f++});if(f>0){x.push(e)}});jQuery(this).empty();jQuery(this).addClass("scroll");jQuery(this).jqGrid(jQuery.extend({datatype:"local",width:q,colNames:b,colModel:s,multiselect:z},c||{}));var t;for(t=0;t<x.length;t++){var A=null;if(y.length>0){A=y[t];if(A&&A.replace){A=encodeURIComponent(A).replace(/[.\-%]/g,"_")}}if(A===null){A=t+1}jQuery(this).jqGrid("addRowData",A,x[t])}for(t=0;t<r.length;t++){jQuery(this).jqGrid("setSelection",r[t])}})}(function(b){b.jgrid.extend({setColumns:function(a){a=b.extend({top:0,left:0,width:200,height:"auto",dataheight:"auto",modal:false,drag:true,beforeShowForm:null,afterShowForm:null,afterSubmitForm:null,closeOnEscape:true,ShrinkToFit:false,jqModal:false,saveicon:[true,"left","ui-icon-disk"],closeicon:[true,"left","ui-icon-close"],onClose:null,colnameview:true,closeAfterSubmit:true,updateAfterCheck:false,recreateForm:false},b.jgrid.col,a||{});return this.each(function(){var s=this;if(!s.grid){return}var r=typeof a.beforeShowForm==="function"?true:false;var x=typeof a.afterShowForm==="function"?true:false;var w=typeof a.afterSubmitForm==="function"?true:false;var y=s.p.id,t="ColTbl_"+y,v={themodal:"colmod"+y,modalhead:"colhd"+y,modalcontent:"colcnt"+y,scrollelm:t};

if(a.recreateForm===true&&b("#"+v.themodal).html()!=null){b("#"+v.themodal).remove()}if(b("#"+v.themodal).html()!=null){if(r){a.beforeShowForm(b("#"+t))}b.jgrid.viewModal("#"+v.themodal,{gbox:"#gbox_"+y,jqm:a.jqModal,jqM:false,modal:a.modal});if(x){a.afterShowForm(b("#"+t))}}else{var q=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px";var p="<div id='"+t+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+q+";'>";p+="<table class='ColTable' cellspacing='1' cellpading='2' border='0'><tbody>";for(i=0;i<this.p.colNames.length;i++){if(!s.p.colModel[i].hidedlg){p+="<tr><td style='white-space: pre;'><input type='checkbox' style='margin-right:5px;' id='col_"+this.p.colModel[i].name+"' class='cbox' value='T' "+((this.p.colModel[i].hidden===false)?"checked":"")+"/><label for='col_"+this.p.colModel[i].name+"'>"+this.p.colNames[i]+((a.colnameview)?" ("+this.p.colModel[i].name+")":"")+"</label></td></tr>"}}p+="</tbody></table></div>";var u=!a.updateAfterCheck?"<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+a.bSubmit+"</a>":"",o="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+a.bCancel+"</a>";p+="<table border='0' class='EditTable' id='"+t+"_2'><tbody><tr style='display:block;height:3px;'><td></td></tr><tr><td class='DataTD ui-widget-content'></td></tr><tr><td class='ColButton EditButton'>"+u+"&#160;"+o+"</td></tr></tbody></table>";a.gbox="#gbox_"+y;b.jgrid.createModal(v,p,a,"#gview_"+s.p.id,b("#gview_"+s.p.id)[0]);if(a.saveicon[0]==true){b("#dData","#"+t+"_2").addClass(a.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.saveicon[2]+"'></span>")}if(a.closeicon[0]==true){b("#eData","#"+t+"_2").addClass(a.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.closeicon[2]+"'></span>")}if(!a.updateAfterCheck){b("#dData","#"+t+"_2").click(function(c){for(i=0;i<s.p.colModel.length;i++){if(!s.p.colModel[i].hidedlg){var d=s.p.colModel[i].name.replace(/\./g,"\\.");if(b("#col_"+d,"#"+t).attr("checked")){b(s).jqGrid("showCol",s.p.colModel[i].name);b("#col_"+d,"#"+t).attr("defaultChecked",true)}else{b(s).jqGrid("hideCol",s.p.colModel[i].name);b("#col_"+d,"#"+t).attr("defaultChecked","")}}}if(a.ShrinkToFit===true){b(s).jqGrid("setGridWidth",s.grid.width-0.001,true)}if(a.closeAfterSubmit){b.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+y,jqm:a.jqModal,onClose:a.onClose})}if(w){a.afterSubmitForm(b("#"+t))}return false})}else{b(":input","#"+t).click(function(d){var c=this.id.substr(4);if(c){if(this.checked){b(s).jqGrid("showCol",c)}else{b(s).jqGrid("hideCol",c)}if(a.ShrinkToFit===true){b(s).jqGrid("setGridWidth",s.grid.width-0.001,true)}}return this})}b("#eData","#"+t+"_2").click(function(c){b.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+y,jqm:a.jqModal,onClose:a.onClose});return false});b("#dData, #eData","#"+t+"_2").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});if(r){a.beforeShowForm(b("#"+t))}b.jgrid.viewModal("#"+v.themodal,{gbox:"#gbox_"+y,jqm:a.jqModal,jqM:true,modal:a.modal});if(x){a.afterShowForm(b("#"+t))}}})}})})(jQuery);(function(b){b.jgrid.extend({jqGridImport:function(a){a=b.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},a||{});return this.each(function(){var g=this;var j=function(o,s){var q=b(s.xmlGrid.config,o)[0];var c=b(s.xmlGrid.data,o)[0],r,e;if(xmlJsonClass.xml2json&&b.jgrid.parse){r=xmlJsonClass.xml2json(q," ");r=b.jgrid.parse(r);for(var f in r){if(r.hasOwnProperty(f)){e=r[f]}}if(c){var d=r.grid.datatype;r.grid.datatype="xmlstring";r.grid.datastr=o;b(g).jqGrid(e).jqGrid("setGridParam",{datatype:d})}else{b(g).jqGrid(e)}r=null;e=null}else{alert("xml2json or parse are not present")}};var h=function(n,d){if(n&&typeof n=="string"){var o=b.jgrid.parse(n);var c=o[d.jsonGrid.config];var f=o[d.jsonGrid.data];if(f){var e=c.datatype;c.datatype="jsonstring";c.datastr=f;b(g).jqGrid(c).jqGrid("setGridParam",{datatype:e})}else{b(g).jqGrid(c)}}};switch(a.imptype){case"xml":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"xml",complete:function(d,c){if(c=="success"){j(d.responseXML,a);if(b.isFunction(a.importComplete)){a.importComplete(d)}}d=null}},a.ajaxOptions));break;case"xmlstring":if(a.impstring&&typeof a.impstring=="string"){var k=b.jgrid.stringToDoc(a.impstring);if(k){j(k,a);if(b.isFunction(a.importComplete)){a.importComplete(k)}a.impstring=null}k=null}break;case"json":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"json",complete:function(d,c){if(c=="success"){h(d.responseText,a);if(b.isFunction(a.importComplete)){a.importComplete(d)}}d=null}},a.ajaxOptions));break;case"jsonstring":if(a.impstring&&typeof a.impstring=="string"){h(a.impstring,a);if(b.isFunction(a.importComplete)){a.importComplete(a.impstring)}a.impstring=null}break}})},jqGridExport:function(d){d=b.extend({exptype:"xmlstring",root:"grid",ident:"\t"},d||{});var a=null;this.each(function(){if(!this.grid){return}var c=b.extend({},b(this).jqGrid("getGridParam"));if(c.rownumbers){c.colNames.splice(0,1);c.colModel.splice(0,1)}if(c.multiselect){c.colNames.splice(0,1);c.colModel.splice(0,1)}if(c.subGrid){c.colNames.splice(0,1);c.colModel.splice(0,1)}c.knv=null;if(c.treeGrid){for(var f in c.treeReader){if(c.treeReader.hasOwnProperty(f)){c.colNames.splice(c.colNames.length-1);c.colModel.splice(c.colModel.length-1)}}}switch(d.exptype){case"xmlstring":a="<"+d.root+">"+xmlJsonClass.json2xml(c,d.ident)+"</"+d.root+">";break;case"jsonstring":a="{"+xmlJsonClass.toJson(c,d.root,d.ident)+"}";if(c.postData.filters!==undefined){a=a.replace(/filters":"/,'filters":');a=a.replace(/}]}"/,"}]}")}break}});return a},excelExport:function(a){a=b.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},a||{});return this.each(function(){if(!this.grid){return}var h;if(a.exptype=="remote"){var g=b.extend({},this.p.postData);g[a.oper]=a.tag;var f=jQuery.param(g);if(a.url.indexOf("?")!=-1){h=a.url+"&"+f}else{h=a.url+"?"+f}window.location=h}})}})})(jQuery);(function(b){b.jgrid.extend({groupingSetup:function(){return this.each(function(){var h=this,m=h.p.groupingView;if(m!==null&&((typeof m==="object")||b.isFunction(m))){if(!m.groupField.length){h.p.grouping=false}else{for(var k=0;k<m.groupField.length;k++){if(!m.groupOrder[k]){m.groupOrder[k]="asc"}if(!m.groupText[k]){m.groupText[k]="{0}"}if(typeof(m.groupColumnShow[k])!="boolean"){m.groupColumnShow[k]=true}if(typeof(m.groupSummary[k])!="boolean"){m.groupSummary[k]=false}if(m.groupColumnShow[k]===true){b(h).jqGrid("showCol",m.groupField[k])}else{b(h).jqGrid("hideCol",m.groupField[k])}m.sortitems[k]=[];m.sortnames[k]=[];m.summaryval[k]=[];if(m.groupSummary[k]){m.summary[k]=[];var a=h.p.colModel;for(var l=0,j=a.length;l<j;l++){if(a[l].summaryType){m.summary[k].push({nm:a[l].name,st:a[l].summaryType,v:""})}}}}h.p.scroll=false;h.p.rownumbers=false;h.p.subGrid=false;h.p.treeGrid=false;h.p.gridview=true}}else{h.p.grouping=false}})},groupingPrepare:function(g,h,f,a){this.each(function(){h[0]+="";var c=h[0].toString().split(" ").join("");var e=this.p.groupingView,d=this;if(f.hasOwnProperty(c)){f[c].push(g)}else{f[c]=[];f[c].push(g);e.sortitems[0].push(c);e.sortnames[0].push(b.trim(h[0].toString()));e.summaryval[0][c]=b.extend(true,[],e.summary[0])}if(e.groupSummary[0]){b.each(e.summaryval[0][c],function(m,l){if(b.isFunction(this.st)){this.v=this.st.call(d,this.v,this.nm,a)

}else{this.v=b(d).jqGrid("groupingCalculations."+this.st,this.v,this.nm,a)}})}});return f},groupingToggle:function(a){this.each(function(){var k=this,q=k.p.groupingView,m=a.lastIndexOf("_"),o=a.substring(0,m+1),p=parseInt(a.substring(m+1),10)+1,n=q.minusicon,l=q.plusicon;if(b("#"+a+" span").hasClass(n)){if(q.showSummaryOnHide&&q.groupSummary[0]){b("#"+a).nextUntil(".jqfoot").hide()}else{b("#"+a).nextUntil("#"+o+String(p)).hide()}b("#"+a+" span").removeClass(n).addClass(l)}else{b("#"+a).nextUntil("#"+o+String(p)).show();b("#"+a+" span").removeClass(l).addClass(n)}});return false},groupingRender:function(a,d){return this.each(function(){var t=this,n=t.p.groupingView,r="",p="",o,s="",u,q,c;if(!n.groupDataSorted){n.sortitems[0].sort();n.sortnames[0].sort();if(n.groupOrder[0].toLowerCase()=="desc"){n.sortitems[0].reverse();n.sortnames[0].reverse()}}if(n.groupCollapse){s=n.plusicon}else{s=n.minusicon}s+=" tree-wrap-"+t.p.direction;c=0;while(c<d){if(t.p.colModel[c].name==n.groupField[0]){q=c;break}c++}b.each(n.sortitems[0],function(D,f){o=t.p.id+"ghead_"+D;p="<span style='cursor:pointer;' class='ui-icon "+s+"' onclick=\"jQuery('#"+t.p.id+"').jqGrid('groupingToggle','"+o+"');return false;\"></span>";try{u=t.formatter(o,n.sortnames[0][D],q,n.sortitems[0])}catch(j){u=n.sortnames[0][D]}r+='<tr id="'+o+'" role="row" class= "ui-widget-content jqgroup ui-row-'+t.p.direction+'"><td colspan="'+d+'">'+p+b.jgrid.format(n.groupText[0],u,a[f].length)+"</td></tr>";for(var g=0;g<a[f].length;g++){r+=a[f][g].join("")}if(n.groupSummary[0]){var B="";if(n.groupCollapse&&!n.showSummaryOnHide){B=' style="display:none;"'}r+="<tr"+B+' role="row" class="ui-widget-content jqfoot ui-row-'+t.p.direction+'">';var C=n.summaryval[0][f],m=t.p.colModel,A,l=a[f].length;for(var e=0;e<d;e++){var h="<td "+t.formatCol(e,1,"")+">&#160;</td>",k="{0}";b.each(C,function(){if(this.nm==m[e].name){if(m[e].summaryTpl){k=m[e].summaryTpl}if(this.st=="avg"){if(this.v&&l>0){this.v=(this.v/l)}}try{A=t.formatter("",this.v,e,this)}catch(v){A=this.v}h="<td "+t.formatCol(e,1,"")+">"+b.jgrid.format(k,A)+"</td>";return false}});r+=h}r+="</tr>"}});b("#"+t.p.id+" tbody:first").append(r);r=null})},groupingGroupBy:function(f,a,e){return this.each(function(){var c=this;if(typeof(f)=="string"){f=[f]}var h=c.p.groupingView;c.p.grouping=true;for(var d=0;d<h.groupField.length;d++){if(!h.groupColumnShow[d]){b(c).jqGrid("showCol",h.groupField[d])}}c.p.groupingView=b.extend(c.p.groupingView,a||{});h.groupField=f;b(c).trigger("reloadGrid")})},groupingRemove:function(a){return this.each(function(){var d=this;if(typeof(a)=="undefined"){a=true}d.p.grouping=false;if(a===true){b("tr.jqgroup, tr.jqfoot","#"+d.p.id+" tbody:first").remove();b("tr.jqgrow:hidden","#"+d.p.id+" tbody:first").show()}else{b(d).trigger("reloadGrid")}})},groupingCalculations:{sum:function(a,e,f){return parseFloat(a||0)+parseFloat((f[e]||0))},min:function(a,e,f){if(a===""){return parseFloat(f[e]||0)}return Math.min(parseFloat(a),parseFloat(f[e]||0))},max:function(a,e,f){if(a===""){return parseFloat(f[e]||0)}return Math.max(parseFloat(a),parseFloat(f[e]||0))},count:function(a,e,f){if(a===""){a=0}if(f.hasOwnProperty(e)){return a+1}else{return 0}},avg:function(a,e,f){return parseFloat(a||0)+parseFloat((f[e]||0))}}})})(jQuery);(function(b){b.fmatter={};b.extend(b.fmatter,{isBoolean:function(a){return typeof a==="boolean"},isObject:function(a){return(a&&(typeof a==="object"||b.isFunction(a)))||false},isString:function(a){return typeof a==="string"},isNumber:function(a){return typeof a==="number"&&isFinite(a)},isNull:function(a){return a===null},isUndefined:function(a){return typeof a==="undefined"},isValue:function(a){return(this.isObject(a)||this.isString(a)||this.isNumber(a)||this.isBoolean(a))},isEmpty:function(a){if(!this.isString(a)&&this.isValue(a)){return false}else{if(!this.isValue(a)){return true}}a=b.trim(a).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return a===""}});b.fn.fmatter=function(j,h,k,a,m){var l=h;k=b.extend({},b.jgrid.formatter,k);if(b.fn.fmatter[j]){l=b.fn.fmatter[j](h,k,a,m)}return l};b.fmatter.util={NumberFormat:function(w,y){if(!b.fmatter.isNumber(w)){w*=1}if(b.fmatter.isNumber(w)){var u=(w<0);var p=w+"";var s=(y.decimalSeparator)?y.decimalSeparator:".";var r;if(b.fmatter.isNumber(y.decimalPlaces)){var q=y.decimalPlaces;var v=Math.pow(10,q);p=Math.round(w*v)/v+"";r=p.lastIndexOf(".");if(q>0){if(r<0){p+=s;r=p.length-1}else{if(s!=="."){p=p.replace(".",s)}}while((p.length-1-r)<q){p+="0"}}}if(y.thousandsSeparator){var a=y.thousandsSeparator;r=p.lastIndexOf(s);r=(r>-1)?r:p.length;var o=p.substring(r);var x=-1;for(var t=r;t>0;t--){x++;if((x%3===0)&&(t!==r)&&(!u||(t>1))){o=a+o}o=p.charAt(t-1)+o}p=o}p=(y.prefix)?y.prefix+p:p;p=(y.suffix)?p+y.suffix:p;return p}else{return w}},DateFormat:function(s,k,a,u){var aa=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,T=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,Z=new RegExp("^/Date((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?)/$"),ae=k.match(Z),o=function(c,d){c=String(c);d=parseInt(d,10)||2;while(c.length<d){c="0"+c}return c},ai={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},af=0,V,Q,ag,S=["i18n"];S.i18n={dayNames:u.dayNames,monthNames:u.monthNames};if(s in u.masks){s=u.masks[s]}if(k.constructor===Number){af=new Date(k)}else{if(k.constructor===Date){af=k}else{if(ae!==null){af=new Date(parseInt(ae[1],10));if(ae[3]){var ad=Number(ae[5])*60+Number(ae[6]);ad*=((ae[4]=="-")?1:-1);ad-=af.getTimezoneOffset();af.setTime(Number(Number(af)+(ad*60*1000)))}}else{k=k.split(/[\\\/:_;.,\t\T\s-]/);s=s.split(/[\\\/:_;.,\t\T\s-]/);for(Q=0,ag=s.length;Q<ag;Q++){if(s[Q]=="M"){V=b.inArray(k[Q],S.i18n.monthNames);if(V!==-1&&V<12){k[Q]=V+1}}if(s[Q]=="F"){V=b.inArray(k[Q],S.i18n.monthNames);if(V!==-1&&V>11){k[Q]=V+1-12}}if(k[Q]){ai[s[Q].toLowerCase()]=parseInt(k[Q],10)}}if(ai.f){ai.m=ai.f}if(ai.m===0&&ai.y===0&&ai.d===0){return"&#160;"}ai.m=parseInt(ai.m,10)-1;var j=ai.y;if(j>=70&&j<=99){ai.y=1900+ai.y}else{if(j>=0&&j<=69){ai.y=2000+ai.y}}af=new Date(ai.y,ai.m,ai.d,ai.h,ai.i,ai.s,ai.u)}}}if(a in u.masks){a=u.masks[a]}else{if(!a){a="Y-m-d"}}var N=af.getHours(),z=af.getMinutes(),G=af.getDate(),U=af.getMonth()+1,X=af.getTimezoneOffset(),Y=af.getSeconds(),w=af.getMilliseconds(),R=af.getDay(),ah=af.getFullYear(),ab=(R+6)%7+1,W=(new Date(ah,U-1,G)-new Date(ah,0,1))/86400000,ac={d:o(G),D:S.i18n.dayNames[R],j:G,l:S.i18n.dayNames[R+7],N:ab,S:u.S(G),w:R,z:W,W:ab<5?Math.floor((W+ab-1)/7)+1:Math.floor((W+ab-1)/7)||((new Date(ah-1,0,1).getDay()+6)%7<4?53:52),F:S.i18n.monthNames[U-1+12],m:o(U),M:S.i18n.monthNames[U-1],n:U,t:"?",L:"?",o:"?",Y:ah,y:String(ah).substring(2),a:N<12?u.AmPm[0]:u.AmPm[1],A:N<12?u.AmPm[2]:u.AmPm[3],B:"?",g:N%12||12,G:N,h:o(N%12||12),H:o(N),i:o(z),s:o(Y),u:w,e:"?",I:"?",O:(X>0?"-":"+")+o(Math.floor(Math.abs(X)/60)*100+Math.abs(X)%60,4),P:"?",T:(String(af).match(T)||[""]).pop().replace(n,""),Z:"?",c:"?",r:"?",U:Math.floor(af/1000)};return a.replace(aa,function(c){return c in ac?ac[c]:c.substring(1)})}};b.fn.fmatter.defaultFormat=function(d,a){return(b.fmatter.isValue(d)&&d!=="")?d:a.defaultValue?a.defaultValue:"&#160;"};b.fn.fmatter.email=function(d,a){if(!b.fmatter.isEmpty(d)){return'<a href="mailto:'+d+'">'+d+"</a>"}else{return b.fn.fmatter.defaultFormat(d,a)}};b.fn.fmatter.checkbox=function(h,k){var g=b.extend({},k.checkbox),j;if(!b.fmatter.isUndefined(k.colModel.formatoptions)){g=b.extend({},g,k.colModel.formatoptions)}if(g.disabled===true){j='disabled="disabled"'

}else{j=""}if(b.fmatter.isEmpty(h)||b.fmatter.isUndefined(h)){h=b.fn.fmatter.defaultFormat(h,g)}h=h+"";h=h.toLowerCase();var a=h.search(/(false|0|no|off)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+a+' value="'+h+'" offval="no" '+j+"/>"};b.fn.fmatter.link=function(g,a){var f={target:a.target};var h="";if(!b.fmatter.isUndefined(a.colModel.formatoptions)){f=b.extend({},f,a.colModel.formatoptions)}if(f.target){h="target="+f.target}if(!b.fmatter.isEmpty(g)){return"<a "+h+' href="'+g+'">'+g+"</a>"}else{return b.fn.fmatter.defaultFormat(g,a)}};b.fn.fmatter.showlink=function(j,a){var g={baseLinkUrl:a.baseLinkUrl,showAction:a.showAction,addParam:a.addParam||"",target:a.target,idName:a.idName},k="",h;if(!b.fmatter.isUndefined(a.colModel.formatoptions)){g=b.extend({},g,a.colModel.formatoptions)}if(g.target){k="target="+g.target}h=g.baseLinkUrl+g.showAction+"?"+g.idName+"="+a.rowId+g.addParam;if(b.fmatter.isString(j)||b.fmatter.isNumber(j)){return"<a "+k+' href="'+h+'">'+j+"</a>"}else{return b.fn.fmatter.defaultFormat(j,a)}};b.fn.fmatter.integer=function(f,a){var e=b.extend({},a.integer);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions)}if(b.fmatter.isEmpty(f)){return e.defaultValue}return b.fmatter.util.NumberFormat(f,e)};b.fn.fmatter.number=function(f,a){var e=b.extend({},a.number);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions)}if(b.fmatter.isEmpty(f)){return e.defaultValue}return b.fmatter.util.NumberFormat(f,e)};b.fn.fmatter.currency=function(f,a){var e=b.extend({},a.currency);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions)}if(b.fmatter.isEmpty(f)){return e.defaultValue}return b.fmatter.util.NumberFormat(f,e)};b.fn.fmatter.date=function(h,j,a,k){var g=b.extend({},j.date);if(!b.fmatter.isUndefined(j.colModel.formatoptions)){g=b.extend({},g,j.colModel.formatoptions)}if(!g.reformatAfterEdit&&k=="edit"){return b.fn.fmatter.defaultFormat(h,j)}else{if(!b.fmatter.isEmpty(h)){return b.fmatter.util.DateFormat(g.srcformat,h,g.newformat,g)}else{return b.fn.fmatter.defaultFormat(h,j)}}};b.fn.fmatter.select=function(t,y,x,q){t=t+"";var v=false,r=[];if(!b.fmatter.isUndefined(y.colModel.formatoptions)){v=y.colModel.formatoptions.value}else{if(!b.fmatter.isUndefined(y.colModel.editoptions)){v=y.colModel.editoptions.value}}if(v){var a=y.colModel.editoptions.multiple===true?true:false,j=[],p;if(a){j=t.split(",");j=b.map(j,function(c){return b.trim(c)})}if(b.fmatter.isString(v)){var w=v.split(";"),u=0;for(var s=0;s<w.length;s++){p=w[s].split(":");if(p.length>2){p[1]=jQuery.map(p,function(d,c){if(c>0){return d}}).join(":")}if(a){if(jQuery.inArray(p[0],j)>-1){r[u]=p[1];u++}}else{if(b.trim(p[0])==b.trim(t)){r[0]=p[1];break}}}}else{if(b.fmatter.isObject(v)){if(a){r=jQuery.map(j,function(d,c){return v[d]})}else{r[0]=v[t]||""}}}}t=r.join(", ");return t===""?b.fn.fmatter.defaultFormat(t,y):t};b.fn.fmatter.rowactions=function(n,o,q,k){var l={keys:false,editbutton:true,delbutton:true,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{}},a=b("#"+o)[0].p.colModel[k];if(!b.fmatter.isUndefined(a.formatoptions)){l=b.extend(l,a.formatoptions)}var p=function(c){if(l.afterSave){l.afterSave(c)}b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide()},m=function(c){if(l.afterRestore){l.afterRestore(c)}b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide()};switch(q){case"edit":b("#"+o).jqGrid("editRow",n,l.keys,l.onEdit,l.onSuccess,l.url,l.extraparam,p,l.onError,m);b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).hide();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).show();break;case"save":b("#"+o).jqGrid("saveRow",n,l.onSuccess,l.url,l.extraparam,p,l.onError,m);b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide();break;case"cancel":b("#"+o).jqGrid("restoreRow",n,m);b("tr#"+n+" div.ui-inline-edit, tr#"+n+" div.ui-inline-del","#"+o).show();b("tr#"+n+" div.ui-inline-save, tr#"+n+" div.ui-inline-cancel","#"+o).hide();break;case"del":b("#"+o).jqGrid("delGridRow",n,l.delOptions);break}};b.fn.fmatter.actions=function(l,n,a){var j={keys:false,editbutton:true,delbutton:true};if(!b.fmatter.isUndefined(n.colModel.formatoptions)){j=b.extend(j,n.colModel.formatoptions)}var o=n.rowId,k="",m;if(typeof(o)=="undefined"||b.fmatter.isEmpty(o)){return""}if(j.editbutton){m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','edit',"+n.pos+");";k=k+"<div style='margin-left:8px;'><div title='"+b.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+m+"><span class='ui-icon ui-icon-pencil'></span></div>"}if(j.delbutton){m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','del',"+n.pos+");";k=k+"<div title='"+b.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+m+"><span class='ui-icon ui-icon-trash'></span></div>"}m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','save',"+n.pos+");";k=k+"<div title='"+b.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+m+"></span></div>";m="onclick=$.fn.fmatter.rowactions('"+o+"','"+n.gid+"','cancel',"+n.pos+");";k=k+"<div title='"+b.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+m+"></span></div></div>";return k};b.unformat=function(x,p,s,z){var u,w=p.colModel.formatter,v=p.colModel.formatoptions||{},a,q=/([\.\*\_\'\(\)\{\}\+\?\\])/g,t=p.colModel.unformat||(b.fn.fmatter[w]&&b.fn.fmatter[w].unformat);if(typeof t!=="undefined"&&b.isFunction(t)){u=t(b(x).text(),p,x)}else{if(!b.fmatter.isUndefined(w)&&b.fmatter.isString(w)){var A=b.jgrid.formatter||{},r;switch(w){case"integer":v=b.extend({},A.integer,v);a=v.thousandsSeparator.replace(q,"\\$1");r=new RegExp(a,"g");u=b(x).text().replace(r,"");break;case"number":v=b.extend({},A.number,v);a=v.thousandsSeparator.replace(q,"\\$1");r=new RegExp(a,"g");u=b(x).text().replace(r,"").replace(v.decimalSeparator,".");break;case"currency":v=b.extend({},A.currency,v);a=v.thousandsSeparator.replace(q,"\\$1");r=new RegExp(a,"g");u=b(x).text().replace(r,"").replace(v.decimalSeparator,".").replace(v.prefix,"").replace(v.suffix,"");break;case"checkbox":var y=(p.colModel.editoptions)?p.colModel.editoptions.value.split(":"):["Yes","No"];u=b("input",x).attr("checked")?y[0]:y[1];break;case"select":u=b.unformat.select(x,p,s,z);break;case"actions":return"";default:u=b(x).text()}}}return u?u:z===true?b(x).text():b.jgrid.htmlDecode(b(x).html())};b.unformat.select=function(y,a,u,B){var v=[];var r=b(y).text();if(B===true){return r}var w=b.extend({},a.colModel.editoptions);if(w.value){var A=w.value,j=w.multiple===true?true:false,s=[],t;if(j){s=r.split(",");s=b.map(s,function(c){return b.trim(c)})}if(b.fmatter.isString(A)){var C=A.split(";"),z=0;for(var x=0;x<C.length;x++){t=C[x].split(":");if(t.length>2){t[1]=jQuery.map(t,function(d,c){if(c>0){return d}}).join(":")}if(j){if(jQuery.inArray(t[1],s)>-1){v[z]=t[0];z++}}else{if(b.trim(t[1])==b.trim(r)){v[0]=t[0];break}}}}else{if(b.fmatter.isObject(A)||b.isArray(A)){if(!j){s[0]=r

}v=jQuery.map(s,function(d){var c;b.each(A,function(f,e){if(e==d){c=f;return false}});if(typeof(c)!="undefined"){return c}})}}return v.join(", ")}else{return r||""}};b.unformat.date=function(f,a){var e=b.jgrid.formatter.date||{};if(!b.fmatter.isUndefined(a.formatoptions)){e=b.extend({},e,a.formatoptions)}if(!b.fmatter.isEmpty(f)){return b.fmatter.util.DateFormat(e.newformat,f,e.srcformat,e)}else{return b.fn.fmatter.defaultFormat(f,a)}}})(jQuery);var xmlJsonClass={xml2json:function(f,j){if(f.nodeType===9){f=f.documentElement}var g=this.removeWhite(f);var h=this.toObj(g);var k=this.toJson(h,f.nodeName,"\t");return"{\n"+j+(j?k.replace(/\t/g,j):k.replace(/\t|\n/g,""))+"\n}"},json2xml:function(j,k){var h=function(a,s,n){var c="";var d,r;if(a instanceof Array){if(a.length===0){c+=n+"<"+s+">__EMPTY_ARRAY_</"+s+">\n"}else{for(d=0,r=a.length;d<r;d+=1){var b=n+h(a[d],s,n+"\t")+"\n";c+=b}}}else{if(typeof(a)==="object"){var e=false;c+=n+"<"+s;var m;for(m in a){if(a.hasOwnProperty(m)){if(m.charAt(0)==="@"){c+=" "+m.substr(1)+'="'+a[m].toString()+'"'}else{e=true}}}c+=e?">":"/>";if(e){for(m in a){if(a.hasOwnProperty(m)){if(m==="#text"){c+=a[m]}else{if(m==="#cdata"){c+="<![CDATA["+a[m]+"]]>"}else{if(m.charAt(0)!=="@"){c+=h(a[m],m,n+"\t")}}}}}c+=(c.charAt(c.length-1)==="\n"?n:"")+"</"+s+">"}}else{if(typeof(a)==="function"){c+=n+"<"+s+"><![CDATA["+a+"]]></"+s+">"}else{if(a.toString()==='""'||a.toString().length===0){c+=n+"<"+s+">__EMPTY_STRING_</"+s+">"}else{c+=n+"<"+s+">"+a.toString()+"</"+s+">"}}}}return c};var f="";var g;for(g in j){if(j.hasOwnProperty(g)){f+=h(j[g],g,"")}}return k?f.replace(/\t/g,k):f.replace(/\t|\n/g,"")},toObj:function(j){var m={};var n=/function/i;if(j.nodeType===1){if(j.attributes.length){var o;for(o=0;o<j.attributes.length;o+=1){m["@"+j.attributes[o].nodeName]=(j.attributes[o].nodeValue||"").toString()}}if(j.firstChild){var k=0,p=0,q=false;var l;for(l=j.firstChild;l;l=l.nextSibling){if(l.nodeType===1){q=true}else{if(l.nodeType===3&&l.nodeValue.match(/[^ \f\n\r\t\v]/)){k+=1}else{if(l.nodeType===4){p+=1}}}}if(q){if(k<2&&p<2){this.removeWhite(j);for(l=j.firstChild;l;l=l.nextSibling){if(l.nodeType===3){m["#text"]=this.escape(l.nodeValue)}else{if(l.nodeType===4){if(n.test(l.nodeValue)){m[l.nodeName]=[m[l.nodeName],l.nodeValue]}else{m["#cdata"]=this.escape(l.nodeValue)}}else{if(m[l.nodeName]){if(m[l.nodeName] instanceof Array){m[l.nodeName][m[l.nodeName].length]=this.toObj(l)}else{m[l.nodeName]=[m[l.nodeName],this.toObj(l)]}}else{m[l.nodeName]=this.toObj(l)}}}}}else{if(!j.attributes.length){m=this.escape(this.innerXml(j))}else{m["#text"]=this.escape(this.innerXml(j))}}}else{if(k){if(!j.attributes.length){m=this.escape(this.innerXml(j));if(m==="__EMPTY_ARRAY_"){m="[]"}else{if(m==="__EMPTY_STRING_"){m=""}}}else{m["#text"]=this.escape(this.innerXml(j))}}else{if(p){if(p>1){m=this.escape(this.innerXml(j))}else{for(l=j.firstChild;l;l=l.nextSibling){if(n.test(j.firstChild.nodeValue)){m=j.firstChild.nodeValue;break}else{m["#cdata"]=this.escape(l.nodeValue)}}}}}}}if(!j.attributes.length&&!j.firstChild){m=null}}else{if(j.nodeType===9){m=this.toObj(j.documentElement)}else{alert("unhandled node type: "+j.nodeType)}}return m},toJson:function(x,y,v){var n=y?('"'+y+'"'):"";if(x==="[]"){n+=(y?":[]":"[]")}else{if(x instanceof Array){var w,r,t=[];for(r=0,w=x.length;r<w;r+=1){t[r]=this.toJson(x[r],"",v+"\t")}n+=(y?":[":"[")+(t.length>1?("\n"+v+"\t"+t.join(",\n"+v+"\t")+"\n"+v):t.join(""))+"]"}else{if(x===null){n+=(y&&":")+"null"}else{if(typeof(x)==="object"){var q=[];var u;for(u in x){if(x.hasOwnProperty(u)){q[q.length]=this.toJson(x[u],u,v+"\t")}}n+=(y?":{":"{")+(q.length>1?("\n"+v+"\t"+q.join(",\n"+v+"\t")+"\n"+v):q.join(""))+"}"}else{if(typeof(x)==="string"){var o=/(^-?\d+\.?\d*$)/;var m=/function/i;var s=x.toString();if(o.test(s)||m.test(s)||s==="false"||s==="true"){n+=(y&&":")+s}else{n+=(y&&":")+'"'+x+'"'}}else{n+=(y&&":")+x.toString()}}}}}return n},innerXml:function(h){var c="";if("innerHTML" in h){c=h.innerHTML}else{var f=function(a){var d="",e;if(a.nodeType===1){d+="<"+a.nodeName;for(e=0;e<a.attributes.length;e+=1){d+=" "+a.attributes[e].nodeName+'="'+(a.attributes[e].nodeValue||"").toString()+'"'}if(a.firstChild){d+=">";for(var b=a.firstChild;b;b=b.nextSibling){d+=f(b)}d+="</"+a.nodeName+">"}else{d+="/>"}}else{if(a.nodeType===3){d+=a.nodeValue}else{if(a.nodeType===4){d+="<![CDATA["+a.nodeValue+"]]>"}}}return d};for(var g=h.firstChild;g;g=g.nextSibling){c+=f(g)}}return c},escape:function(b){return b.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(d){d.normalize();var f;for(f=d.firstChild;f;){if(f.nodeType===3){if(!f.nodeValue.match(/[^ \f\n\r\t\v]/)){var e=f.nextSibling;d.removeChild(f);f=e}else{f=f.nextSibling}}else{if(f.nodeType===1){this.removeWhite(f);f=f.nextSibling}else{f=f.nextSibling}}}return d}};jQuery.fn.searchFilter=function(e,f){function d(M,G,P){this.$=M;this.add=function(g){if(g==null){M.find(".ui-add-last").click()}else{M.find(".sf:eq("+g+") .ui-add").click()}return this};this.del=function(g){if(g==null){M.find(".sf:last .ui-del").click()}else{M.find(".sf:eq("+g+") .ui-del").click()}return this};this.search=function(g){M.find(".ui-search").click();return this};this.reset=function(g){if(g===undefined){g=false}M.find(".ui-reset").trigger("click",[g]);return this};this.close=function(){M.find(".ui-closer").click();return this};if(G!=null){function A(){jQuery(this).toggleClass("ui-state-hover");return false}function N(g){jQuery(this).toggleClass("ui-state-active",(g.type=="mousedown"));return false}function R(g,h){return"<option value='"+g+"'>"+h+"</option>"}function D(h,g,j){return"<select class='"+h+"'"+(j?" style='display:none;'":"")+">"+g+"</select>"}function c(g,h){var j=M.find("tr.sf td.data "+g);if(j[0]!=null){h(j)}}function F(g,h){var j=M.find("tr.sf td.data "+g);if(j[0]!=null){jQuery.each(h,function(){if(this.data!=null){j.bind(this.type,this.data,this.fn)}else{j.bind(this.type,this.fn)}})}}var I=jQuery.extend({},jQuery.fn.searchFilter.defaults,P);var a=-1;var b="";jQuery.each(I.groupOps,function(){b+=R(this.op,this.text)});b="<select name='groupOp'>"+b+"</select>";M.html("").addClass("ui-searchFilter").append("<div class='ui-widget-overlay' style='z-index: -1'>&#160;</div><table class='ui-widget-content ui-corner-all'><thead><tr><td colspan='5' class='ui-widget-header ui-corner-all' style='line-height: 18px;'><div class='ui-closer ui-state-default ui-corner-all ui-helper-clearfix' style='float: right;'><span class='ui-icon ui-icon-close'></span></div>"+I.windowTitle+"</td></tr></thead><tbody><tr class='sf'><td class='fields'></td><td class='ops'></td><td class='data'></td><td><div class='ui-del ui-state-default ui-corner-all'><span class='ui-icon ui-icon-minus'></span></div></td><td><div class='ui-add ui-state-default ui-corner-all'><span class='ui-icon ui-icon-plus'></span></div></td></tr><tr><td colspan='5' class='divider'><hr class='ui-widget-content' style='margin:1px'/></td></tr></tbody><tfoot><tr><td colspan='3'><span class='ui-reset ui-state-default ui-corner-all' style='display: inline-block; float: left;'><span class='ui-icon ui-icon-arrowreturnthick-1-w' style='float: left;'></span><span style='line-height: 18px; padding: 0 7px 0 3px;'>"+I.resetText+"</span></span><span class='ui-search ui-state-default ui-corner-all' style='display: inline-block; float: right;'><span class='ui-icon ui-icon-search' style='float: left;'></span><span style='line-height: 18px; padding: 0 7px 0 3px;'>"+I.searchText+"</span></span><span class='matchText'>"+I.matchText+"</span> "+b+" <span class='rulesText'>"+I.rulesText+"</span></td><td>&#160;</td><td><div class='ui-add-last ui-state-default ui-corner-all'><span class='ui-icon ui-icon-plusthick'></span></div></td></tr></tfoot></table>");

var L=M.find("tr.sf");var O=L.find("td.fields");var Q=L.find("td.ops");var H=L.find("td.data");var E="";jQuery.each(I.operators,function(){E+=R(this.op,this.text)});E=D("default",E,true);Q.append(E);var K="<input type='text' class='default' style='display:none;' />";H.append(K);var B="";var C=false;var S=false;jQuery.each(G,function(l){var m=l;B+=R(this.itemval,this.text);if(this.ops!=null){C=true;var g="";jQuery.each(this.ops,function(){g+=R(this.op,this.text)});g=D("field"+m,g,true);Q.append(g)}if(this.dataUrl!=null){if(l>a){a=l}S=true;var h=this.dataEvents;var k=this.dataInit;var n=this.buildSelect;jQuery.ajax(jQuery.extend({url:this.dataUrl,complete:function(o){var p;if(n!=null){p=jQuery("<div />").append(n(o))}else{p=jQuery("<div />").append(o.responseText)}p.find("select").addClass("field"+m).hide();H.append(p.html());if(k){c(".field"+l,k)}if(h){F(".field"+l,h)}if(l==a){M.find("tr.sf td.fields select[name='field']").change()}}},I.ajaxSelectOptions))}else{if(this.dataValues!=null){S=true;var j="";jQuery.each(this.dataValues,function(){j+=R(this.value,this.text)});j=D("field"+m,j,true);H.append(j)}else{if(this.dataEvents!=null||this.dataInit!=null){S=true;var j="<input type='text' class='field"+m+"' />";H.append(j)}}}if(this.dataInit!=null&&l!=a){c(".field"+l,this.dataInit)}if(this.dataEvents!=null&&l!=a){F(".field"+l,this.dataEvents)}});B="<select name='field'>"+B+"</select>";O.append(B);var J=O.find("select[name='field']");if(C){J.change(function(j){var k=j.target.selectedIndex;var h=jQuery(j.target).parents("tr.sf").find("td.ops");h.find("select").removeAttr("name").hide();var g=h.find(".field"+k);if(g[0]==null){g=h.find(".default")}g.attr("name","op").show();return false})}else{Q.find(".default").attr("name","op").show()}if(S){J.change(function(j){var k=j.target.selectedIndex;var h=jQuery(j.target).parents("tr.sf").find("td.data");h.find("select,input").removeClass("vdata").hide();var g=h.find(".field"+k);if(g[0]==null){g=h.find(".default")}g.show().addClass("vdata");return false})}else{H.find(".default").show().addClass("vdata")}if(C||S){J.change()}M.find(".ui-state-default").hover(A,A).mousedown(N).mouseup(N);M.find(".ui-closer").click(function(g){I.onClose(jQuery(M.selector));return false});M.find(".ui-del").click(function(g){var h=jQuery(g.target).parents(".sf");if(h.siblings(".sf").length>0){if(I.datepickerFix===true&&jQuery.fn.datepicker!==undefined){h.find(".hasDatepicker").datepicker("destroy")}h.remove()}else{h.find("select[name='field']")[0].selectedIndex=0;h.find("select[name='op']")[0].selectedIndex=0;h.find(".data input").val("");h.find(".data select").each(function(){this.selectedIndex=0});h.find("select[name='field']").change(function(j){j.stopPropagation()})}return false});M.find(".ui-add").click(function(j){var h=jQuery(j.target).parents(".sf");var k=h.clone(true).insertAfter(h);k.find(".ui-state-default").removeClass("ui-state-hover ui-state-active");if(I.clone){k.find("select[name='field']")[0].selectedIndex=h.find("select[name='field']")[0].selectedIndex;var l=(k.find("select[name='op']")[0]==null);if(!l){k.find("select[name='op']").focus()[0].selectedIndex=h.find("select[name='op']")[0].selectedIndex}var g=k.find("select.vdata");if(g[0]!=null){g[0].selectedIndex=h.find("select.vdata")[0].selectedIndex}}else{k.find(".data input").val("");k.find("select[name='field']").focus()}if(I.datepickerFix===true&&jQuery.fn.datepicker!==undefined){h.find(".hasDatepicker").each(function(){var m=jQuery.data(this,"datepicker").settings;k.find("#"+this.id).unbind().removeAttr("id").removeClass("hasDatepicker").datepicker(m)})}k.find("select[name='field']").change(function(m){m.stopPropagation()});return false});M.find(".ui-search").click(function(h){var j=jQuery(M.selector);var g;var k=j.find("select[name='groupOp'] :selected").val();if(!I.stringResult){g={groupOp:k,rules:[]}}else{g='{"groupOp":"'+k+'","rules":['}j.find(".sf").each(function(o){var l=jQuery(this).find("select[name='field'] :selected").val();var m=jQuery(this).find("select[name='op'] :selected").val();var n=jQuery(this).find("input.vdata,select.vdata :selected").val();n+="";n=n.replace(/\\/g,"\\\\").replace(/\"/g,'\\"');if(!I.stringResult){g.rules.push({field:l,op:m,data:n})}else{if(o>0){g+=","}g+='{"field":"'+l+'",';g+='"op":"'+m+'",';g+='"data":"'+n+'"}'}});if(I.stringResult){g+="]}"}I.onSearch(g);return false});M.find(".ui-reset").click(function(j,h){var g=jQuery(M.selector);g.find(".ui-del").click();g.find("select[name='groupOp']")[0].selectedIndex=0;I.onReset(h);return false});M.find(".ui-add-last").click(function(){var h=jQuery(M.selector+" .sf:last");var g=h.clone(true).insertAfter(h);g.find(".ui-state-default").removeClass("ui-state-hover ui-state-active");g.find(".data input").val("");g.find("select[name='field']").focus();if(I.datepickerFix===true&&jQuery.fn.datepicker!==undefined){h.find(".hasDatepicker").each(function(){var j=jQuery.data(this,"datepicker").settings;g.find("#"+this.id).unbind().removeAttr("id").removeClass("hasDatepicker").datepicker(j)})}g.find("select[name='field']").change(function(j){j.stopPropagation()});return false});this.setGroupOp=function(j){selDOMobj=M.find("select[name='groupOp']")[0];var h={},g=selDOMobj.options.length,k;for(k=0;k<g;k++){h[selDOMobj.options[k].value]=k}selDOMobj.selectedIndex=h[j];jQuery(selDOMobj).change(function(l){l.stopPropagation()})};this.setFilter=function(t){var v=t.sfref,h=t.filter;var o=[],p,q,s,n,m,k={};selDOMobj=v.find("select[name='field']")[0];for(p=0,s=selDOMobj.options.length;p<s;p++){k[selDOMobj.options[p].value]={index:p,ops:{}};o.push(selDOMobj.options[p].value)}for(p=0,m=o.length;p<m;p++){selDOMobj=v.find(".ops > select[class='field"+p+"']")[0];if(selDOMobj){for(q=0,n=selDOMobj.options.length;q<n;q++){k[o[p]]["ops"][selDOMobj.options[q].value]=q}}selDOMobj=v.find(".data > select[class='field"+p+"']")[0];if(selDOMobj){k[o[p]]["data"]={};for(q=0,n=selDOMobj.options.length;q<n;q++){k[o[p]]["data"][selDOMobj.options[q].value]=q}}}var r,j,g,u,l;r=h.field;if(k[r]){j=k[r]["index"]}if(j!=null){g=k[r]["ops"][h.op];if(g===undefined){for(p=0,m=P.operators.length;p<m;p++){if(P.operators[p].op==h.op){g=p;break}}}u=h.data;if(k[r]["data"]==null){l=-1}else{l=k[r]["data"][u]}}if(j!=null&&g!=null&&l!=null){v.find("select[name='field']")[0].selectedIndex=j;v.find("select[name='field']").change();v.find("select[name='op']")[0].selectedIndex=g;v.find("input.vdata").val(u);v=v.find("select.vdata")[0];if(v){v.selectedIndex=l}return true}else{return false}}}}return new d(this,e,f)};jQuery.fn.searchFilter.version="1.2.9";jQuery.fn.searchFilter.defaults={clone:true,datepickerFix:true,onReset:function(b){alert("Reset Clicked. Data Returned: "+b)},onSearch:function(b){alert("Search Clicked. Data Returned: "+b)},onClose:function(b){b.hide()},groupOps:[{op:"AND",text:"all"},{op:"OR",text:"any"}],operators:[{op:"eq",text:"is equal to"},{op:"ne",text:"is not equal to"},{op:"lt",text:"is less than"},{op:"le",text:"is less or equal to"},{op:"gt",text:"is greater than"},{op:"ge",text:"is greater or equal to"},{op:"in",text:"is in"},{op:"ni",text:"is not in"},{op:"bw",text:"begins with"},{op:"bn",text:"does not begin with"},{op:"ew",text:"ends with"},{op:"en",text:"does not end with"},{op:"cn",text:"contains"},{op:"nc",text:"does not contain"}],matchText:"match",rulesText:"rules",resetText:"Reset",searchText:"Search",stringResult:true,windowTitle:"Search Rules",ajaxSelectOptions:{}};CJW.jfp.widget.DataGrid=JFPWClass.extend(CJW.jfp.widget.Object,{className:"CJW.jfp.widget.DataGrid",wrapperSet:null,instance:null,topics:null,_triggerOnSelectRow:function(c,d){$jq(this).trigger("onSelectRow",[{type:"onSelectRow",wrapper:this,rowid:c}])

},_triggerOnSortCol:function(f,d,e){$jq(this).trigger("onSortCol",{type:"onSortCol",wrapper:this,index:f,iCol:d,sortorder:e})},_triggerOnCellSelect:function(d,e,f){$jq(this).trigger("onCellSelect",{type:"onCellSelect",wrapper:this,rowid:d,iCol:e,cellcontent:f})},_triggerOnSelectAll:function(c,d){$jq(this).trigger("onSelectAll",{type:"onSelectAll",wrapper:this,aRowids:c,status:d})},initialize:function(f,e,d){f=f||{};e=e||{};d=d||{};this.oCfg={};this.topicConfig={};JFP.cp(this.oCfg,f,{wrapperSet:"_TABLE_UKN_",label:"Default Label",mtype:"POST",rowTotal:-1,datatype:"local",onSelectRow:this._wrapCallBack(this._triggerOnSelectRow,e.onSelectRow),onSortCol:this._wrapCallBack(this._triggerOnSortCol,e.onSortCol),onCellSelect:this._wrapCallBack(this._triggerOnCellSelect,e.onCellSelect),onSelectAll:this._wrapCallBack(this._triggerOnSelectAll,e.onSelectAll),text:true});JFP.cnp(this.oCfg,e);JFP.cnp(this.oCfg,{styleClass:"jfpw-datagrid"});this.styleClass=this.oCfg.styleClass;this._applyCfg();this.topics=d;this._create()},_applyCfg:function(){this.wrapperSet=this.oCfg.wrapperSet;if(this.oCfg.cellFormater){this.cellFormater=this.oCfg.cellFormater}},getProperty:function(b){return this.instance.getGridParam(b)},setProperty:function(d,f){var e={};e[d]=f;this.instance.setGridParam(e)},setProperties:function(b){b=b||{};this.instance.setGridParam(b)},_create:function(){var c;if(this.instance!=null){return}this.instance=$jq(this.wrapperSet).first().jqGrid(this.oCfg);c=this.instance.getGridParam("colModel");for(var d in c){this.instance.setColProp(c[d]["name"],{formatter:this.cellFormater})}this.selector=this.wrapperSet;this.setTopics(this.topics);this.instance.parents("#gbox_"+this.instance.attr("id")).addClass(this.styleClass);$jq("tr.jqgrow td",$jq(this.wrapperSet)[0]).removeAttr("title");this.refresh();this.triggerPostConstruction()},destroy:function(){if(this.instance==null){return}this._destroy$();this.instance.GridDestroy();this.instance=null},clear:function(){if(this.instance==null){return}this.instance.clearGridData()},refresh:function(){if(this.instance==null){return}this.instance.trigger("reloadGrid")},render:function(b){if(this.instance==null){return}this.instance.clearGridData();this.instance.setGridParam({data:b});this.instance.trigger("reloadGrid")},addRow:function(g,h,d){if(this.instance==null){return}var f=this.instance.getGridParam("data");$jq.merge(f,g);this.instance.clearGridData();this.instance.setGridParam({data:f});this.instance.trigger("reloadGrid")},updateRow:function(f,d,e){if(this.instance==null){return}this.instance.setRowData(f,d,e)},removeRow:function(b){if(this.instance==null){return}this.instance.delRowData(b)},selectedRow:function(){return this.instance.getGridParam("selrow")},cellFormater:function(b){return b},filterByField:function(h,g,k){if(this.instance==null||h==null){return}if(g==""||g==null||k==""||k==null){this.render(h);return}var j=new Array();for(var f=0;f<h.length;f++){if(h[f][g]==k){j.push(h[f])}}this.render(j)},widget:function(){return this.instance}});window.$RDY&&$RDY.complete("CJW.jfp.widget.DataGrid");