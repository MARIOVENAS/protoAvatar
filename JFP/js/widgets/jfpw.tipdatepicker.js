CJW.jfp.widget.TipDatepicker=JFPWClass.extend(CJW.jfp.widget.Object,{className:"CJW.jfp.widget.TipDatepicker",selector:null,instance:null,ready:false,initialize:function(a,d,b){a=a||{};d=d||{};b=b||{};this.oCfg={};this.topicConfig={};this.datepickerConfig={};JFP.cp(this.oCfg,a,{wrapperSet:"__UNK__"});JFP.cnp(this.oCfg,d);JFP.cnp(this.oCfg,{type:"info",appendText:"",buttonImage:""});this.checkVML();this.selector=this.oCfg.wrapperSet;this.type=this.oCfg.type;delete this.oCfg.wrapperSet;delete this.oCfg.type;var i=this;var e=$jq(i.selector).first();e.uid("tdp_");var h=e.attr("id");this.buttonT=$jq('<img src="'+this.oCfg.buttonImage+'"/>').attr({"class":"ui-datepicker-trigger",id:h+"trigger",alt:"",title:"."});this.spanT=$jq("<span>"+this.oCfg.appendText+"</span>").attr({"class":"ui-datepicker-append",id:h+"text"});this.divC=$jq("<div/>").attr({"class":"jfpw-tooltip-info",id:h+"-info"}).css({width:"145px",height:"135px"});this.divDC=$jq("<div />").attr({id:h+"dc"});this.divC.append(this.divDC);e.after(this.divC).after(this.spanT).after(this.buttonT);var f=$jq("#"+h+"-info").removeClass("jfpw-tooltip-info").remove();var k={id:h+"trigger",overwrite:false,position:{at:"right center",my:"left center",target:i.buttonT},metadata:{type:"notitle"},content:{title:{text:"&nbsp;",button:true},text:f},style:{tip:true,widget:false},show:{effect:false,event:"click",target:$jq(i.selector+", #"+h+"trigger")},hide:{effect:false,event:"unfocus"}};$jq.extend(true,k,{position:{at:"right center",my:"left center"},style:{classes:"jfpw-tooltip ui-tooltip-shadow jfpw-tooltip-datepicker",tip:{corner:"left center",mimic:"left center",border:1,width:10,height:20}}});this.firstShow=true;this.datepickerConfig={altField:i.selector,defaultDate:$jq(i.selector)[0].value||new Date(),onSelect:function(m,l){i.buttonT.qtip("hide")}};JFP.cnp(this.datepickerConfig,this.oCfg.datepickerConfig);delete this.oCfg.datepickerConfig;var g=function(l,n){if($jq.browser.msie&&this.shadowDiv){this.shadowDiv.css("visibility","")}var m=$jq(i.selector)[0].value||new Date();if(i.firstShow==false){i.divDC.jfpwidget().setDate(m);return}i.divDC.jfpwidget(new CJW.jfp.widget.Datepicker({wrapperSet:"#"+i.divDC.attr("id")},i.datepickerConfig,{}));i.firstShow=false;i.divDC.jfpwidget().setDate(m)};var c=function(l,m){if(i.datepickerConfig.changeMonth&&i.datepickerConfig.changeYear){i.firstShow=true;i.divDC.jfpwidget("destroy")}if($jq.browser.msie&&this.shadowDiv){this.shadowDiv.css("visibility","hidden")}};var j=function(n,p,l){if($jq.browser.msie&&!this.shadowDiv){p.elements.tooltip.css({height:""});var o=p.elements.tooltip.outerWidth();var q=p.elements.tooltip.outerHeight();var m=p.elements.tooltip.css("z-index");if(m<3){m=15001}this.shadowDiv=$jq("<div />").addClass("ui-tooltip-shadow").addClass("ie").appendTo("body").css({position:"absolute","background-color":"white",width:(o-1)+"px",height:(q-1)+"px",left:l.left,top:l.top,"z-index":m-3})}};JFP.cnp(this.oCfg,{events:{}});JFP.cp(this.oCfg,{events:{show:g,hide:c,move:j}});$jq.extend(true,k,this.oCfg);JFP.cp(this.oCfg,k);this.setTopics(b);this._create()},getProperty:function(a){if(this[a]){return this[a]}return this.instance.qtip("option",a)},setProperty:function(b,c){var a={};a[b]=c;this._setInternalProperties(a)},setProperties:function(a){a=a||{};this._setInternalProperties(a)},_setInternalProperties:function(a){if(a.wrapperSet){delete a.wrapperSet}if(this.ready==true){for(attrName in a){var b=a[attrName];this.instance.qtip("option",attrName,b)}}},_create:function(){if(this.ready==true){return}this.instance=this.buttonT;this.instance.addClass("jfpw-tooltip-cursor");this.instance.qtip(this.oCfg);this.ready=true},destroy:function(){if(this.ready==false){return}this._destroy$();this.instance.qtip("destroy");this.instance=null;this.ready=false},disable:function(){this.instance.qtip("disable")},enable:function(){this.instance.qtip("enable")},widget:function(){if(this.ready==false){return}return this.instance.qtip("api")},show:function(){if(this.ready==false){return}return this.instance.qtip("show")},hide:function(){if(this.ready==false){return}return this.instance.qtip("hide")},reposition:function(){if(this.ready==false){return}return this.instance.qtip("reposition")},focus:function(){if(this.ready==false){return}return this.instance.qtip("focus")},blur:function(){if(this.ready==false){return}return this.instance.qtip("blur")},render:function(){if(this.ready==false){return}return this.instance.qtip("render")},rendered:function(){if(this.ready==false){return}return this.instance.qtip("api").rendered},toggle:function(a){if(this.ready==false){return}return this.instance.qtip("toggle",a)},checkVML:function(){if(!$jq.browser.msie||document.namespaces.vml){return}if(!document.documentMode||document.documentMode<8){document.namespaces.add("vml","urn:schemas-microsoft-com:vml")}else{if(document.documentMode&&document.documentMode>=8){document.namespaces.add("vml","urn:schemas-microsoft-com:vml","#default#VML")}}}});window.$RDY&&$RDY.complete("CJW.jfp.widget.TipDatepicker");