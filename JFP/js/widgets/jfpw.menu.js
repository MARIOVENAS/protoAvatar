CJW.jfp.widget.Menu=JFPWClass.extend(CJW.jfp.widget.Object,{className:"CJW.jfp.widget.Menu",wrapperSet:null,instance:null,topics:null,self:null,_onShow:function(){},_onHide:function(){},_onInit:function(){var a=$jq("li",this);a.hover(function(b){$jq(this).trigger("menuOver",this)},function(b){$jq(this).trigger("menuOut",this)});a.click(function(b){if($jq(this).hasClass("menu_selected")){$jq(this).hideSuperfishUl()}if($jq(this).hasClass("sfHover")){$jq(this).hideSuperfishUl()}})},initialize:function(c,a,b){c=c||{};a=a||{};b=b||{};this.oCfg={};this.topicConfig={};JFP.cp(this.oCfg,c,{wrapperSet:"_MENU_UKN_",onShow:this._onShow,onHide:this._onHide,onInit:this._onInit,text:true});this.warnandlock=a.warnandlock||false;delete a.warnandlock;JFP.cnp(this.oCfg,a);JFP.cnp(this.oCfg,{navBar:false,defaultClass:"sf-menu",styleClass:"jfpw-menu",ieShadowOffset:10,delay:0,topSelected:false,defaultSelection:false});this.navBar=this.oCfg.navBar;this.defaultClass=this.oCfg.defaultClass;this.styleClass=this.oCfg.styleClass;this.self=this;this._applyCfg();this.topics=b;this._create()},_applyCfg:function(){this.wrapperSet=this.oCfg.wrapperSet;if(this.oCfg.cellFormater){this.cellFormater=this.oCfg.cellFormater}},_create:function(){var c;if(this.instance!=null){return}this.selector=this.wrapperSet;this.instance=$jq(this.wrapperSet).first();this.instance.addClass(this.defaultClass);this.instance.addClass(this.styleClass);this.instance.removeClass("jfpw-hidden");this.instance.supersubs({minWidth:10,maxWidth:150,extraWidth:2}).superfish(this.oCfg);this.instance.find("ul").each(function(){$jq(this).siblings(".subMenuContentContainer").css({left:$jq(this).outerWidth(),height:$jq(this).outerHeight()})});this.setTopics(this.topics);this.triggerPostConstruction();this.instance.attr("tabindex","1");this.instance.bind("keydown.menu",function(d){switch(d.keyCode){case 38:if(!($jq(this).attr("navBar")=="true")){$jq(this).children("li:last-child").children("a").first().focus()}d.preventDefault();d.stopImmediatePropagation();break;case 40:if(!($jq(this).attr("navBar")=="true")){$jq(this).children("li:first-child").children("a").first().focus()}d.preventDefault();d.stopImmediatePropagation();break;case 37:if($jq(this).attr("navBar")=="true"){$jq(this).children("li:last-child").children("a").first().focus()}d.preventDefault();d.stopImmediatePropagation();break;case 39:if($jq(this).attr("navBar")=="true"){$jq(this).children("li:first-child").children("a").first().focus()}d.preventDefault();d.stopImmediatePropagation();break}});if(this.navBar){this.instance.attr("navBar",this.navBar)}this.instance.find("li").children("a").attr("tabindex","-1");if(this.warnandlock){var a=this;this.instance.find("a[onclick]").each(function(){var d=$jq(this).get(0);d.onclick=(function(){var e=d.onclick;return function(g){var f=e();if(f==false){if($jq.browser.msie){window.event.cancelBubble=true}else{$jq("#"+$jq(a.selector).children("li.sfHover").attr("id")).hideSuperfishUl();g.cancelBubble=true}}return f}})()})}if(this.oCfg.topSelected!=false){this.instance.find("li").bind("click",function(d){if(!$jq(this).hasClass("menu_selected")){$jq(this).parents("ul.sf-menu.jfpw-menu").find("li.menu_selected").removeClass("menu_selected");if($jq(this).parents("li").length>0){$jq(this).parents("li").addClass("menu_selected")}else{$jq(this).addClass("menu_selected")}}})}else{this.instance.find("li").removeClass("menu_selected")}if(this.oCfg.defaultSelection!=false){var b=this.instance.find("li"+this.oCfg.defaultSelection);if(b.length>0){this.instance.find("li.menu_selected").removeClass("menu_selected");if(b.parents("li").length>0){b.parents("li").addClass("menu_selected")}else{b.addClass("menu_selected")}}}this.instance.find("li").bind("keydown.menu",function(d){switch(d.keyCode){case 38:if($jq(this).parent("ul").attr("navBar")=="true"){$jq(this).hideSuperfishUl();$jq(this).parent("ul").parent("li").children("a").first().focus()}else{$jq(this).prev("li").children("a").focus()}d.preventDefault();d.stopImmediatePropagation();break;case 40:if($jq(this).parent("ul").attr("navBar")=="true"){$jq(this).find("ul>li>a").first().focus()}else{$jq(this).next("li").children("a").focus()}d.preventDefault();d.stopImmediatePropagation();break;case 37:if($jq(this).parent("ul").attr("navBar")=="true"){$jq(this).prev("li").children("a").focus()}else{$jq(this).hideSuperfishUl();$jq(this).parent("ul").parent("li").children("a").first().focus()}d.preventDefault();d.stopImmediatePropagation();break;case 39:if($jq(this).parent("ul").attr("navBar")=="true"){$jq(this).next("li").children("a").focus()}else{$jq(this).find("ul>li>a").first().focus()}d.preventDefault();d.stopImmediatePropagation();break}});if(this.navBar){this.instance.children().each(function(){$jq($jq(this).find("a:first").contents()[0]).wrap("<span></span>")})}},destroy:function(){if(this.instance==null){return}this._destroy$();this.instance=null},widget:function(){return this.instance},highlight:function(b){var a=this.instance.find("li"+b);if(a.length>0){this.instance.find("li.menu_selected").removeClass("menu_selected");if(a.parents("li").length>0){a.parents("li").addClass("menu_selected")}else{a.addClass("menu_selected")}}}});(function(){var a=$jq.fn.superfish;a.o=[];a.op={};$jq.fn.extend({hideSuperfishUl:function(){var d=a.op,c=(d.retainPath===true)?d.$path:"";d.retainPath=false;var b=$jq(["li.",d.hoverClass].join(""),this).add(this).not(c).removeClass(d.hoverClass).find(">ul").hide().css("visibility","hidden");b.siblings(".subMenuContentContainer").css({top:"-999px",visibility:"hidden"}).hide();b.siblings(".jfpw-menu-shadow").css({top:"-999px",visibility:"hidden"}).hide();d.onHide.call(b);return this},showSuperfishUl:function(){var g=a.op,e=a.c.shadowClass+"-off",d=this.addClass(g.hoverClass).find(">ul:hidden").css("visibility","visible");a.IE7fix.call(d);g.onBeforeShow.call(d);if($jq.browser.msie){d.show();a.IE7fix.call(d)}else{d.show(0,function(){a.IE7fix.call(d);g.onShow.call(d)})}d.siblings(".subMenuContentContainer").css({top:d.css("top"),visibility:"visible"}).show();if(d.siblings(".jfpw-menu-shadow").length==0){var c=$jq('<div class="jfpw-menu-shadow"></div>');var b={"background-color":"none transparent",position:"absolute","z-index":d.css("z-index")-2,left:d.css("left"),top:d.css("top"),width:d.outerWidth()+d.siblings(".subMenuContentContainer").outerWidth(),height:d.outerHeight()};if($jq.browser.msie){var h="progid:DXImageTransform.Microsoft.Blur(PixelRadius='"+g.ieShadowOffset+"', MakeShadow='true', ShadowOpacity='0.80')";var f={margin:-g.ieShadowOffset,"background-color":"#FFF",filter:h};c.css(f)}c.css(b);$jq(d).before(c)}d.siblings(".jfpw-menu-shadow").css({top:d.css("top"),visibility:"visible"}).show();return this}})})(jQuery);window.$RDY&&$RDY.complete("CJW.jfp.widget.Menu");