CJW.jfp.widget.Activation=JFPWClass.extend(CJW.jfp.widget.Object,{className:"CJW.jfp.widget.Activation",instance:null,initialize:function(d,b,f){d=d||{};b=b||{};this.topics=f||{};this.oCfg={};this.topicConfig={};JFP.cp(this.oCfg,d,{wrapperSet:"_UKNOWN_",styleClass:"cM-progressbar",sections:{},currentSection:1,currentStep:1});this.selector=this.oCfg.wrapperSet;delete this.oCfg.wrapperSet;JFP.cp(this.oCfg,b);this.rollover=this.oCfg.rollover||false;var e=0;for(var a in this.oCfg.sections){if(this.oCfg.sections.hasOwnProperty(a)){++e}}this.count=e;this.active=0;this._create()},_create:function(){if(this.instance!=null){return}var e=this;this.instance=$jq(this.selector).first();this.setTopics(this.topics);this.instance.addClass(this.oCfg.styleClass+"-cols-"+this.count);var d=$jq("<ul>");var a,f;for(var b=1;b<=this.count;b++){a=$jq("<li>");a.attr("id",this.oCfg.styleClass+"-tabs-"+b);a.data("maxstep",this.oCfg.sections[b-1].steps);a.data("step",0);f=$jq("<div class="+this.oCfg.styleClass+"-itemcontainer>");f.append("<span class="+this.oCfg.styleClass+"-itemnumber>"+b+"</span>");f.append("<span class="+this.oCfg.styleClass+"-text>"+this.oCfg.sections[b-1].label+"</span>");a.append(f);a.append("<div class="+this.oCfg.styleClass+"-underline role=progressbar><span></span><div class="+this.oCfg.styleClass+"-underline-partial></div></div>");d.append(a)}this.instance.append(d);var c=0;this.instance.find("div[class~="+this.oCfg.styleClass+"-itemcontainer]").each(function(h,g){if($jq(this).height()>c){c=$jq(this).height()}});this.instance.find("div[class~="+this.oCfg.styleClass+"-itemcontainer]").height(c+"px");this.setSectionStep(this.oCfg.currentSection,this.oCfg.currentStep);if(this.rollover){this.instance.find("li").click(function(i){if(e.active>=e.count){i.stopPropagation()}else{if(e.active==0){i.stopPropagation()}else{if($jq(this).next().hasClass(e.oCfg.styleClass+"-active")==false){i.stopPropagation()}else{var g=e.active-$jq(this).index()-1;for(var h=0;h<g;h++){e.prevSection()}}}}});this.instance.find("li").mousemove(function(g){if(e.active>=e.count){$jq(this).removeClass(e.oCfg.styleClass+"-pointer")}else{if(e.active==0){$jq(this).removeClass(e.oCfg.styleClass+"-pointer")}else{if($jq(this).next().hasClass(e.oCfg.styleClass+"-active")==false){$jq(this).removeClass(e.oCfg.styleClass+"-pointer")}else{$jq(this).addClass(e.oCfg.styleClass+"-pointer")}}}})}else{this.instance.find("li").click(function(g){g.preventDefault();g.stopPropagation()})}this.triggerPostConstruction()},reset:function(){if(this.instance==null){return}var a;for(var b=1;b<=this.count;b++){a=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+b);a.data("step",0);a.removeClass(this.oCfg.styleClass+"-active").removeClass(this.oCfg.styleClass+"-partial");a.find("div[class~="+this.oCfg.styleClass+"-underline-partial]").width("0%")}this.active=0},_forward:function(){if(this.active==0){this.active++}if(this.active>this.count){this.active=this.count}if(this.active<this.count){var a=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+this.active);if(a.data("step")==a.data("maxstep")){this.active++}}},_backward:function(){if(this.active>=1&&this.active<=this.count){var a=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+this.active);if(a.data("step")==0){this.active--}}if(this.active==0){this.active++}},nextSection:function(){if(this.instance==null){return}this._forward();var a=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+this.active);a.addClass(this.oCfg.styleClass+"-active").addClass(this.oCfg.styleClass+"-partial");a.find("div[class~="+this.oCfg.styleClass+"-underline-partial]").width("100%");a.data("step",a.data("maxstep"))},prevSection:function(){if(this.instance==null){return}var a=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+this.active);a.removeClass(this.oCfg.styleClass+"-active").removeClass(this.oCfg.styleClass+"-partial");a.find("div[class~="+this.oCfg.styleClass+"-underline-partial]").width("0%");a.data("step",0);this._backward()},setSection:function(b){if(this.instance==null){return}this.reset();if(b<1){b=1}if(b>this.count){b=this.count}for(var a=0;a<b;a++){this.nextSection()}},nextStep:function(){if(this.instance==null){return}this._forward();var a=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+this.active);var b=a.data("step");if(b!=a.data("maxstep")){b++}a.data("step",b);a.addClass(this.oCfg.styleClass+"-active").addClass(this.oCfg.styleClass+"-partial");a.find("div[class~="+this.oCfg.styleClass+"-underline-partial]").width(Math.floor((b*100)/a.data("maxstep"))+"%")},prevStep:function(){if(this.instance==null){return}var a=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+this.active);var b=a.data("step");if(b!=0){b--}a.data("step",b);a.find("div[class~="+this.oCfg.styleClass+"-underline-partial]").width(Math.floor((b*100)/a.data("maxstep"))+"%");if(b==0){a.removeClass(this.oCfg.styleClass+"-active").removeClass(this.oCfg.styleClass+"-partial")}this._backward()},setStep:function(b){if(this.instance==null){return}this._forward();v=this.instance.find("#"+this.oCfg.styleClass+"-tabs-"+this.active);var a=v.data("maxstep");if(b<0){b=0}if(b>a){b=a}v.data("step",b);if(b==0){v.removeClass(this.oCfg.styleClass+"-active").removeClass(this.oCfg.styleClass+"-partial")}else{v.addClass(this.oCfg.styleClass+"-active").addClass(this.oCfg.styleClass+"-partial")}v.find("div[class~="+this.oCfg.styleClass+"-underline-partial]").width(Math.floor((b*100)/v.data("maxstep"))+"%")},setSectionStep:function(b,a){if(b!=undefined){this.setSection(b)}if(a!=undefined){this.setStep(a)}},widget:function(){if(!(this.instance==null)){return this.instance}else{return null}},destroy:function(){if(!(this.instance==null)){$jq(this.selector).first().empty();this.instance=null}}});window.$RDY&&$RDY.complete("CJW.jfp.widget.Activation");