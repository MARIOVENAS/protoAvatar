CJW.jfp.widget.Overlay=JFPWClass.extend(CJW.jfp.widget.Object,{className:"CJW.jfp.widget.Overlay",selector:null,instance:null,ready:false,shadowOffsetTop:9,shadowOffsetRight:13,shadowOffsetBottom:13,shadowOffsetLeft:9,shadowTopLeftWidth:12,shadowTopRightWidth:8,shadowBottomLeftWidth:12,shadowBottomRightWidth:8,shadowLeftTopHeight:12,shadowLeftBottomHeight:8,shadowRightTopHeight:12,shadowRightBottomHeight:8,returnFocus:null,initialize:function(c,a,b){c=c||{};a=a||{};b=b||{};this.oCfg={};this.topicConfig={};JFP.cp(this.oCfg,c,{wrapperSet:"__UNK__"});this.selector=this.oCfg.wrapperSet;delete this.oCfg.wrapperSet;JFP.cnp(this.oCfg,a);JFP.cnp(this.oCfg,{dialog:false,autoOpen:false,closeText:"",resizable:false,returnFocus:null});this.dialog=this.oCfg.dialog;this.returnFocus=this.oCfg.returnFocus;delete this.oCfg.dialog;delete this.oCfg.returnFocus;if(this.dialog==true){defaultStyle="jfpw-dialog"}else{defaultStyle="jfpw-overlay"}JFP.cnp(this.oCfg,{title:"",width:300,height:300,shadowOffsetTop:9,shadowOffsetRight:13,shadowOffsetBottom:13,shadowOffsetLeft:9,shadowTopLeftWidth:12,shadowTopRightWidth:8,shadowBottomLeftWidth:12,shadowBottomRightWidth:8,shadowLeftTopHeight:12,shadowLeftBottomHeight:8,shadowRightTopHeight:12,shadowRightBottomHeight:8,shadow:true,styleClass:defaultStyle});this.styleClass=this.oCfg.styleClass;this.shadow=this.oCfg.shadow;this.shadowOffsetTop=this.oCfg.shadowOffsetTop;this.shadowOffsetRight=this.oCfg.shadowOffsetRight;this.shadowOffsetBottom=this.oCfg.shadowOffsetBottom;this.shadowOffsetLeft=this.oCfg.shadowOffsetLeft;this.shadowTopLeftWidth=this.oCfg.shadowTopLeftWidth;this.shadowTopRightWidth=this.oCfg.shadowTopRightWidth;this.shadowBottomLeftWidth=this.oCfg.shadowBottomLeftWidth;this.shadowBottomRightWidth=this.oCfg.shadowBottomRightWidth;this.shadowLeftTopHeight=this.oCfg.shadowLeftTopHeight;this.shadowLeftBottomHeight=this.oCfg.shadowLeftBottomHeight;this.shadowRightTopHeight=this.oCfg.shadowRightTopHeight;this.shadowRightBottomHeight=this.oCfg.shadowRightBottomHeight;this.oCfg.dialogClass=this.styleClass;delete this.oCfg.shadow;delete this.oCfg.shadowOffsetTop;delete this.oCfg.shadowOffsetRight;delete this.oCfg.shadowOffsetBottom;delete this.oCfg.shadowOffsetLeft;delete this.oCfg.shadowTopLeftWidth;delete this.oCfg.shadowTopRightWidth;delete this.oCfg.shadowBottomLeftWidth;delete this.oCfg.shadowBottomRightWidth;delete this.oCfg.shadowLeftTopHeight;delete this.oCfg.shadowLeftBottomHeight;delete this.oCfg.shadowRightTopHeight;delete this.oCfg.shadowRightBottomHeight;this.applyCfg();this.setTopics(b);this._create()},applyCfg:function(){var c=Math.floor(Math.random()*10000);var b=Math.floor(Math.random()*101);var a="dlg_"+c+"_"+b;if(!this.wigdetId){this.wigdetId=a;this.titleBarSelector="#"+a+" > .ui-dialog-titlebar";this.wigdetShadowId="swdDlg_"+c+"_"+b}if(this.ready==true){this.instance.dialog("option",this.oCfg)}},getProperty:function(a){return this.instance.dialog("option",a)},setProperty:function(b,c){var a={};a[b]=c;this._setInternalProperties(a);if(this.ready==true){this.instance.dialog("option",a)}this._updateShadow()},setProperties:function(a){a=a||{};this._setInternalProperties(a);this.unbindEvents();this._destroyShadow();if(this.ready==true){this.instance.dialog("option",a)}this._createShadow();this.bindEvents()},_setInternalProperties:function(a){var c=null;var b=null;for(c in a){b=a[c];switch(c){case"wrapperSet":delete a.wrapperSet;break}}},_create:function(){if(this.ready==true){return}this.instance=$jq(this.selector).first();this.instance.dialog(this.oCfg);this.ready=true;this.initEvents();this.triggerPostConstruction()},initEvents:function(){this.unbindEvents();this.bindEvents()},unbindEvents:function(){this.instance.unbind("dialogopen",this._dialogOpenHandlerFn);this.instance.unbind("dialogclose",this._dialogCloseHandlerFn);this.instance.unbind("dialogdrag",this._dialogDragHandlerFn);this.instance.unbind("dialogresize",this._dialogResizeHandlerFn);this.instance.unbind("dialogdragstart",this._dialogDragHandlerFn);this.instance.unbind("dialogdragstop",this._dialogDragHandlerFn)},bindEvents:function(){var a={topic:this.oCfg.eventsTopicName,wrapper:this};this.instance.bind("dialogopen",a,this._dialogOpenHandlerFn);this.instance.bind("dialogclose",a,this._dialogCloseHandlerFn);this.instance.bind("dialogdrag",a,this._dialogDragHandlerFn);this.instance.bind("dialogresize",a,this._dialogResizeHandlerFn);this.instance.bind("dialogdragstart",a,this._dialogDragHandlerFn);this.instance.bind("dialogdragstop",a,this._dialogDragHandlerFn)},_dialogOpenHandlerFn:function(a){a.data.wrapper._dialogOpenHandler(a)},_dialogOpenHandler:function(b){var a=this._widget();a.attr("id",this.wigdetId);this._createShadow()},_createShadow:function(){if(this.shadow==false){return}var a=$jq("<div></div>");a.attr("id",this.wigdetShadowId);a.addClass(this.styleClass);a.addClass("no-css3");a.addClass("jfpw-dialog-shadow");a.appendTo(document.body);this._setShadowContent(a);this._updateShadow()},_setShadowContent:function(a){var b="<div><div class='jfpw-dialog-shadow-top-left-corner'></div><div class='jfpw-dialog-shadow-top-left'></div><div class='jfpw-dialog-shadow-top'></div><div class='jfpw-dialog-shadow-top-right'></div><div class='jfpw-dialog-shadow-top-right-corner'></div></div><div><div class='jfpw-dialog-shadow-left-side'><div class='jfpw-dialog-shadow-left-top'></div><div class='jfpw-dialog-shadow-left'></div><div class='jfpw-dialog-shadow-left-bottom'></div></div><div class='jfpw-dialog-shadow-b'></div><div class='jfpw-dialog-shadow-right-side'><div class='jfpw-dialog-shadow-right-top'></div><div class='jfpw-dialog-shadow-right'></div><div class='jfpw-dialog-shadow-right-bottom'></div></div></div><div><div class='jfpw-dialog-shadow-bottom-left-corner'></div><div class='jfpw-dialog-shadow-bottom-left'></div><div class='jfpw-dialog-shadow-bottom'></div><div class='jfpw-dialog-shadow-bottom-right'></div><div class='jfpw-dialog-shadow-bottom-right-corner'></div></div>";a.html(b)},_getShadowStyle:function(){return this._getShadowStyleDef()},_getShadowStyleDef:function(){var a=this._widget();var d=a.css("z-index");var c=this;var b={"z-index":d-1,left:function(){var e=a.css("left");e=e.replace(/px/gi,"");e=e-c.shadowOffsetLeft;return e+"px"},top:function(){var e=a.css("top");e=e.replace(/px/gi,"");e=e-c.shadowOffsetTop;return e+"px"},width:function(){var e=a.outerWidth();return e+(c.shadowOffsetLeft+c.shadowOffsetRight)+"px"},height:function(){var e=a.outerHeight();return e+(c.shadowOffsetTop+c.shadowOffsetBottom)+"px"}};return b},_destroyShadow:function(){if(this.shadow==false){return}var a=$jq("#"+this.wigdetShadowId);a.remove()},_updateShadow:function(){if(this.shadow==false){return}var c=$jq("#"+this.wigdetShadowId);var a=this._getShadowStyle();c.css(a);var b=this;$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-top-left-corner").css({width:function(){return b.shadowOffsetLeft+"px"},height:function(){return b.shadowOffsetTop+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-top-left").css({width:function(){return b.shadowTopLeftWidth+"px"},height:function(){return b.shadowOffsetTop+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-top").css({width:function(){var d=c.css("width");d=d.replace(/px/gi,"");return(parseInt(d)-(b.shadowOffsetLeft+b.shadowTopLeftWidth+b.shadowTopRightWidth+b.shadowOffsetRight))+"px"},height:function(){return b.shadowOffsetTop+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-top-right").css({width:function(){return b.shadowTopRightWidth+"px"

},height:function(){return b.shadowOffsetTop+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-top-right-corner").css({width:function(){return b.shadowOffsetRight+"px"},height:function(){return b.shadowOffsetTop+"px"}});$jq("#"+this.wigdetShadowId+" > div > div > .jfpw-dialog-shadow-left-top").css({height:function(){return b.shadowLeftTopHeight+"px"},width:function(){return b.shadowOffsetLeft+"px"}});$jq("#"+this.wigdetShadowId+" > div > div > .jfpw-dialog-shadow-left").css({height:function(){var d=c.css("height");d=d.replace(/px/gi,"");return(parseInt(d)-(b.shadowOffsetTop+b.shadowLeftTopHeight+b.shadowLeftBottomHeight+b.shadowOffsetBottom))+"px"},width:function(){return b.shadowOffsetLeft+"px"}});$jq("#"+this.wigdetShadowId+" > div > div > .jfpw-dialog-shadow-left-bottom").css({height:function(){return b.shadowLeftBottomHeight+"px"},width:function(){return b.shadowOffsetLeft+"px"}});$jq("#"+this.wigdetShadowId+" > div > div > .jfpw-dialog-shadow-right-top").css({height:function(){return b.shadowRightTopHeight+"px"},width:function(){return b.shadowOffsetRight+"px"}});$jq("#"+this.wigdetShadowId+" > div > div > .jfpw-dialog-shadow-right").css({height:function(){var d=c.css("height");d=d.replace(/px/gi,"");return(parseInt(d)-(b.shadowOffsetTop+b.shadowRightTopHeight+b.shadowRightBottomHeight+b.shadowOffsetBottom))+"px"},width:function(){return b.shadowOffsetRight+"px"}});$jq("#"+this.wigdetShadowId+" > div > div > .jfpw-dialog-shadow-right-bottom").css({height:function(){return b.shadowRightBottomHeight+"px"},width:function(){return b.shadowOffsetRight+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-b").css({height:function(){var d=c.css("height");d=d.replace(/px/gi,"");return(parseInt(d)-(b.shadowOffsetTop+b.shadowOffsetBottom))+"px"},width:function(){var d=c.css("width");d=d.replace(/px/gi,"");return(parseInt(d)-(b.shadowOffsetLeft+b.shadowOffsetRight))+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-bottom-left-corner").css({width:function(){return b.shadowOffsetLeft+"px"},height:function(){return b.shadowOffsetBottom+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-bottom-left").css({width:function(){return b.shadowBottomLeftWidth+"px"},height:function(){return b.shadowOffsetBottom+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-bottom").css({width:function(){var d=c.css("width");d=d.replace(/px/gi,"");return(parseInt(d)-(b.shadowOffsetLeft+b.shadowBottomLeftWidth+b.shadowBottomRightWidth+b.shadowOffsetRight))+"px"},height:function(){return b.shadowOffsetBottom+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-bottom-right").css({width:function(){return b.shadowBottomRightWidth+"px"},height:function(){return b.shadowOffsetBottom+"px"}});$jq("#"+this.wigdetShadowId+" > div > .jfpw-dialog-shadow-bottom-right-corner").css({width:function(){return b.shadowOffsetRight+"px"},height:function(){return b.shadowOffsetBottom+"px"}})},_updateShadowPosition:function(d,e){if(this.shadow==false){return}var c=$jq("#"+this.wigdetShadowId);var b=this;var a={left:function(){var f=e.position.left;f=f-b.shadowOffsetLeft;return f+"px"},top:function(){var f=e.position.top;f=f-b.shadowOffsetTop;return f+"px"}};c.css(a)},_dialogCloseHandlerFn:function(a){a.data.wrapper._dialogCloseHandler(a)},_dialogCloseHandler:function(a){if(this.returnFocus!=null){$jq(this.returnFocus).focus()}this._destroyShadow()},_dialogDragHandlerFn:function(a,b){a.data.wrapper._dialogDragHandler(a,b)},_dialogDragHandler:function(a,b){this._updateShadowPosition(a,b)},_dialogResizeHandlerFn:function(a){a.data.wrapper._dialogResizeHandler(a)},_dialogResizeHandler:function(a){this._updateShadow();this.publishEvent(a)},hideTitleBar:function(){var a=$jq(this.titleBarSelector);var b=a.css("height");b=b.replace(/px/gi,"");this.oTBH=parseInt(b)+"px";a.hide();a.css({height:"0px"});this.instance.data("dialog")._size();this._updateShadow()},showTitleBar:function(){var a=$jq(this.titleBarSelector);a.css({height:this.oTBH});a.show();this.instance.data("dialog")._size();this._updateShadow()},destroy:function(){if(this.ready==false){return}this._destroy$();this.unbindEvents();this._destroyShadow();this.instance.dialog("destroy");this.ready=false},disable:function(){if(this.ready==false){return}this.instance.dialog("disable");$jq(this.selector).find("*").attr("disabled",true)},enable:function(){if(this.ready==false){return}this.instance.dialog("enable");$jq(this.selector).find("*").attr("disabled",false)},close:function(){if(this.ready==false){return}this.instance.dialog("close")},isOpen:function(){if(this.ready==false){return}return this.instance.dialog("isOpen")},moveToTop:function(){if(this.ready==false){return}this.instance.dialog("moveToTop")},open:function(){if(this.ready==false){this._create()}this.instance.dialog("open");if(this.oCfg.hideTitleBar==true){this.hideTitleBar()}},_widget:function(){if(this.ready==false){return}return this.instance.dialog("widget")},widget:function(){if(this.ready==false){return}return this.instance},shadowLayer:function(){if(this.ready==false){return}var a=$jq("#"+this.wigdetShadowId);return a}});window.$RDY&&$RDY.complete("CJW.jfp.widget.Overlay");