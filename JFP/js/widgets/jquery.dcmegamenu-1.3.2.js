(function(a){a.fn.dcMegaMenu=function(d){var f={classParent:"dc-mega",rowItems:3,speed:"fast",effect:"slide",event:"hover",classSubParent:"mega-hdr",classSubLink:"mega-hdr"};var e=null;var c=false;var d=a.extend(f,d);var b=this;return b.each(function(p){o();function m(){c=true;var q=a(".sub",this);a(this).addClass("mega-hover");if(f.effect=="slide"){if(e!=null){a(q).parent().fadeIn(200,j)}else{a(q).parent().show("blind",{},300,j)}e=a(q).parent()}}function j(){a(this).parent().parent().trigger("showsub",{clickedItem:a(this).parent()});a(this).find(".jfpw-mega-menu-shadow").height(a(this).height()-16);a(this).find(".jfpw-mega-menu-shadow").width(a(this).width()-16)}function h(r){var q=a(".sub",r);a(r).addClass("mega-hover");if(f.effect=="slide"){a(q).parent().show("blind",{},300,j)}}function l(){var q=a(".sub",this);a(this).removeClass("mega-hover");if(c){a(q).parent().fadeOut(200,k)}else{a(q).parent().hide("blind",{},300,n)}a(this).find(".sub-container").css("border","none 0px")}function n(){e=null;a(this).parent().parent().trigger("hidesub")}function k(){a(this).parent().parent().trigger("hidesub")}function g(r){var q=a(".sub",r);a(r).removeClass("mega-hover");a(q).hide("blind",{},300,n)}function i(){a("li",b).removeClass("mega-hover");a(".sub",b).hide()}function o(){$arrow='<span class="dc-mega-icon"></span>';var v=f.classParent+"-li";var t=a(b).outerWidth(true);a("> li",b).each(function(){var w=a("> ul",this);var E=a("> a",this);if(a(w).length>0){a(E).addClass(f.classParent).append($arrow);a(w).addClass("sub").wrap('<div class="sub-container" />');var C=a(this).position();parentLeft=C.left;if(a("ul",w).length>0){a(this).addClass(v);a(".sub-container",this).addClass("mega");a("> li",w).each(function(){a(this).addClass("mega-unit");if(a("> ul",this).length){a(this).addClass(f.classSubParent);a("> a",this).addClass(f.classSubParent+"-a")}else{a(this).addClass(f.classSubLink);a("> a",this).addClass(f.classSubLink+"-a")}});var L=a(".mega-unit",this);rowSize=parseInt(f.rowItems);for(var z=0;z<L.length;z+=rowSize){L.slice(z,z+rowSize).wrapAll('<div class="row" />')}a(w).show();var K=a(this).width();var G=parentLeft+K;var D=t-G;var J=a(w).outerWidth(true);var B=a(w).parent(".sub-container").outerWidth(true);var I=B-J;var F=a(".mega-unit",w).outerWidth(true);var H=a(".row:eq(0) .mega-unit",w).length;var M=F*H;var y=M+I;a(".row",this).each(function(){a(".mega-unit:last",this).addClass("last");var N=undefined;a(".mega-unit > a",this).each(function(){var O=parseInt(a(this).height());if(N===undefined||N<O){N=O}});a(".mega-unit > a",this).css("height",N+"px");a(this).css("width",M+"px")});var x=(y-K)/2;if(D<x){x=x+x-D}var A=parentLeft-x;if(A<0){a(".sub-container",this).css("left","-10px")}else{if(D<x){a(".sub-container",this).css("right","0")}else{a(".sub-container",this).css("left",parentLeft+"px").css("margin-left",-x+"px")}}a(".row",w).each(function(){var N=a(this).height();a(".mega-unit",this).css("height",N+"px");a(this).parent(".row").css("height",N+"px")});a(w).parent().hide()}else{a(".sub-container",this).addClass("non-mega").css("left",parentLeft+"px")}}});var u=a("> li > a",b).outerHeight(true);a(".sub-container",b).css({top:u+"px"}).css("z-index","1000");if(f.event=="hover"){var r={sensitivity:2,interval:10,over:m,timeout:300,out:l};a("li",b).hoverIntent(r);a("li",b).hover(function(){},function(){c=false})}if(f.event=="click"){a("body").mouseup(function(w){if(!a(w.target).parents(".mega-hover").length){i()}});a("> li > a."+f.classParent,b).click(function(w){var x=a(this).parent();if(x.hasClass("mega-hover")){g(x)}else{h(x)}w.preventDefault()})}var s=function(w){var x=a(this).parent();x.addClass("mega-hover");h(x);w.preventDefault();w.stopImmediatePropagation();a(this).unbind();a(this).focus();a(this).focus(s);a(this).blur(q)};var q=function(w){var x=a(this).parent();x.removeClass("mega-hover");g(x);w.preventDefault();w.stopImmediatePropagation()};b.children("li").children("a").focus(s);b.children("li").children("a").blur(q)}})}})(jQuery);