CJW.jfp.widget.MegaMenu=JFPWClass.extend(CJW.jfp.widget.Object,{className:"CJW.jfp.widget.MegaMenu",instance:null,initialize:function(c,a,b){c=c||{};a=a||{};b=b||{};this.oCfg={};this.topicConfig={};JFP.cp(this.oCfg,c,{wrapperSet:"_MMN_UKN_"});this.selector=this.oCfg.wrapperSet;JFP.cnp(this.oCfg,a);JFP.cnp(this.oCfg,{styleClass:"jfpw-megamenu",effect:"slide"});this.styleClass=this.oCfg.styleClass;this.applyCfg();this.setTopics(b);this._create()},applyCfg:function(){if(this.instance!=null){this.instance.dcMegaMenu(this.oCfg)}},getProperty:function(a){if(this.instance!=null){return this.oCfg[a]}},setProperty:function(b,c){var a={};a[b]=c;this.setProperties(a)},setProperties:function(a){a=a||{};JFP.copyProperties(this.oCfg,a,{wrapperSet:this.oCfg.wrapperSet});this.applyConfig()},_create:function(){if(this.instance!=null){return}this.instance=$jq(this.selector).first();this.instance.removeClass("jfpw-hidden");if($jq.browser.msie){if($jq.browser.version=="7.0"){this.instance.wrap("<div class='bIE bv7'></div>")}else{this.instance.wrap("<div class='bIE'></div>")}}else{this.instance.wrap("<div></div>")}this.instance.parent().addClass(this.styleClass);this.instance.dcMegaMenu(this.oCfg);this.instance.find(".jfpw-mega-menu-footer").parent().removeClass("row").addClass("last-row");this.instance.find(".jfpw-mega-menu-separator").html("<div></div>");this.instance.find(".jfpw-mega-menu-main-separator").html("<div></div>");this.instance.find(".sub").before("<div class='jfpw-mega-menu-tip'></div>");this.instance.find(".jfpw-mega-menu-tip").each(function(){$jq(this).css("left",$jq(this).parent().parent().position().left+$jq(this).parent().parent().width()/2)});if($jq.browser.msie){this.instance.find(".sub").before("<div class='jfpw-mega-menu-shadow'></div>");this.instance.find(".jfpw-mega-menu-footer").append("<div class='jfpw-mega-menu-br-round-corner'></div>")}this.instance.find(".sub-container").each(function(){if($jq(this).find(".jfpw-mega-menu-footer").length==0){$jq(this).find(".jfpw-mega-menu-dynamic-ad").css({"border-radius":"0 20px 20px 0","-moz-border-radius":"0 20px 20px 0","-webkit-border-radius":"0 20px 20px 0"});if($jq.browser.msie){$jq(this).find(".sub").append("<div class='jfpw-megamenu-bottom-round'></div>");if($jq(this).find(".jfpw-mega-menu-one-column").length>0){$jq(this).find(".row").before("<div class='jfpw-megamenu-top-round'></div>");$jq(this).find(".jfpw-megamenu-top-round").append("<div class='jfpw-megamenu-top-round-left-white'></div>");$jq(this).find(".jfpw-megamenu-top-round").append("<div class='jfpw-megamenu-top-round-right-white'></div>");$jq(this).find(".jfpw-megamenu-bottom-round").append("<div class='jfpw-megamenu-bottom-round-left-white'></div>");$jq(this).find(".jfpw-megamenu-bottom-round").append("<div class='jfpw-megamenu-bottom-round-right-white'></div>");$jq(this).find(".row").css("background","none white")}else{$jq(this).find(".jfpw-megamenu-bottom-round").append("<div class='jfpw-megamenu-bottom-round-left'></div>");$jq(this).find(".jfpw-megamenu-bottom-round").append("<div class='jfpw-megamenu-bottom-round-right'></div>");$jq(this).find(".jfpw-megamenu-bottom-round-right").width($jq(this).find(".jfpw-mega-menu-dynamic-ad").outerWidth()+31);$jq(this).find(".jfpw-megamenu-bottom-round-left").width($jq(this).find(".sub").parent().width()-$jq(this).find(".jfpw-megamenu-bottom-round-right").width())-100}$jq(this).find(".mega-unit").css("padding-bottom","0px !important")}}});this.instance.children().bind("keydown.menu",function(a){switch(a.keyCode){case 37:$jq(this).children("a").blur();$jq(this).prev("li").children("a").focus();break;case 39:$jq(this).children("a").blur();$jq(this).next("li").children("a").focus();break}a.preventDefault();a.stopImmediatePropagation()});this.triggerPostConstruction()},destroy:function(){if(this.instance==null){return}this._destroy$();this.instance.find(".jfpw-mega-menu-separator").html("");this.instance.find(".jfpw-mega-menu-main-separator").html("");this.instance.find(".jfpw-mega-menu-tip").remove();if($jq.browser.msie){this.instance.find(".jfpw-mega-menu-shadow").remove();this.instance.find(".jfpw-mega-menu-br-round-corner").remove()}this.instance.find(".jfpw-megamenu-bottom-round").remove();this.instance.unwrap();this.instance=null},refresh:function(){if(this.instance!=null){this.instance.find(".jfpw-mega-menu-separator").html("");this.instance.find(".jfpw-mega-menu-main-separator").html("");this.instance.find(".jfpw-mega-menu-tip").remove();if($jq.browser.msie){this.instance.find(".jfpw-mega-menu-shadow").remove();this.instance.find(".jfpw-mega-menu-br-round-corner").remove()}this.instance.find(".jfpw-megamenu-bottom-round").remove();this.instance.unwrap();this.instance=null;this._create()}},widget:function(){return this.instance}});window.$RDY&&$RDY.complete("CJW.jfp.widget.MegaMenu");